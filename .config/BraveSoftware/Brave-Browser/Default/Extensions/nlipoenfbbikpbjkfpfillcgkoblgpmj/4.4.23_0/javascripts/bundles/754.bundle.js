(self.webpackChunkawesomescreenshot_extension=self.webpackChunkawesomescreenshot_extension||[]).push([[754],{75812:(t,e,r)=>{"use strict";r.d(e,{Y:()=>o});var n=r(42980),o=((0,n.b)("success","processing","error","default","warning"),(0,n.b)("pink","red","yellow","orange","cyan","green","blue","purple","geekblue","magenta","volcano","gold","lime"))},30365:(t,e,r)=>{r(75370)},75370:(t,e,r)=>{"use strict";var n=r(2136),o=r(82956),i=r(27460),a=r(1569);var s=function t(e){var r=new i(e),s=o(i.prototype.request,r);return n.extend(s,i.prototype,r),n.extend(s,r),s.create=function(r){return t(a(e,r))},s}(r(86492));s.Axios=i,s.CanceledError=r(64034),s.CancelToken=r(57767),s.isCancel=r(7367),s.VERSION=r(60056).version,s.toFormData=r(28982),s.AxiosError=r(81779),s.Cancel=s.CanceledError,s.all=function(t){return Promise.all(t)},s.spread=r(60539),s.isAxiosError=r(79901),t.exports=s,t.exports.default=s},39624:function(t){t.exports=function(){"use strict";var t=1e3,e=6e4,r=36e5,n="millisecond",o="second",i="minute",a="hour",s="day",c="week",u="month",l="quarter",h="year",f="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:m,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),o=r%60;return(e<=0?"+":"-")+m(n,2,"0")+":"+m(o,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),o=e.clone().add(n,u),i=r-o<0,a=e.clone().add(n+(i?-1:1),u);return+(-(n+(r-o)/(i?o-a:a-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:h,w:c,d:s,D:f,h:a,m:i,s:o,ms:n,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},b="en",w={};w[b]=v;var x=function(t){return t instanceof E},k=function t(e,r,n){var o;if(!e)return b;if("string"==typeof e){var i=e.toLowerCase();w[i]&&(o=i),r&&(w[i]=r,o=i);var a=e.split("-");if(!o&&a.length>1)return t(a[0])}else{var s=e.name;w[s]=e,o=s}return!n&&o&&(b=o),o||!n&&b},S=function(t,e){if(x(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new E(r)},O=g;O.l=k,O.i=x,O.w=function(t,e){return S(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var E=function(){function v(t){this.$L=k(t.locale,null,!0),this.parse(t)}var m=v.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===p)},m.isSame=function(t,e){var r=S(t);return this.startOf(e)<=r&&r<=this.endOf(e)},m.isAfter=function(t,e){return S(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<S(t)},m.$g=function(t,e,r){return O.u(t)?this[e]:this.set(r,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var r=this,n=!!O.u(e)||e,l=O.p(t),p=function(t,e){var o=O.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?o:o.endOf(s)},d=function(t,e){return O.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},y=this.$W,v=this.$M,m=this.$D,g="set"+(this.$u?"UTC":"");switch(l){case h:return n?p(1,0):p(31,11);case u:return n?p(1,v):p(0,v+1);case c:var b=this.$locale().weekStart||0,w=(y<b?y+7:y)-b;return p(n?m-w:m+(6-w),v);case s:case f:return d(g+"Hours",0);case a:return d(g+"Minutes",1);case i:return d(g+"Seconds",2);case o:return d(g+"Milliseconds",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var r,c=O.p(t),l="set"+(this.$u?"UTC":""),p=(r={},r[s]=l+"Date",r[f]=l+"Date",r[u]=l+"Month",r[h]=l+"FullYear",r[a]=l+"Hours",r[i]=l+"Minutes",r[o]=l+"Seconds",r[n]=l+"Milliseconds",r)[c],d=c===s?this.$D+(e-this.$W):e;if(c===u||c===h){var y=this.clone().set(f,1);y.$d[p](d),y.init(),this.$d=y.set(f,Math.min(this.$D,y.daysInMonth())).$d}else p&&this.$d[p](d);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(n,l){var f,p=this;n=Number(n);var d=O.p(l),y=function(t){var e=S(p);return O.w(e.date(e.date()+Math.round(t*n)),p)};if(d===u)return this.set(u,this.$M+n);if(d===h)return this.set(h,this.$y+n);if(d===s)return y(1);if(d===c)return y(7);var v=(f={},f[i]=e,f[a]=r,f[o]=t,f)[d]||1,m=this.$d.getTime()+n*v;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=O.z(this),i=this.$H,a=this.$m,s=this.$M,c=r.weekdays,u=r.months,l=function(t,r,o,i){return t&&(t[r]||t(e,n))||o[r].slice(0,i)},h=function(t){return O.s(i%12||12,t,"0")},f=r.meridiem||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n},d={YY:String(this.$y).slice(-2),YYYY:this.$y,M:s+1,MM:O.s(s+1,2,"0"),MMM:l(r.monthsShort,s,u,3),MMMM:l(u,s),D:this.$D,DD:O.s(this.$D,2,"0"),d:String(this.$W),dd:l(r.weekdaysMin,this.$W,c,2),ddd:l(r.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:O.s(i,2,"0"),h:h(1),hh:h(2),a:f(i,a,!0),A:f(i,a,!1),m:String(a),mm:O.s(a,2,"0"),s:String(this.$s),ss:O.s(this.$s,2,"0"),SSS:O.s(this.$ms,3,"0"),Z:o};return n.replace(y,(function(t,e){return e||d[t]||o.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(n,f,p){var d,y=O.p(f),v=S(n),m=(v.utcOffset()-this.utcOffset())*e,g=this-v,b=O.m(this,v);return b=(d={},d[h]=b/12,d[u]=b,d[l]=b/3,d[c]=(g-m)/6048e5,d[s]=(g-m)/864e5,d[a]=g/r,d[i]=g/e,d[o]=g/t,d)[y]||g,p?b:O.a(b)},m.daysInMonth=function(){return this.endOf(u).$D},m.$locale=function(){return w[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=k(t,e,!0);return n&&(r.$L=n),r},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},v}(),j=E.prototype;return S.prototype=j,[["$ms",n],["$s",o],["$m",i],["$H",a],["$W",s],["$M",u],["$y",h],["$D",f]].forEach((function(t){j[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),S.extend=function(t,e){return t.$i||(t(e,E,S),t.$i=!0),S},S.locale=k,S.isDayjs=x,S.unix=function(t){return S(1e3*t)},S.en=w[b],S.Ls=w,S.p={},S}()},42965:()=>{},98824:(t,e,r)=>{"use strict";var n=r(22767),o="function"==typeof Symbol&&Symbol.for,i=o?Symbol.for("react.element"):60103,a=o?Symbol.for("react.portal"):60106,s=o?Symbol.for("react.fragment"):60107,c=o?Symbol.for("react.strict_mode"):60108,u=o?Symbol.for("react.profiler"):60114,l=o?Symbol.for("react.provider"):60109,h=o?Symbol.for("react.context"):60110,f=o?Symbol.for("react.forward_ref"):60112,p=o?Symbol.for("react.suspense"):60113,d=o?Symbol.for("react.memo"):60115,y=o?Symbol.for("react.lazy"):60116,v="function"==typeof Symbol&&Symbol.iterator;function m(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(t,e,r){this.props=t,this.context=e,this.refs=b,this.updater=r||g}function x(){}function k(t,e,r){this.props=t,this.context=e,this.refs=b,this.updater=r||g}w.prototype.isReactComponent={},w.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(m(85));this.updater.enqueueSetState(this,t,e,"setState")},w.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},x.prototype=w.prototype;var S=k.prototype=new x;S.constructor=k,n(S,w.prototype),S.isPureReactComponent=!0;var O={current:null},E=Object.prototype.hasOwnProperty,j={key:!0,ref:!0,__self:!0,__source:!0};function L(t,e,r){var n,o={},a=null,s=null;if(null!=e)for(n in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)E.call(e,n)&&!j.hasOwnProperty(n)&&(o[n]=e[n]);var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];o.children=u}if(t&&t.defaultProps)for(n in c=t.defaultProps)void 0===o[n]&&(o[n]=c[n]);return{$$typeof:i,type:t,key:a,ref:s,props:o,_owner:O.current}}function P(t){return"object"==typeof t&&null!==t&&t.$$typeof===i}var _=/\/+/g,N=[];function T(t,e,r,n){if(N.length){var o=N.pop();return o.result=t,o.keyPrefix=e,o.func=r,o.context=n,o.count=0,o}return{result:t,keyPrefix:e,func:r,context:n,count:0}}function R(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>N.length&&N.push(t)}function C(t,e,r,n){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var s=!1;if(null===t)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case i:case a:s=!0}}if(s)return r(n,t,""===e?"."+I(t,0):e),1;if(s=0,e=""===e?".":e+":",Array.isArray(t))for(var c=0;c<t.length;c++){var u=e+I(o=t[c],c);s+=C(o,u,r,n)}else if(null===t||"object"!=typeof t?u=null:u="function"==typeof(u=v&&t[v]||t["@@iterator"])?u:null,"function"==typeof u)for(t=u.call(t),c=0;!(o=t.next()).done;)s+=C(o=o.value,u=e+I(o,c++),r,n);else if("object"===o)throw r=""+t,Error(m(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r,""));return s}function D(t,e,r){return null==t?0:C(t,"",e,r)}function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function M(t,e){t.func.call(t.context,e,t.count++)}function $(t,e,r){var n=t.result,o=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?F(t,n,r,(function(t){return t})):null!=t&&(P(t)&&(t=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,o+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(_,"$&/")+"/")+r)),n.push(t))}function F(t,e,r,n,o){var i="";null!=r&&(i=(""+r).replace(_,"$&/")+"/"),D(t,$,e=T(e,i,n,o)),R(e)}var A={current:null};function B(){var t=A.current;if(null===t)throw Error(m(321));return t}var U={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:O,IsSomeRendererActing:{current:!1},assign:n};e.Children={map:function(t,e,r){if(null==t)return t;var n=[];return F(t,n,null,e,r),n},forEach:function(t,e,r){if(null==t)return t;D(t,M,e=T(null,null,e,r)),R(e)},count:function(t){return D(t,(function(){return null}),null)},toArray:function(t){var e=[];return F(t,e,null,(function(t){return t})),e},only:function(t){if(!P(t))throw Error(m(143));return t}},e.Component=w,e.Fragment=s,e.Profiler=u,e.PureComponent=k,e.StrictMode=c,e.Suspense=p,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,e.cloneElement=function(t,e,r){if(null==t)throw Error(m(267,t));var o=n({},t.props),a=t.key,s=t.ref,c=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,c=O.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(l in e)E.call(e,l)&&!j.hasOwnProperty(l)&&(o[l]=void 0===e[l]&&void 0!==u?u[l]:e[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){u=Array(l);for(var h=0;h<l;h++)u[h]=arguments[h+2];o.children=u}return{$$typeof:i,type:t.type,key:a,ref:s,props:o,_owner:c}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:t},t.Consumer=t},e.createElement=L,e.createFactory=function(t){var e=L.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:f,render:t}},e.isValidElement=P,e.lazy=function(t){return{$$typeof:y,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:d,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return B().useCallback(t,e)},e.useContext=function(t,e){return B().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return B().useEffect(t,e)},e.useImperativeHandle=function(t,e,r){return B().useImperativeHandle(t,e,r)},e.useLayoutEffect=function(t,e){return B().useLayoutEffect(t,e)},e.useMemo=function(t,e){return B().useMemo(t,e)},e.useReducer=function(t,e,r){return B().useReducer(t,e,r)},e.useRef=function(t){return B().useRef(t)},e.useState=function(t){return B().useState(t)},e.version="16.14.0"},57689:(t,e,r)=>{"use strict";t.exports=r(98824)},8496:(t,e,r)=>{"use strict";r.d(e,{Z:()=>i});var n=r(27932),o=(r(42965),r(58801));const i=function(t){var e=t.size;return(0,o.jsx)("div",{className:"container-loading ".concat(e),children:(0,o.jsx)(n.Z,{})})}},40992:(t,e,r)=>{"use strict";r.d(e,{J:()=>o,r:()=>n});var n=function(t){var e=t.test,r=t.children,n=r.find((function(t){return t.props.default}))||null;return r.find((function(t){return t.props.value===e}))||n},o=function(t){return t.children}},6722:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var n={preview:{ws:"wss",domain:"preview.awesomescreenshot.com",cookie:"awesomescreenshot.com",schema:"https"},www:{ws:"wss",domain:"www.awesomescreenshot.com",cookie:"awesomescreenshot.com",schema:"https"},alpha:{ws:"wss",domain:"alpha.awesomescreenshot.com",cookie:"awesomescreenshot.com",schema:"https"},local:{ws:"wss",domain:"www.awesomescreenshot.cn",cookie:"awesomescreenshot.cn",schema:"https"}};for(var o in n){var i=n[o];i.baseUrl=i.schema+"://"+i.domain,i.wsUrl=i.ws+"://"+i.domain}const a=n.www},23689:(t,e,r)=>{"use strict";r.d(e,{Z:()=>v});r(79219);var n=r(27118),o=(r(87682),r(14632)),i=(r(54446),r(74193)),a=r(29185),s=r(45468),c=r(33534),u=r(780),l=r(6722),h=r(98907),f=r(58801);function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function d(){d=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:P(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};u(k,a,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,a)&&(k=O);var E=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==p(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=f;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(p(e)+" is not iterable")}return w.prototype=x,o(E,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=u(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),u(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function y(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}const v=function(t){var e=t.lists,r=t.poorNetWork,p=t.isRecorder;function v(t){if(t){var e=new Date;e.setTime(t);var r=e.getDate(),n=e.getMonth(),o=e.getFullYear();return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]+" "+["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct","Nov","Dec"][n]+" "+r+", "+o+",  "+e.toLocaleTimeString()}return""}function m(t){var e=t.target;e.attributes.datatype&&e.attributes.datatype.nodeValue&&(0,c.RB)(l.Z.baseUrl+"/video/"+e.attributes.datatype.nodeValue)}function g(t){return b.apply(this,arguments)}function b(){var t;return t=d().mark((function t(e){var r,n,o,i,a,u;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.stopPropagation(),!(r=e.target).attributes.datatype||!r.attributes.datatype.nodeValue){t.next=17;break}return n=r.attributes.datatype.nodeValue,n=parseInt(n),o=new s.Z,t.next=9,o.getDetail(n);case 9:return i=t.sent,t.next=12,o.getVideo(n);case 12:a=t.sent,u=i.title+".mp4",a=new Blob([a],{type:"video/mp4"}),chrome.permissions.request({permissions:["downloads"]},(function(t){if(t){var e={url:URL.createObjectURL(a),filename:u,saveAs:!0};(0,c.VC)(e)}}));case 17:case"end":return t.stop()}}),t)})),b=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){y(i,n,o,a,s,"next",t)}function s(t){y(i,n,o,a,s,"throw",t)}a(void 0)}))},b.apply(this,arguments)}function w(t){t.stopPropagation();var e=t.target;if(e.attributes.datatype&&e.attributes.datatype.nodeValue){var r=e.attributes.datatype.nodeValue;r=parseInt(r),p?(0,h.ws)("",r):chrome.runtime.sendMessage({action:"reUpload",target:"Recorder",data:r})}}function x(t){t.stopPropagation();var e=t.target;if(e.attributes.datatype&&e.attributes.datatype.nodeValue){var r=e.attributes.datatype.nodeValue;r=parseInt(r),i.Z.confirm({title:"Are you sure you want to delete the recording?",content:"If you haven't downloaded this recording, please do it first. Otherwise, you will lose it permanently.",okText:"Delete",cancelText:chrome.i18n.getMessage("discard_p_no"),onOk:function(){!function(t){t&&((new s.Z).remove(t),u.Z.dispatch("uploadingUpdate"),u.Z.dispatch("discardAction",t))}(r)},okType:"danger"})}}function k(t){t=Math.floor(t/1e3);var e=Math.floor(t/3600),r=Math.floor((t-3600*e)/60),n=t%60;return r<10&&e>0&&(r="0"+r),n<10&&(n="0"+n),(e>0?e+":":"")+r+":"+n}return(0,f.jsx)("div",{className:"uploading-list",children:e.map((function(t){return(0,f.jsxs)("div",{datatype:t.originId,className:"uploading-list-item",children:[t.processStatus&&"failed"===t.processStatus?(0,f.jsx)(a.Jw,{}):(0,f.jsx)(a.Bn,{}),(0,f.jsxs)("div",{className:"infos",datatype:t.originId,children:[(0,f.jsx)("div",{className:"title",children:t.title}),(0,f.jsx)("div",{className:"time",children:v(t.createAt)}),"completed"!==t.processStatus?(0,f.jsx)(o.Z,{type:"line",status:"active",showInfo:!1,percent:parseInt(100*t.progress),strokeColor:"#5794FF"}):(0,f.jsx)(f.Fragment,{}),(0,f.jsxs)("div",{className:"extra-field",children:[(0,f.jsx)("div",{className:"time",children:k(t.duration)}),(0,f.jsx)("div",{className:"time",children:(0,c.RD)(t.size)}),t.processStatus&&"failed"===t.processStatus?(0,f.jsx)("div",{className:"status failed",children:"Failed"}):(0,f.jsx)("div",{className:"status",children:"completed"==t.processStatus?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.qw,{}),"Upload completed"]}):"Uploading "+parseInt(100*t.progress)+"%"}),r&&"failed"!==t.processStatus&&"completed"!==t.processStatus?(0,f.jsx)("div",{className:"warning",children:" Poor network"}):""]}),(0,f.jsxs)("div",{className:"action-field "+(t.processStatus||r||!p?"":"recent"),children:[t.processStatus&&"completed"===t.processStatus?(0,f.jsxs)("div",{className:"action-btn uploaded",datatype:t.originId,onClick:m,children:["View ",(0,f.jsx)(a.jT,{})]}):(0,f.jsx)(f.Fragment,{}),"started"!=t.status&&"completed"!==t.processStatus&&(t.processStatus&&"failed"===t.processStatus||!p||r)?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(n.Z,{title:"Download Full Recording to Computer",placement:"top",overlayStyle:{maxWidth:"400px"},children:(0,f.jsx)("div",{className:"action-btn failed",datatype:t.key,onClick:g,children:(0,f.jsx)(a.$r,{})})},"export"),"failed"===t.processStatus?(0,f.jsx)(n.Z,{title:"Re-upload Full Recording to Cloud",children:(0,f.jsx)("div",{className:"action-btn failed",datatype:t.key,onClick:w,children:(0,f.jsx)(a.Rv,{})})},"upload"):(0,f.jsx)(f.Fragment,{}),(0,f.jsx)(n.Z,{title:"Delete",children:(0,f.jsx)("div",{className:"action-btn failed",datatype:t.key,onClick:x,children:(0,f.jsx)(a.R6,{})})},"delete")]}):(0,f.jsx)(f.Fragment,{})]})]})]},t.key)}))})}},94988:(t,e,r)=>{"use strict";r.d(e,{$:()=>s,x:()=>c});var n=r(33534),o=0,i=new Map,a=!1;function s(t,e){var r=o++;i.set(r+"",t);var n=isFinite(e)?e:0;return chrome.alarms.create(r+"",{when:Date.now()+n}),a||setTimeout((function(){!function(t){var e=i.get(t);e&&(i.delete(t),e())}(r+"")}),n),r}function c(t){i.get(t);i.delete(t+"")}(0,n.fx)()&&chrome.alarms&&chrome.alarms.onAlarm.addListener((function(t){a=!0;var e=t.name,r=i.get(e);r&&(i.delete(e),r())}))},780:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});const n={on:function(t,e){document.addEventListener(t,(function(t){return e(t.detail)}))},dispatch:function(t,e){document.dispatchEvent(new CustomEvent(t,{detail:e}))},remove:function(t,e){document.removeEventListener(t,e)}}},33534:(t,e,r)=>{"use strict";r.d(e,{RB:()=>p,RD:()=>f,VC:()=>c,fx:()=>h});r(39624),r(30365),r(73656),r(11791);var n=r(16810);function o(){o=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),s=new R(n||[]);return i(a,"_invoke",{value:P(t,r,s)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};h(k,c,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,c)&&(k=O);var E=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var u=p(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==s(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function P(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=x,i(E,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=h(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,h(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),h(L.prototype,u,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),h(E,l,"Generator"),h(E,c,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function i(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,c,"next",t)}function c(t){i(a,n,o,s,c,"throw",t)}s(void 0)}))}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t){return u.apply(this,arguments)}function u(){return(u=a(o().mark((function t(e){var r,i,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.filename,t.next=3,(0,n.S1)("save-as");case 3:return i=t.sent,t.next=6,(0,n.S1)("download_directory");case 6:a=t.sent,i&&a&&(e.filename=a+"/"+e.filename),chrome.downloads.download(e,(function(t){(void 0===t||chrome.runtime.lastError)&&l(e.url,r)}));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(t,e){var r=document.createElement("a"),n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.setAttribute("href",t),r.setAttribute("download",e),r.rel="noopener",r.dispatchEvent(n)}function h(){var t=navigator.userAgent,e=t.indexOf("Chrome/"),r=t.substring(e+7,t.length),n=r.indexOf("."),o=r.substring(0,n);return parseInt(o)<116}function f(t){if(0===t)return"0 Bytes";var e=parseInt(Math.floor(Math.log(t)/Math.log(1e3)),10);return(t/Math.pow(1e3,e)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][e]}function p(t){var e,r;e={},r=function(e){var r={url:t};e&&e.incognito||!e?chrome.windows.getAll((function(t){t.forEach((function(t){t.incognito||"normal"!==t.type||(r.windowId=t.id)})),d(r)})):(r.index=(e?e.index:currentTabIndex||0)+1,r.windowId=e?e.windowId:currentWindowId,d(r))},chrome.tabs.query(Object.assign({active:!0},e),(function(t){r(t[0])}))}function d(t){t&&t.url&&(t.hasOwnProperty("index")&&!t.index&&delete t.index,chrome.tabs.create(t,(function(t){chrome.windows.update(t.windowId,{focused:!0})})))}Math.pow(2,31)},37345:(t,e,r)=>{"use strict";function n(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))}r.d(e,{m:()=>n})},45468:(t,e,r)=>{"use strict";r.d(e,{Z:()=>p});var n=r(37345);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=s(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(c)throw i}}}}function a(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),s=new R(n||[]);return i(a,"_invoke",{value:P(t,r,s)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};h(k,s,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,s)&&(k=O);var E=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(i,a,s,c){var u=p(t[i],t,a);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=x,i(E,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=h(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,h(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),h(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),h(E,l,"Generator"),h(E,s,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function h(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var f=2e5,p=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.DBName="videos",this.DBVersion=1,this.detailStoreName="detail",this.fmp4StoreName="fmp4",this.webmStoreName="webm",this.handleUpgradeNeeded=this.handleUpgradeNeeded.bind(this)},(e=[{key:"openDb",value:function(){return(0,n.m)(this,void 0,void 0,u().mark((function t(){var e,r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.openPromise){t.next=2;break}return t.abrupt("return",this.openPromise);case 2:return e=indexedDB.open(this.DBName,this.DBVersion),this.openPromise=new Promise((function(t,n){e.onupgradeneeded=r.handleUpgradeNeeded,e.onsuccess=function(){t(e.result)},e.onerror=function(t){n()}})),t.next=6,this.openPromise;case 6:return this.db=t.sent,t.abrupt("return",this.db);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"handleUpgradeNeeded",value:function(t){return(0,n.m)(this,void 0,void 0,u().mark((function e(){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.target.result,t.oldVersion<this.DBVersion&&(r.createObjectStore(this.detailStoreName,{autoIncrement:!0}),r.createObjectStore(this.fmp4StoreName,{keyPath:"key"}),r.createObjectStore(this.webmStoreName,{keyPath:"key"}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"create",value:function(t){return(0,n.m)(this,void 0,void 0,u().mark((function e(){var r,n,o,i,s,c,l,h,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(null==t?void 0:t.mimeType)||"video/webm",n=r.match(/video\/webm/)?this.webmStoreName:r.match(/video\/mp4/)?this.fmp4StoreName:this.webmStoreName,t=Object.assign(Object.assign({mimeType:r,storeName:n},t),{status:"created",createAt:Date.now()}),this.currentSliceStore=t.storeName,this.db){e.next=7;break}return e.next=7,this.openDb();case 7:return o=this.db.transaction([this.detailStoreName,this.currentSliceStore],"readwrite"),i=o.objectStore(this.currentSliceStore),s=i.getAllKeys(),e.next=12,new Promise((function(t,e){s.onsuccess=function(){var e=s.result;if(0==e.length)return t(0);t(Math.max.apply(Math,a(e)))},s.onerror=function(){return e()}}));case 12:return c=e.sent,this.sliceKeyStart=c?c+f-c%f:0,this.currentSliceKey=this.sliceKeyStart,this.currentSize=0,i.put({key:this.sliceKeyStart,data:new Blob([])}),this.detail=Object.assign(Object.assign({},t),{sliceStart:this.sliceKeyStart}),l=o.objectStore(this.detailStoreName),h=l.add(this.detail),e.next=22,new Promise((function(t,e){h.onsuccess=function(){return t(h.result)},h.onerror=function(){return e()}}));case 22:return p=e.sent,this.detail=Object.assign({key:p},this.detail),this.update(this.detail),this.isOpen=!0,e.abrupt("return",this.detail);case 27:case"end":return e.stop()}}),e,this)})))}},{key:"push",value:function(t,e){return(0,n.m)(this,void 0,void 0,u().mark((function r(){var n,o,i,a,s;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t&&t.size){r.next=2;break}return r.abrupt("return");case 2:if(this.isOpen){r.next=5;break}return r.abrupt("return");case 5:if(!(this.currentSliceKey-this.sliceKeyStart>=f)){r.next=8;break}return r.abrupt("return");case 8:return n=this.currentSliceKey++,o=this.db.transaction(this.currentSliceStore,"readwrite"),i=o.objectStore(this.currentSliceStore),a=i.put({key:n,uploaded:!1,data:t,offset:n-this.sliceKeyStart,sizeOffset:this.currentSize}),s=new Promise((function(t,e){a.onsuccess=function(){return t()},a.onerror=function(){return e()}})),this.currentSize+=t.size,this.detail=Object.assign(Object.assign(Object.assign({},this.detail),e),{status:"started",sliceEnd:this.currentSliceKey,size:this.currentSize}),this.update(this.detail),r.abrupt("return",s);case 18:case"end":return r.stop()}}),r,this)})))}},{key:"update",value:function(t,e){return(0,n.m)(this,void 0,void 0,u().mark((function r(){var n,o,i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(isFinite(e)||(e=this.detail.key),isFinite(e)){r.next=5;break}return r.abrupt("return");case 5:return this.detail=Object.assign(Object.assign(Object.assign({},this.detail),t),{updateAt:Date.now(),key:e}),n=this.db.transaction(this.detailStoreName,"readwrite"),o=n.objectStore(this.detailStoreName),i=o.put(this.detail,this.detail.key),r.next=11,new Promise((function(t,e){i.onsuccess=function(){return t()},i.onerror=function(){return e()}}));case 11:return r.abrupt("return",this.detail);case 12:case"end":return r.stop()}}),r,this)})))}},{key:"close",value:function(t){return(0,n.m)(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.detail=Object.assign(Object.assign(Object.assign({},this.detail),{status:"closed",sliceEnd:this.currentSliceKey,closeAt:Date.now()}),isFinite(t)?{duration:t}:{}),this.update(this.detail),this.isOpen=!1;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"remove",value:function(t){return(0,n.m)(this,void 0,void 0,u().mark((function e(){var r,n,o,i,a,s,c,l,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return e.next=3,this.openDb();case 3:return this.isOpen&&(this.isOpen=!1),!t&&this.detail&&this.detail.key&&(t=this.detail.key),r=this.db.transaction([this.detailStoreName,this.fmp4StoreName,this.webmStoreName],"readwrite"),n=r.objectStore(this.detailStoreName),o=n.get(t),e.next=11,new Promise((function(t,e){o.onsuccess=function(){return t(o.result)},o.onerror=function(){return e()}}));case 11:return i=e.sent,a=r.objectStore(i.storeName),s=isFinite(i.sliceEnd)?i.sliceEnd:i.sliceStart+f,c=IDBKeyRange.bound(i.sliceStart,s,!1,s>i.sliceStart),l=a.delete(c),e.next=19,new Promise((function(t,e){l.onsuccess=function(){return t()},l.onerror=function(){return e()}}));case 19:return h=n.delete(i.key),e.next=22,new Promise((function(t,e){h.onsuccess=function(){return t()},h.onerror=function(){return e()}}));case 22:case"end":return e.stop()}}),e,this)})))}},{key:"cleanup",value:function(){return(0,n.m)(this,void 0,void 0,u().mark((function t(){var e,r,n,o,a,s,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.openDb();case 3:return e=this.db.transaction(this.detailStoreName,"readonly"),r=e.objectStore(this.detailStoreName),n=r.getAllKeys(),t.next=8,new Promise((function(t,e){n.onsuccess=function(){return t(n.result)},n.onerror=function(){return e()}}));case 8:o=t.sent,a=i(o),t.prev=10,a.s();case 12:if((s=a.n()).done){t.next=18;break}return c=s.value,t.next=16,this.remove(c);case 16:t.next=12;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(10),a.e(t.t0);case 23:return t.prev=23,a.f(),t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[10,20,23,26]])})))}},{key:"getDetail",value:function(t){return(0,n.m)(this,void 0,void 0,u().mark((function e(){var r,n,o,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return e.next=3,this.openDb();case 3:return r=this.db.transaction(this.detailStoreName,"readonly"),n=r.objectStore(this.detailStoreName),o=n.get(t),e.next=8,new Promise((function(t,e){o.onsuccess=function(){return t(o.result)},o.onerror=function(){return e()}}));case 8:return i=e.sent,this.detail=i,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})))}},{key:"getAllDetail",value:function(){return(0,n.m)(this,void 0,void 0,u().mark((function t(){var e,r,n,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.db){t.next=3;break}return t.next=3,this.openDb();case 3:return e=this.db.transaction(this.detailStoreName,"readonly"),r=e.objectStore(this.detailStoreName),n=r.getAll(),t.next=8,new Promise((function(t,e){n.onsuccess=function(){return t(n.result)},n.onerror=function(){return e()}}));case 8:return o=t.sent,t.abrupt("return",o);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getVideo",value:function(t){return(0,n.m)(this,void 0,void 0,u().mark((function e(){var r,n,o,i,a,s,c,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return e.next=3,this.openDb();case 3:return e.next=5,this.getDetail(t);case 5:if(r=e.sent,n=this.db.transaction(r.storeName,"readonly"),o=n.objectStore(r.storeName),(i=isFinite(r.sliceEnd)?r.sliceEnd:r.sliceStart+f)!==r.sliceStart){e.next=11;break}return e.abrupt("return",new Blob([],{type:r.mimeType}));case 11:return a=IDBKeyRange.bound(r.sliceStart,i,!1,!0),s=o.getAll(a),e.next=15,new Promise((function(t,e){s.onsuccess=function(){return t(s.result)},s.onerror=function(){return e()}}));case 15:return c=e.sent,l=c.map((function(t){return t.data})),e.abrupt("return",new Blob(l,{type:r.mimeType}));case 19:case"end":return e.stop()}}),e,this)})))}},{key:"getSlice",value:function(t,e){return(0,n.m)(this,void 0,void 0,u().mark((function r(){var n,o,i,a,s,c;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.db){r.next=3;break}return r.next=3,this.openDb();case 3:if(t===this.getSliceKey){r.next=8;break}return this.getSliceKey=t,r.next=7,this.getDetail(t);case 7:this.getSliceDetail=r.sent;case 8:return n=this.getSliceDetail,o=n.sliceStart+e,i=this.db.transaction(n.storeName,"readonly"),a=i.objectStore(n.storeName),s=a.get(o),r.next=16,new Promise((function(t,e){s.onsuccess=function(){s.result?t(s.result):t(null)},s.onerror=function(){return e()}}));case 16:return c=r.sent,r.abrupt("return",c);case 18:case"end":return r.stop()}}),r,this)})))}},{key:"deleteSlice",value:function(t,e){return(0,n.m)(this,void 0,void 0,u().mark((function r(){var n,o,i,a,s,c;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.db){r.next=3;break}return r.next=3,this.openDb();case 3:if(t===this.getSliceKey){r.next=8;break}return this.getSliceKey=t,r.next=7,this.getDetail(t);case 7:this.getSliceDetail=r.sent;case 8:return n=this.getSliceDetail,o=n.sliceStart+e,i=IDBKeyRange.bound(n.sliceStart,o,!1,o>n.sliceStart),a=this.db.transaction(n.storeName,"readwrite"),s=a.objectStore(n.storeName),c=s.delete(i),r.next=16,new Promise((function(t,e){c.onsuccess=function(){return t()},c.onerror=function(){return e()}}));case 16:case"end":return r.stop()}}),r,this)})))}},{key:"updateSlice",value:function(t,e,r){return(0,n.m)(this,void 0,void 0,u().mark((function n(){var o,i,a,s,c,l,h,f;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.db){n.next=3;break}return n.next=3,this.openDb();case 3:if(r===this.getSliceKey&&this.getSliceDetail){n.next=13;break}if(this.getSliceKey=r,!r){n.next=11;break}return n.next=8,this.getDetail(r);case 8:n.t0=n.sent,n.next=12;break;case 11:n.t0=Object.assign({},this.detail);case 12:this.getSliceDetail=n.t0;case 13:return o=this.getSliceDetail,i=o.sliceStart+t,a=this.db.transaction(o.storeName,"readwrite"),s=a.objectStore(o.storeName),c=s.get(i),n.next=20,new Promise((function(t,e){c.onsuccess=function(){c.result?t(c.result):t(null)},c.onerror=function(){return e()}}));case 20:return l=n.sent,h=Object.assign(Object.assign({},l),e),f=s.put(h),n.next=25,new Promise((function(t,e){f.onsuccess=function(e){return t(e.target)},f.onerror=function(){return e()}}));case 25:case"end":return n.stop()}}),n,this)})))}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()},38756:(t,e,r)=>{"use strict";r.d(e,{Q:()=>z});var n=r(37345);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){i=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),s=new R(n||[]);return a(i,"_invoke",{value:P(t,r,s)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};h(k,c,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,c)&&(k=O);var E=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(i,a,s,c){var u=p(t[i],t,a);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=x,a(E,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=h(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,h(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),h(L.prototype,u,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),h(E,l,"Generator"),h(E,c,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var c="queue-blob-placeholder";function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function f(){f=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:P(t,r,s)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};l(k,a,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,a)&&(k=O);var E=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var c=p(t[o],t,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(E,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),l(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),l(E,c,"Generator"),l(E,a,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==u(e)?e:e+""}function y(t,e,r){return e=m(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,v()?Reflect.construct(e,r||[],m(t).constructor):e.apply(t,r))}function v(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(v=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function w(){w=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new R(n||[]);return o(a,"_invoke",{value:P(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function x(){}var k={};u(k,a,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,a)&&(k=O);var E=x.prototype=m.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==b(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(b(e)+" is not iterable")}return g.prototype=x,o(E,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:g,configurable:!0}),g.displayName=u(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),u(L.prototype,s,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function k(t){var e=function(t,e){if("object"!=b(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==b(e)?e:e+""}function S(t,e,r){return e=j(e),function(t,e){if(e&&("object"==b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,O()?Reflect.construct(e,r||[],j(t).constructor):e.apply(t,r))}function O(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(O=function(){return!!t})()}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},E.apply(null,arguments)}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}function L(t,e){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},L(t,e)}function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function N(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}function T(t,e,r){return e=I(e),function(t,e){if(e&&("object"==P(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,R()?Reflect.construct(e,r||[],I(t).constructor):e.apply(t,r))}function R(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(R=function(){return!!t})()}function C(t,e,r,n){var o=D(I(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function D(){return D="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=I(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},D.apply(null,arguments)}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function M(t,e){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M(t,e)}function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function F(){F=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),s=new N(n||[]);return o(a,"_invoke",{value:j(t,r,s)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==$(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=L(s,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError($(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},O(E.prototype),u(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(S),u(S,c,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t,e){if("object"!=$(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==$(e)?e:e+""}function U(t,e,r){return e=Q(e),function(t,e){if(e&&("object"==$(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,G()?Reflect.construct(e,r||[],Q(t).constructor):e.apply(t,r))}function G(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(G=function(){return!!t})()}function q(t,e,r,n){var o=K(Q(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function K(){return K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Q(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},K.apply(null,arguments)}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}function Y(t,e){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Y(t,e)}var z=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=U(this,e,[t])).getMessage=function(t){return(0,n.m)(r,void 0,void 0,F().mark((function e(){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("complete"!=t.messageType){e.next=2;break}return e.abrupt("return",JSON.stringify(Object.assign(Object.assign({},t.data),{videoName:this.videoName})));case 2:case"end":return e.stop()}}),e,this)})))},r.apiBase=t.apiBase,r.token=t.token,r.uid=t.uid,r.handleResponseResult=r.handleResponseResult.bind(r),r.uploadProtocal="websocket",r.socketCloseTimeline=[],r.httpTraceId=Math.round(1e6*Math.random()),r.payload={},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Y(t,e)}(e,t),r=e,(o=[{key:"payloadData",value:function(){var t=this.payload,e={};t.locationType&&t.locationId&&(e.scope={type:this.payload.locationType,id:this.payload.locationId});var r={};return t.tabUrl&&(r.sourceURL=t.tabUrl),t.appVersion&&(r.userAgent=t.appVersion),t.recordType&&(r.recordType=t.recordType),t.recorderVersion&&(r.extVersion=t.recorderVersion),t.screenSize&&(r.screenSize=t.screenSize),t.appAndPlatform&&(r.client=t.appAndPlatform),e.extra=r,e}},{key:"getInitData",value:function(){var t=this.payloadData(),e=this.payload.videoCodec;return JSON.stringify(Object.assign(Object.assign({},t),{type:"init",title:this.title,token:this.token,userID:this.uid,videoCodec:e||"webm"}))}},{key:"getRecoverData",value:function(){var t=this.payloadData();return JSON.stringify(Object.assign(Object.assign({},t),{type:"recover",videoName:this.videoName,token:this.token,userID:this.uid}))}},{key:"getCompleteData",value:function(){return JSON.stringify({type:"complete",videoName:this.videoName,stopAt:Date.now()/1e3})}},{key:"getInitRequest",value:function(t){}},{key:"getCancelRequest",value:function(){var t="?t="+this.httpTraceId,e=this.apiBase+"/api/v1/record/discard"+t;return this.isStarted||(e=e.replace("discard","cancel")),new Request(e,{headers:{Authorization:this.token},method:"DELETE"})}},{key:"getRecoverRequest",value:function(){var t="?t="+this.httpTraceId,e=this.apiBase+"/record/file_upload_progress"+t;return new Request(e,{headers:{Authorization:this.token},method:"GET"})}},{key:"getUploadRequest",value:function(t){if(t instanceof Blob){var e="?t="+this.httpTraceId+"&i="+this.outQueueIndex,r=this.apiBase+"/record/file_upload"+e,n=new FormData;return n.append("video_id",this.id),n.append("file",t),new Request(r,{headers:{Authorization:this.token},method:"POST",body:n})}if("string"==typeof t)try{var o=JSON.parse(t);null==o||o.type}catch(t){}}},{key:"ready",value:function(t){return(0,n.m)(this,void 0,void 0,F().mark((function e(){var r,n=this;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.key=Date.now()+Math.random().toString(36),this.id="",this.temSid="",this.isPushDone=!1,this.isCancel=!1,this.isFirstSliceReported=!1,this.isStarted=!1,this.title=t.title,this.payload=t.payload||{},this.push(this.getInitData()),r=new Promise((function(t,e){n.initDone=t,setTimeout((function(){e()}),6e5)})),this.socketConnect().finally((function(){return n.switchProtocal(n.uploadProtocal)})).then((function(){return r})).then((function(){n.onConnected&&n.onConnected(n.key,{vid:n.id,sid:n.temSid,backupDetails:{videoName:n.videoName}}),n.updateSid(n.temSid)})).catch((function(t){n.isNetWorkError=!0,n.haveRetryFailed(!0),n.handleNetWorkInfo()})),e.abrupt("return",this.key);case 14:case"end":return e.stop()}}),e,this)})))}},{key:"replenish",value:function(t,e){return(0,n.m)(this,void 0,void 0,F().mark((function r(){var n=this;return F().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.id=t,this.videoName=e,this.isFirstSliceReported=!0,this.isReplenish=!0,this.isReplenishRevise=!0,this.switchProtocal("websocket"),r.abrupt("return",new Promise((function(t,e){n.replenishReviseResolve=t})));case 7:case"end":return r.stop()}}),r,this)})))}},{key:"netWorkRetryFailed",value:function(){q(e,"netWorkRetryFailed",this,3)([]),this.isNetWorkError=!0,this.haveRetryFailed(!0),this.handleNetWorkInfo()}},{key:"handleNetWorkInfo",value:function(){this.isPushDone&&this.isNetWorkError&&!this.isCanceling&&this.onError&&this.onError(this.key,{type:"networkError"})}},{key:"hackStopAction",value:function(){if(this.isPushDone&&!this.haveStop&&!this.isCanceling){var t,e={type:"queue-message-placeholder",messageType:"complete",data:{type:"complete",stopAt:Date.now()/1e3}};t=JSON.stringify(e),this.push(t),this.haveStop=!0}}},{key:"switchProtocal",value:function(t){return(0,n.m)(this,void 0,void 0,F().mark((function e(){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"http"===t?(this.uploadProtocal="http",this.startHttpUpload(),this.frozenSocketUpload(),this.reviveHttpUpload()):(this.uploadProtocal="websocket",this.startSocketUpload(),this.frozenHttpUpload(),this.reviveSocketUpload());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"start",value:function(){return q(e,"start",this,3)([]),this.getData()}},{key:"pause",value:function(){this.videoName&&this.push(JSON.stringify({type:"pause",videoName:this.videoName,reason:"user click"}))}},{key:"resume",value:function(){this.reportConnection()}},{key:"stop",value:function(t){return t.duration,t.size,(0,n.m)(this,void 0,void 0,F().mark((function t(){var e=this;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setTimeout((function(){var t;e.videoName&&e.id&&(t=e.getCompleteData(),e.haveStop=!0,e.push(t)),e.isPushDone=!0,e.handleNetWorkInfo()}),0),this.isReplenish,this.reportConnection();case 4:case"end":return t.stop()}}),t,this)})))}},{key:"cancel",value:function(){return(0,n.m)(this,void 0,void 0,F().mark((function t(){var e,r=this;return F().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.push(JSON.stringify({type:"cancel",videoName:this.videoName})),this.isPushDone=!0,this.isCanceling=!0,e=new Promise((function(t){r.socketCancelResolve=t,r.setTimeout(t,12e4)})),t.next=7,e;case 7:this.isCancel=!0,this.initQueue(),this.disconnect(),this.monitorStop();case 11:case"end":return t.stop()}}),t,this)})))}},{key:"push",value:function(t){var r=!1;t instanceof Blob||"complete"!==JSON.parse(t).messageType||this.haveStop||(r=!0),(!0!==this.isPushDone||r)&&!0!==this.isError&&(t instanceof Blob&&0===t.size||(q(e,"push",this,3)([t]),!this.isFirstSliceReported&&t instanceof Blob&&this.firstSliceReport(t)))}},{key:"handleMessageData",value:function(t){if(this.isNetWorkError=!1,"true"===t.close&&"cancel"!==t.type)return this.isError=!0,void(this.onError&&this.onError(this.key,{type:"unknown",message:t.message}));switch(this.handleResponseResult(t.type,parseInt(t.id)),t.type){case"init":case"recover":this.id=t.videoID||this.id,t.sid&&(this.temSid=t.sid),this.videoName=t.videoName||this.videoName,t.videoURI&&(this.videoUrl=t.videoURI),this.connectingDone&&this.connectingDone(!0);break;case"cancel":this.socketCancelResolve&&this.socketCancelResolve();break;case"complete":this.videoUrl=t.videoURI}"init"==t.type&&this.isPushDone&&!this.haveStop&&this.hackStopAction()}},{key:"handleResponseResult",value:function(t,e){switch(t){case"init":this.sliceIndexOffset+=1,this.handleQueueResponse(this.sliceIndex+this.sliceIndexOffset),"function"==typeof this.initDone&&(this.initDone(),this.monitorStart());break;case"slice":this.sliceIndex=e-1,this.handleQueueResponse(this.sliceIndex+this.sliceIndexOffset),this.onSliceUploaded&&this.onSliceUploaded(this.key,this.sliceIndex);break;case"pause":this.sliceIndexOffset+=1,this.handleQueueResponse(this.sliceIndex+this.sliceIndexOffset);break;case"recover":this.sliceIndex=isFinite(e)?e-1:this.sliceIndex,this.isReplenishRevise&&(this.replenishRevise(this.sliceIndex),this.replenishReviseResolve&&this.replenishReviseResolve(this.sliceIndex),this.isReplenishRevise=!1,this.replenishReviseResolve=null),this.revise(this.sliceIndex);break;case"complete":this.sliceIndexOffset+=1,this.handleQueueResponse(this.sliceIndex+this.sliceIndexOffset),this.disconnect()}}},{key:"getData",value:function(){return{vid:this.id,title:this.title,videoUrl:this.videoUrl}}},{key:"refreshProgress",value:function(){var t=q(e,"refreshProgress",this,3)([]);!0!==this.isPushDone||this.isCancel||t.finished!==t.total||"function"!=typeof this.onSuccess||(this.monitorStop(),this.onSuccess(this.key,this.getData()),this.disconnect());try{this.onProgress&&this.onProgress(this.key,t.finished/(this.totalBackupSlices&&this.totalBackupSlices>0?this.totalBackupSlices:t.total),t)}catch(t){}return t}},{key:"firstSliceReport",value:function(t){}},{key:"beaconReport",value:function(t,e){}},{key:"connectionReport",value:function(t,e){}},{key:"onSocketRecover",value:function(){q(e,"onSocketRecover",this,3)([])}},{key:"onSocketClose",value:function(t){q(e,"onSocketClose",this,3)([t]),this.socketCloseTimeline.push(Date.now()),isFinite(this.socketCloseCount)||(this.socketCloseCount=0),this.socketCloseTimeline.length>5&&(this.socketCloseTimeline=this.socketCloseTimeline.slice(-5)),this.socketCloseCount++,this.socketCloseTimeline.length>=5&&(Date.now(),this.socketCloseTimeline[0]),this.isCanceling&&(this.isCancel=!0)}},{key:"onSocketBlocking",value:function(){q(e,"onSocketBlocking",this,3)([])}},{key:"updateBackupSlices",value:function(t){t&&t>0&&(this.totalBackupSlices=t)}},{key:"httpReportStop",value:function(t,e){var r=this,n=this.apiBase+"/api/v1/video/click_stop";return new Promise((function(o,i){fetch(n,{headers:{},method:"POST",body:t?JSON.stringify({videoID:r.id,sliceTotal:r.totalSlice+"",reason:t,duration:e+""}):JSON.stringify({videoID:r.id,sliceTotal:r.totalSlice+"",duration:e+""})}).then((function(){o("ok")})).catch((function(){i("failed")}))}))}}])&&A(r.prototype,o),i&&A(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i}(function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=T(this,e,[t])).initConnection(),r.initSocketMeasurement(),r.handleUnload=r.handleUnload.bind(r),r.handleConnectionChange=r.handleConnectionChange.bind(r),r.lastReportAt=Date.now(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(e,t),r=e,n=[{key:"start",value:function(){C(e,"start",this,3)([])}},{key:"initConnection",value:function(){this.downlink={min:1/0,max:0,total:0,count:0},this.connectionRtt={min:1/0,max:0,total:0,count:0},this.connectionType={fastest:"slow-2g",slowest:"4g"}}},{key:"monitorStart",value:function(){window.addEventListener("unload",this.handleUnload),navigator.connection&&(this.handleConnectionChange(),navigator.connection.addEventListener("change",this.handleConnectionChange)),this.proxyFetch()}},{key:"monitorStop",value:function(){window.removeEventListener("unload",this.handleUnload),navigator.connection&&navigator.connection.removeEventListener("change",this.handleConnectionChange),this.revokeProxyFetch()}},{key:"reportConnection",value:function(){Date.now()-this.lastReportAt<3e4||(this.connectionReport(this.getConnection(),this.getServerConnection()),this.lastReportAt=Date.now())}},{key:"handleQueueResponse",value:function(t){C(e,"handleQueueResponse",this,3)([t]);var r=Date.now();r-this.lastReportAt>18e5&&this.reportConnection();var n=this.getQueueProgress(),o=n.finished,i=n.current;i-o>10&&r-this.lastReportAt>12e4&&this.reportConnection(),i-o>30&&r-this.lastReportAt>6e4&&this.reportConnection()}},{key:"proxyFetch",value:function(){var t=this;this.fetchProxy=Proxy.revocable(window.fetch,{apply:function(e,r,n){var o=Date.now(),i=e.apply(null,n);return i.then((function(e){var r=Date.now()-o;t.socketRtt.total+=r,t.socketRtt.count+=1,t.socketRtt.min>r&&(t.socketRtt.min=r),t.socketRtt.max<r&&(t.socketRtt.max=r)})),i}}),this.originalFetch=this.fetch,this.fetch=this.fetchProxy.proxy,this.fetch=this.fetch.bind(null)}},{key:"revokeProxyFetch",value:function(){this.originalFetch&&(this.fetch=this.originalFetch,this.fetch=this.fetch.bind(null)),this.fetchProxy&&(this.fetchProxy.revoke(),this.fetchProxy=null)}},{key:"compareNetwork",value:function(t,e){var r=["5g","4g","3g","2g","slow-2g"],n=r.findIndex((function(e){return e===t}));return r.findIndex((function(t){return t===e}))-n}},{key:"handleConnectionChange",value:function(){if(navigator.connection){var t=navigator.connection,e=t.downlink,r=t.rtt,n=t.effectiveType;this.downlink.total+=e,this.downlink.count+=1,this.downlink.min>e&&(this.downlink.min=e),this.downlink.max<e&&(this.downlink.max=e),this.connectionRtt.total+=r,this.connectionRtt.count+=1,this.connectionRtt.min>r&&(this.connectionRtt.min=r),this.connectionRtt.max<r&&(this.connectionRtt.max=r),this.compareNetwork(this.connectionType.fastest,n)<0&&(this.connectionType.fastest=n),this.compareNetwork(this.connectionType.slowest,n)>0&&(this.connectionType.slowest=n)}}},{key:"getConnection",value:function(){return{downlink:{max:Math.round(25*this.downlink.max),min:Math.round(25*this.downlink.min),avg:Math.round(this.downlink.total/this.downlink.count*25)},rtt:{max:25*this.connectionRtt.max,min:25*this.connectionRtt.min,avg:Math.round(this.connectionRtt.total/this.connectionRtt.count*25)},effective_type:{best:this.connectionType.fastest,worst:this.connectionType.slowest}}}},{key:"getServerConnection",value:function(){var t=this.socketBandwidth,e=this.socketRtt,r=(null==t?void 0:t.total)/(null==t?void 0:t.count),n=this.getQueueProgress(),o=n.finished,i=n.total;return{uplink:{max:Math.round(null==t?void 0:t.max),min:Math.round(null==t?void 0:t.min),avg:Math.round(r)},rtt:{max:e.max,min:e.min,avg:Math.round(e.total/e.count)},progress:Math.round(this.loaded/this.total*100),queue_progress:o+"/"+i,remaining_time_estimate:Math.round((this.total-this.loaded)/r)}}},{key:"handleUnload",value:function(){this.beaconReport(this.getConnection(),this.getServerConnection())}},{key:"onSocketRecover",value:function(){C(e,"onSocketRecover",this,3)([]),this.reportConnection()}},{key:"initSocketMeasurement",value:function(){this.socketMeasurement={startAt:0,startLoaded:0,startFinished:-1,ongoing:!1},this.socketBandwidth={min:1/0,max:0,total:0,count:0},this.socketRtt={min:1/0,max:0,total:0,count:0}}},{key:"onSocketMessage",value:function(t){C(e,"onSocketMessage",this,3)([t]);var r=this.getQueueProgress(),n=r.finished,o=r.current,i=this.loaded;this.total;var a=this.socketMeasurement,s=a.ongoing,c=a.startLoaded,u=a.startAt,l=a.startFinished;if((n===o||n-l>=20)&&s){var h=(i-c)/(Date.now()-u);this.socketBandwidth.total+=h,this.socketBandwidth.count+=1,this.socketBandwidth.min>h&&(this.socketBandwidth.min=h),this.socketBandwidth.max<h&&(this.socketBandwidth.max=h),this.socketMeasurement.ongoing=!1}}},{key:"onSocketUpload",value:function(t){C(e,"onSocketUpload",this,3)([t]);var r=this.socketMeasurement.ongoing,n=this.loaded,o=this.getQueueProgress().finished;!r&&t instanceof Blob&&(this.socketMeasurement={startAt:Date.now(),startLoaded:n,startFinished:o,ongoing:!0})}}],n&&_(r.prototype,n),o&&_(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=S(this,e,[t])).httpDormant=!0,r.fetch=t.fetch||window.fetch,r.fetch=r.fetch.bind(null),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}(e,t),r=e,o=[{key:"start",value:function(){var t,r,n,o,i;(t=e,r="start",n=this,i=E(j(1&(o=3)?t.prototype:t),r,n),2&o&&"function"==typeof i?function(t){return i.apply(n,t)}:i)([])}},{key:"httpConnect",value:function(){return(0,n.m)(this,void 0,void 0,w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))}},{key:"startHttpUpload",value:function(){var t=this,e=function(){return(0,n.m)(t,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.isCancel||this.isError||this.isDone)){t.next=2;break}return t.abrupt("return");case 2:if(r=1e3,!0===this.httpDormant||!0===this.isPending){t.next=13;break}return t.next=8,this.get();case 8:if(null===(n=t.sent)){t.next=13;break}return t.next=12,this.httpUpload(n);case 12:r=100;case 13:this.setTimeout(e,r);case 14:case"end":return t.stop()}}),t,this)})))};e()}},{key:"httpUpload",value:function(t){return(0,n.m)(this,void 0,void 0,w().mark((function e(){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getUploadRequest(t),e.next=3,this.persistFetch(r);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"httpPause",value:function(){this.handleResponseResult("pause",this.sliceIndex)}},{key:"httpRecover",value:function(){return(0,n.m)(this,void 0,void 0,w().mark((function t(){var e,r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isPending=!0,e=this.getRecoverRequest(),t.prev=2,t.next=5,this.persistFetch(e);case 5:return r=t.sent,t.next=8,r.json();case 8:n=t.sent,this.handleResponseResult("recover",n.data.slice_index),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),this.onError(this,t.t0);case 15:this.isPending=!1;case 16:case"end":return t.stop()}}),t,this,[[2,12]])})))}},{key:"httpCancel",value:function(){var t=this.getCancelRequest();this.persistFetch(t)}},{key:"retryStrategy",value:function(t,e,r){return t?-1:Math.max(0,1e3*(r-1)*2)}},{key:"persistFetch",value:function(t){return(0,n.m)(this,void 0,void 0,w().mark((function e(){var r,n,o,i,a=this;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=0,o=0;case 3:if(r){e.next=26;break}return n++,r=!0,e.prev=6,e.next=9,this.fetch(t);case 9:if(i=e.sent,(o=this.retryStrategy(i,null,n))>=0&&(r=!1),!r){e.next=14;break}return e.abrupt("return",i);case 14:e.next=22;break;case 16:if(e.prev=16,e.t0=e.catch(6),(o=this.retryStrategy(null,e.t0,n))>=0&&(r=!1),!r){e.next=22;break}throw e.t0;case 22:return e.next=24,new Promise((function(t){a.setTimeout((function(){return t()}),o)}));case 24:e.next=3;break;case 26:case"end":return e.stop()}}),e,this,[[6,16]])})))}},{key:"frozenHttpUpload",value:function(){this.httpDormant=!0}},{key:"reviveHttpUpload",value:function(){return(0,n.m)(this,void 0,void 0,w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.httpDormant=!1,this.httpRecover();case 2:case"end":return t.stop()}}),t,this)})))}}],o&&x(r.prototype,o),i&&x(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i}(function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=y(this,e,[t])).url=t.wsUrl,r.sid=t.sid,r.isOutRetryTimes=!1,r.protocols=t.wsProtocols||[],r.disconnect=r.disconnect.bind(r),r.handleClose=r.handleClose.bind(r),r.handleMessage=r.handleMessage.bind(r),r.socketDormant=!1,r.socketConnectTraceId=Math.round(1e6*Math.random()),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(e,t),r=e,(o=[{key:"updateSid",value:function(t){this.sid=t}},{key:"socketConnect",value:function(t){return(0,n.m)(this,void 0,void 0,f().mark((function e(){var r,n,o,i,a,s=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=20,n=0,o=!1,!0!==this.isConnecting){e.next=5;break}return e.abrupt("return");case 5:this.isConnecting=!0,this.socketConnectPromise=new Promise((function(t,e){s.connectingDone=t,i=e})),a=f().mark((function e(){var a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s.isError||s.isDone||s.socketDormant||s.isCancel)){e.next=2;break}return e.abrupt("return",1);case 2:return n++,e.next=5,s.connect().then((function(e){e.onclose=s.handleClose,o=!0,t&&t(e)})).catch((function(t){}));case 5:if(o){e.next=9;break}return a=Math.max(0,1e3*(n-2)*2),e.next=9,new Promise((function(t){s.setTimeout((function(){return t()}),a)}));case 9:if(!(n>=r)||o){e.next=12;break}throw i(),Error("persist connect failed.");case 12:case"end":return e.stop()}}),e)}));case 8:if(o){e.next=14;break}return e.delegateYield(a(),"t0",10);case 10:if(!e.t0){e.next=12;break}return e.abrupt("break",14);case 12:e.next=8;break;case 14:this.isConnecting=!1;case 15:case"end":return e.stop()}}),e,this)})))}},{key:"connect",value:function(){return(0,n.m)(this,void 0,void 0,f().mark((function t(){var e,r=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.socket&&this.socket.close(),e=this.url+"&t="+this.socketConnectTraceId+(this.sid?"&sid="+this.sid:""),this.socket=new WebSocket(e,l(this.protocols)),this.socket.onmessage=this.handleMessage,t.abrupt("return",new Promise((function(t,e){r.socket.onopen=function(){if(r.isPushDone&&r.isDone)return r.socket.close();r._isConnected=!0,t(r.socket)},r.socket.onerror=function(t){e(t)},r.socket.onclose=function(t){e(t),r.onSocketClose(t)}})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"recover",value:function(){return(0,n.m)(this,void 0,void 0,f().mark((function t(){var e,r=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this._isConnected||this.isError||this.isDone||this.socketDormant)){t.next=2;break}return t.abrupt("return");case 2:return e=this.getRecoverData(),this.socketConnect((function(){r.upload(e)})).catch((function(t){r.netWorkRetryFailed()})),this.onSocketRecover(),t.abrupt("return",this.socketConnectPromise);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"handleClose",value:function(t){var e=this;this._isConnected=!1,this.socketConnectPromise=null,this.getQueueProgress(),!0!==this.isError&&!0!==this.socketDormant&&!0!==this.isDone&&!0!==this.isCancel&&this.setTimeout((function(){e.recover()}),3e3),this.onSocketClose(t)}},{key:"startUpload2",value:function(){return(0,n.m)(this,void 0,void 0,f().mark((function t(){var e,r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.isCancel||this.isError||this.isDone)){t.next=2;break}return t.abrupt("return");case 2:if(this.isUploading){t.next=24;break}this.isUploading=!0,e=!0===this._isConnected&&!this.isConnecting&&!0!==this.socketDormant;case 6:if(!e){t.next=23;break}if(!(this.penddingCount<=this.maxQueueBlobSlice/3&&this.maxQueueBlobSlice>1)){t.next=20;break}return t.next=11,this.get();case 11:if(null===(r=t.sent)){t.next=17;break}this.upload(r),t.next=18;break;case 17:return t.abrupt("break",23);case 18:t.next=21;break;case 20:return t.abrupt("break",23);case 21:t.next=6;break;case 23:this.isUploading=!1;case 24:case"end":return t.stop()}}),t,this)})))}},{key:"startSocketUpload",value:function(){var t=this,e=function(){return(0,n.m)(t,void 0,void 0,f().mark((function t(){var r,n,o,i,a;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.isCancel||this.isError||this.isDone||this.isOutRetryTimes)){t.next=2;break}return t.abrupt("return");case 2:if(r=1e3,n=this.penddingCount<=this.maxQueueBlobSlice/3&&this.maxQueueBlobSlice>1,!0!==this._isConnected||this.isConnecting||!0===this.socketDormant||!n){t.next=10;break}return t.next=8,this.get();case 8:null!==(o=t.sent)&&(this.upload(o),r=100);case 10:i=isFinite(this.lastSendTime)?this.lastSendTime:0,a=isFinite(this.lastReceivedTime)?this.lastReceivedTime:0,i-a>2e4&&-1===this.jamAt&&(this.jamAt=Date.now()),Date.now()-this.jamAt>12e4&&this.onSocketBlocking(),this.setTimeout(e,r);case 16:case"end":return t.stop()}}),t,this)})))};e()}},{key:"handleMessage",value:function(t){this.lastReceivedTime=Date.now(),this.jamAt>0&&(this.jamAt=-1);try{var e=JSON.parse(t.data);this.handleMessageData(e)}catch(t){}this.onSocketMessage(t)}},{key:"upload",value:function(t){this.lastSendTime=Date.now(),this.socket.send(t),this.onSocketUpload(t)}},{key:"isConnected",get:function(){return this._isConnected}},{key:"haveRetryFailed",value:function(t){this.isOutRetryTimes=!0}},{key:"disconnect",value:function(){!1!==this._isConnected&&this.socket&&this.socket.close()}},{key:"frozenSocketUpload",value:function(){this.socketDormant=!0,this.disconnect()}},{key:"reviveSocketUpload",value:function(){this.socketDormant=!1,this._isConnected||this.isConnecting||this.recover()}},{key:"onSocketRecover",value:function(){}},{key:"onSocketMessage",value:function(t){}},{key:"onSocketUpload",value:function(t){}},{key:"onSocketClose",value:function(t){}},{key:"onSocketBlocking",value:function(){}}])&&p(r.prototype,o),i&&p(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i}(function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initQueue(),this.setTimeout=e.setTimeout||window.setTimeout,this.clearTimeout=e.clearTimeout||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null),this.maxQueueBlobSlice=isFinite(null==e?void 0:e.maxQueueBlobSlice)?e.maxQueueBlobSlice:0},(e=[{key:"start",value:function(){this.isStarted=!0}},{key:"initQueue",value:function(){this.queue=[],this.confirmedIndex=-1,this.sendedIndex=-1,this.countedCount=0,this.sliceIndexOffset=0,this.sliceIndex=-1,this.loaded=0,this.total=0,this.totalSlice=0}},{key:"updateTotalSliceBackup",value:function(t){this.totalSlice=t}},{key:"push",value:function(t){!0!==this.isError&&(t instanceof Blob&&(this.total+=t.size,this.totalSlice+=1,this.maxQueueBlobSlice>1&&this.getSlice&&this.queue.reduce((function(t,e){return e instanceof Blob?t+1:t}),0)>this.maxQueueBlobSlice&&(t=JSON.stringify({type:c,slice:this.totalSlice-1}))),this.queue.push(t),this.refreshProgress())}},{key:"outQueueIndex",get:function(){return this.countedCount+this.sendedIndex+1}},{key:"getRaw",value:function(){if(!0===this.isError)return null;if(this.sendedIndex===this.queue.length-1)return null;var t=this.queue[this.sendedIndex+1],e=this.countedCount+this.sendedIndex+1;return!t||isNaN(e)||this.sendedIndex>=this.queue.length?null:(this.sendedIndex=this.sendedIndex+1,t)}},{key:"get",value:function(){return(0,n.m)(this,void 0,void 0,i().mark((function t(){var e,r,n,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.getRaw()){t.next=3;break}return t.abrupt("return",e);case 3:if(!(e instanceof Blob)){t.next=5;break}return t.abrupt("return",e);case 5:if(t.prev=5,(r=JSON.parse(e)).type!=c){t.next=12;break}return t.next=10,this.getSlice(r.slice);case 10:return n=t.sent,t.abrupt("return",n);case 12:if("queue-message-placeholder"!=r.type){t.next=17;break}return t.next=15,this.getMessage(r);case 15:return o=t.sent,t.abrupt("return",o);case 17:return t.abrupt("return",e);case 20:return t.prev=20,t.t0=t.catch(5),t.abrupt("return",e);case 24:case"end":return t.stop()}}),t,this,[[5,20]])})))}},{key:"handleQueueResponse",value:function(t){if(this.countedCount,this.confirmedIndex,t===this.countedCount+this.confirmedIndex+1){this.confirmedIndex=this.confirmedIndex+1;var e=this.queue[this.confirmedIndex];e instanceof Blob&&(this.loaded+=e.size)}else t>this.countedCount+this.confirmedIndex+1&&(this.confirmedIndex=t-this.countedCount-1);this.confirmedIndex>5&&(this.countedCount=this.countedCount+this.confirmedIndex+1,this.sendedIndex=this.sendedIndex-this.confirmedIndex-1,this.queue=this.queue.slice(this.confirmedIndex+1),this.confirmedIndex=-1),this.refreshProgress()}},{key:"revise",value:function(t){this.sendedIndex=t+this.sliceIndexOffset-this.countedCount;var e=this.confirmedIndex;this.confirmedIndex=this.sendedIndex;for(var r=this.confirmedIndex-e,n=1;n<=r;n++){var o=this.queue[e+n];o instanceof Blob&&(this.loaded+=o.size)}}},{key:"replenishRevise",value:function(t){return(0,n.m)(this,void 0,void 0,i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isPushDone=!1,this.isCancel=!1,this.isStarted=!0,this.countedCount=t+1;case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getUnconfirmedCount",value:function(){return this.queue.length-this.confirmedIndex-1}},{key:"penddingCount",get:function(){return this.sendedIndex-this.confirmedIndex}},{key:"getConfirmedCount",value:function(){return this.countedCount+this.confirmedIndex+1}},{key:"getProgress",value:function(){return this.getConfirmedCount()/(this.countedCount+this.queue.length)}},{key:"getQueueProgress",value:function(){return{finished:this.countedCount+this.confirmedIndex+1,current:this.countedCount+this.sendedIndex+1,total:this.countedCount+this.queue.length,binarySlice:this.sliceIndex+1}}},{key:"refreshProgress",value:function(){var t=this.getQueueProgress();return this.isPushDone&&t.finished>=t.total&&(this.isDone=!0),t}},{key:"netWorkRetryFailed",value:function(){}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()))))},42097:(t,e,r)=>{"use strict";r.d(e,{u:()=>l});var n=r(37345);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),s=new R(n||[]);return i(a,"_invoke",{value:P(t,r,s)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};h(k,c,(function(){return this}));var S=Object.getPrototypeOf,O=S&&S(S(C([])));O&&O!==r&&n.call(O,c)&&(k=O);var E=x.prototype=b.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(i,a,s,c){var u=p(t[i],t,a);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=_(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=x,i(E,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=h(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,h(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(L.prototype),h(L.prototype,u,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),h(E,l,"Generator"),h(E,c,(function(){return this})),h(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var l=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.registerKeyPool=new Set,this.queryRegisterKey=(null==e?void 0:e.storageQueryKey)||"query_single_line",this.queryWaitingTime=isFinite(null==e?void 0:e.queryWaitingTime)?e.queryWaitingTime:300,this.handleStorage=function(t){if(t.key===r.queryRegisterKey)try{var e=JSON.parse(t.newValue);r.responseQueryEvent(e)}catch(t){}},this.storageListener=!1,this.setTimeout=(null==e?void 0:e.setTimeout)||window.setTimeout,this.clearTimeout=(null==e?void 0:e.clearTimeout)||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null)},e=[{key:"prepareListener",value:function(){this.registerKeyPool.size>0&&!this.storageListener&&(window.addEventListener("storage",this.handleStorage),window.addEventListener("storage-self",this.handleStorage),this.storageListener=!0),0==this.registerKeyPool.size&&this.storageListener&&(window.removeEventListener("storage",this.handleStorage),window.removeEventListener("storage-self",this.handleStorage),this.storageListener=!1)}},{key:"register",value:function(t){var e=this;return this.registerKeyPool.add(t),this.prepareListener(),function(){e.unregister(t)}}},{key:"unregister",value:function(t){this.registerKeyPool.delete(t),this.prepareListener()}},{key:"queryOutageKeys",value:function(t){return(0,n.m)(this,void 0,void 0,s().mark((function e(){var r,n=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dispatchQuery(t),e.next=4,new Promise((function(t){n.setTimeout(t,n.queryWaitingTime)}));case 4:return r=this.getResponse(),e.abrupt("return",t.filter((function(t){return r[t]<=0})));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"dispatchQuery",value:function(t){var e=localStorage.getItem(this.queryRegisterKey),r={};try{var n=JSON.parse(e);r=Object.assign(r,n)}catch(a){}var o=Date.now();r=Object.fromEntries(Object.entries(r).filter((function(t){var e=i(t,2),r=(e[0],e[1]);return o-Math.abs(r)<6e4}))),r=Object.assign(r,t.reduce((function(t,e){return Object.assign(Object.assign({},t),function(t,e,r){return(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},e,-Date.now()))}),{})),localStorage.setItem(this.queryRegisterKey,JSON.stringify(r));var a=new StorageEvent("storage-self",{key:this.queryRegisterKey,newValue:JSON.stringify(r)});window.dispatchEvent(a)}},{key:"responseQueryEvent",value:function(t){var e=this,r=Object.assign({},t),n=!1;Object.keys(t).forEach((function(t){e.registerKeyPool.has(t)&&(r[t]=Date.now(),n=!0)})),n&&localStorage.setItem(this.queryRegisterKey,JSON.stringify(r))}},{key:"getResponse",value:function(){var t=localStorage.getItem(this.queryRegisterKey),e={};try{var r=JSON.parse(t);e=Object.assign(e,r)}catch(t){}return e}}],e&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}()}}]);