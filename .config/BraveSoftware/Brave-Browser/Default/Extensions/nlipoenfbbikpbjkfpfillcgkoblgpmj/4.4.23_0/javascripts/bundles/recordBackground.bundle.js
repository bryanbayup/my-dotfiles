(()=>{"use strict";var t,e,r,n={29185:(t,e,r)=>{r.d(e,{$r:()=>Ye,Bn:()=>We,GR:()=>Fe,HC:()=>Ze,Jw:()=>Ke,R6:()=>Je,Rv:()=>Xe,UB:()=>Be,ZE:()=>Ve,a6:()=>Ue,c8:()=>qe,gD:()=>Qe,jT:()=>He,m2:()=>ze,qw:()=>$e});var n=r(57689),o=r(17343),i=r(19803),a=r.n(i),c=(r(93937),r(37185)),u=r(76960),s=r(51381),l=r(77475),h=r(30453),f=r(45245),p=r(37545),d=r(66540),v=r(61403),y=r(66413),m=r(22098),g=r(22871),b=r(94280),w=r(11299),x=r(86665),k=r(60170),S=r(2583),E=r(31579),T=r(62163),O=r(88367),I=r(90767),j=r(5914),L=r(93330),P=r(3609),_=r(42187),C=r(54526),D=r(8880),M=r(43064),A=r(40869),R=r(40209),N=r(71458),G=r(7081),F=r(88721),Z=r(83678),U=r(37849),B=r(55766),z=r(33284),V=r(59033),q=r(76239),K=r(78578),W=r(63758),H=r(14155),Y=r(53017),J=r(97423),Q=r(8366),$=r(31188),X=r(48982),tt=r(99510),et=r(99880),rt=r(76149),nt=r(13541),ot=r(73110),it=r(70693),at=r(56813),ct=r(76776),ut=r(20720),st=r(16838),lt=r(99408),ht=r(17755),ft=r(99092),pt=r(43979),dt=r(13747),vt=r(7249),yt=r(18789),mt=r(91272),gt=r(91530),bt=r(62971),wt=r(27479),xt=r(4983),kt=r(32404),St=r(15221),Et=r(38218),Tt=r(67532),Ot=r(32461),It=r(56158),jt=r(41364),Lt=r(9929),Pt=r(76591),_t=r(28351),Ct=r(92497),Dt=r(73789),Mt=r(7679),At=r(69091),Rt=r(62771),Nt=r(66719),Gt=r(29307),Ft=r(48034),Zt=r(44504),Ut=r(4409),Bt=r(2760),zt=r(47088),Vt=r(1810),qt=r(28991),Kt=r(30585),Wt=r(48337),Ht=r(93328),Yt=r(39655),Jt=r(2377),Qt=r(59460),$t=r(70237),Xt=r(65639),te=r(24928),ee=r(64081),re=r(45626),ne=r(33206),oe=r(12455),ie=r(19769),ae=r(66924),ce=r(50872),ue=r(34686),se=r(45962),le=r(65656),he=r(46574),fe=r(30370),pe=r(21737),de=r(50616),ve=r(75204),ye=r(6201),me=r(31828),ge=r(10703),be=r(85996),we=r(31676),xe=r(61849),ke=r(13503),Se=r(21977),Ee=r(65352),Te=r(26322),Oe=r(20549),Ie=r(90983),je=r(47360),Le=r(58801);function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function _e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ce(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(r),!0).forEach((function(e){De(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function De(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=Pe(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pe(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Me(t){var e=a()("svg-icon",t.className);return(0,Le.jsx)(o.Z,Ce(Ce({},t),{},{className:e}))}var Ae={AddImageIcon:c.Z,AddIcon:u.Z,AnnotateIcon:s.Z,ArrowIcon:l.Z,CloseIcon:h.Z,CommentIcon:f.Z,CopyLinkIcon:p.Z,CopyIcon:d.Z,DownloadIcon:v.Z,EmbedIcon:y.Z,FeedbackIcon:m.Z,FolderIcon:g.Z,ImagesIcon:b.Z,ItemsIcon:w.Z,LoadingMoreIcon:x.Z,MoreIcon:k.Z,MoveFolderIcon:S.Z,NotificationIcon:E.Z,OpenFolderIcon:T.Z,PutBackIcon:O.Z,RenameIcon:I.Z,RightIcon:j.Z,TagIcon:L.Z,TrashFilledIcon:P.Z,TrashIcon:_.Z,VideosIcon:C.Z,AddTextIcon:D.Z,CutIcon:M.Z,ProIcon:A.Z,PullIcon:R.Z,ReduceIcon:N.Z,MoreDotIcon:G.Z,PlayIcon:Z.Z,PauseIcon:U.Z,FullScreenIcon:B.Z,NormalScreenIcon:z.Z,PIPIcon:V.Z,ReplayIcon:q.Z,VolumeCloseIcon:K.Z,VolumeHighIcon:W.Z,VolumeLowIcon:H.Z,SharedIcon:Y.Z,StepForwardIcon:J.Z,StepBackIcon:Q.Z,CommentBubbleIcon:$.Z,MentionMsgIcon:X.Z,VideoEditorIcon:F.Z,EmojiIcon:tt.Z,RecordDesktopIcon:et.Z,RecordCameraIcon:rt.Z,PricingTagIcon:nt.Z,LightThemeIcon:ot.Z,DarkThemeIcon:it.Z,AutoThemeIcon:at.Z,NewTabIcon:ct.Z,MicIcon:ut.Z,HDIcon:st.Z,CameraIcon:lt.Z,ChromeIcon:ht.Z,EdgeIcon:ft.Z,GoogleIcon:pt.Z,BrushIcon:dt.Z,SecurityIcon:yt.Z,SyncIcon:vt.Z,ChannelIcon:mt.Z,SettingIcon:gt.Z,MemberIcon:bt.Z,PersonIcon:wt.Z,QuestionMarkIcon:xt.Z,CardIcon:kt.Z,SharedMeIcon:St.Z,MeIcon:Et.Z,StarIcon:Tt.Z,EmptyIcon:Ot.Z,PdfIcon:It.Z,PrinterIcon:jt.Z,CopyImageIcon:Lt.Z,SmileIcon:Pt.Z,CrownIcon:_t.Z,CrownBgIcon:Ct.Z,SharedMeFilledIcon:Dt.Z,WarningIcon:Mt.Z,BilligIcon:At.Z,StarFolderIcon:Rt.Z,MeFilledIcon:Nt.Z,AtIcon:Gt.Z,StickerIcon:tt.Z,CameraNoIcon:Ft.Z,TrashRecordIcon:Zt.Z,StopRecordIcon:Ut.Z,ActionBigIcon:zt.Z,ActionMiniIcon:Bt.Z,CameraRecordIcon:Vt.Z,CheckboxIcon:qt.Z,DragIcon:Kt.Z,AddMemberIcon:Wt.Z,RecordPauseIcon:Ht.Z,RecordPlayIcon:Yt.Z,LockIcon:Jt.Z,EnterpriseIcon:Qt.Z,DomainIcon:$t.Z,SsoIcon:Xt.Z,DownloadExtIcon:te.Z,CopyExtIcon:ee.Z,PDFExtIcon:re.Z,PrintExtIcon:ne.Z,BackupExtIcon:oe.Z,OutIcon:ie.Z,ShareIcon:ae.Z,DescIcon:ce.Z,FolderFilledIcon:ue.Z,VideoFolderIcon:se.Z,VideoFilmIcon:le.Z,VideoEditIcon:he.Z,IcStopIcon:Ut.Z,PointerIcon:fe.Z,ExtWarningIcon:pe.Z,NoBackupIcon:de.Z,VideoFailedIcon:ve.Z,VideoStatusIcon:ye.Z,VideoPlayIcon:me.Z,VideoDownloadIcon:ge.Z,VideoRetryIcon:be.Z,VideoDeleteIcon:we.Z,MyItemIcon:xe.Z,DoneIcon:ke.Z,ScreenshotIIcon:Se.Z,TabIIcon:Ee.Z,InfiniteIcon:Te.Z,BrainIcon:Oe.Z,SiderOcrIcon:Ie.Z,ReUploadIcon:je.Z},Re={},Ne=function(t){Re[t]=(0,n.memo)((function(e){return(0,Le.jsx)(Me,Ce({component:Ae[t]},e))})),Re[t].displayName=t};for(var Ge in Ae)Ne(Ge);Re.AddImageIcon,Re.AddIcon,Re.AnnotateIcon,Re.ArrowIcon,Re.CloseIcon,Re.CommentIcon,Re.CopyLinkIcon,Re.CopyIcon,Re.DownloadIcon,Re.EmbedIcon,Re.FeedbackIcon,Re.FolderIcon,Re.ImagesIcon,Re.ItemsIcon,Re.LoadingMoreIcon,Re.MoreIcon,Re.MoveFolderIcon,Re.NotificationIcon,Re.OpenFolderIcon,Re.PutBackIcon,Re.RenameIcon,Re.RightIcon,Re.TagIcon,Re.TrashFilledIcon,Re.TrashIcon,Re.VideosIcon,Re.AddTextIcon,Re.CutIcon,Re.ProIcon,Re.PullIcon,Re.ReduceIcon,Re.MoreDotIcon,Re.PlayIcon,Re.PauseIcon,Re.FullScreenIcon,Re.NormalScreenIcon,Re.PIPIcon,Re.ReplayIcon,Re.VolumeCloseIcon,Re.VolumeHighIcon,Re.VolumeLowIcon,Re.SharedIcon,Re.StepForwardIcon,Re.StepBackIcon,Re.CommentBubbleIcon,Re.MentionMsgIcon,Re.VideoEditorIcon,Re.EmojiIcon,Re.RecordDesktopIcon,Re.RecordCameraIcon,Re.PricingTagIcon,Re.LightThemeIcon,Re.DarkThemeIcon,Re.AutoThemeIcon,Re.NewTabIcon,Re.MicIcon,Re.HDIcon,Re.CameraIcon,Re.ChromeIcon,Re.EdgeIcon,Re.GoogleIcon,Re.BrushIcon,Re.SecurityIcon,Re.SyncIcon,Re.ChannelIcon,Re.SettingIcon,Re.MemberIcon,Re.PersonIcon,Re.QuestionMarkIcon,Re.CardIcon,Re.SharedMeIcon,Re.MeIcon,Re.StarIcon,Re.EmptyIcon,Re.PdfIcon,Re.PrinterIcon,Re.CopyImageIcon,Re.SmileIcon,Re.CrownIcon,Re.CrownBgIcon,Re.SharedMeFilledIcon,Re.WarningIcon,Re.BilligIcon,Re.StarFolderIcon,Re.MeFilledIcon,Re.AtIcon,Re.StickerIcon,Re.CameraNoIcon;var Fe=Re.TrashRecordIcon,Ze=(Re.StopRecordIcon,Re.ActionBigIcon,Re.ActionMiniIcon,Re.CameraRecordIcon,Re.DragIcon,Re.CheckboxIcon,Re.AddMemberIcon,Re.RecordPauseIcon),Ue=Re.RecordPlayIcon,Be=(Re.LockIcon,Re.EnterpriseIcon,Re.DomainIcon,Re.SsoIcon,Re.DownloadExtIcon,Re.CopyExtIcon,Re.PDFExtIcon,Re.PrintExtIcon,Re.BackupExtIcon,Re.OutIcon,Re.ShareIcon,Re.DescIcon,Re.FolderFilledIcon,Re.VideoFolderIcon,Re.VideoFilmIcon,Re.VideoEditIcon,Re.IcStopIcon),ze=Re.PointerIcon,Ve=Re.ExtWarningIcon,qe=Re.NoBackupIcon,Ke=Re.VideoFailedIcon,We=Re.VideoStatusIcon,He=Re.VideoPlayIcon,Ye=Re.VideoDownloadIcon,Je=(Re.VideoRetryIcon,Re.VideoDeleteIcon),Qe=Re.MyItemIcon,$e=Re.DoneIcon,Xe=(Re.ScreenshotIIcon,Re.TabIIcon,Re.InfiniteIcon,Re.BrainIcon,Re.SiderOcrIcon,Re.ReUploadIcon)},94572:(t,e,r)=>{var n=r(97326),o=r(57689),i=r(40992),a=r(780),c=r(33534);function u(t){return t.filter((function(t,e,r){return""!==t.label&&r.findIndex((function(e){return e.deviceId===t.deviceId}))===e}))}function s(){return new Promise((function(t,e){!function(t,e){if(!navigator.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(navigator.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!navigator.enumerateDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=navigator.mediaDevices.enumerateDevices.bind(navigator)),navigator.enumerateDevices){var r=[],n=[],o=[],i=[],a=[],c=[];navigator.enumerateDevices((function(e){e.forEach((function(t){var e,u={};for(var s in t)u[s]=t[s];r.forEach((function(t){t.deviceId===u.deviceId&&(e=!0)})),e||("audio"===u.kind&&(u.kind="audioinput"),"video"===u.kind&&(u.kind="videoinput"),u.deviceId||(u.deviceId=u.id),u.id||(u.id=u.deviceId),"audioinput"!==u.kind&&"audio"!==u.kind||u.label&&!u.label.startsWith("AS")&&i.push(u),"audiooutput"===u.kind&&a.push(u),"videoinput"!==u.kind&&"video"!==u.kind||c.push(u),-1!==u.kind.indexOf("audio")&&u.label&&!u.label.startsWith("AS")&&n.push(u),-1!==u.kind.indexOf("video")&&o.push(u),r.push(u))})),t&&t({allMediaDevices:r,allVideoDevices:o,allAudioDevices:n,videoInputDevices:c,audioInputDevices:i,audioOutputDevices:a})}))}else e(null,"Neither navigator.mediaDevices.enumerateDevices NOR MediaStreamTrack.getSources are available.")}((function(e){var r=e,n=u(r.audioInputDevices),o=u(r.videoInputDevices);t({availableAudioDevices:n,availableVideoDevices:o})}))}))}navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(navigator.enumerateDevices=function(t){navigator.mediaDevices.enumerateDevices().then(t)});var l=r(24974),h=r(16810),f="#E53935",p={videoCodec:"webm",mimeType:"video/webm;codecs=vp8"},d={videoCodec:"fmp4",mimeType:"video/mp4;codecs=h264"},v=1073741824,y=2,m=1,g=r(37288),b=r(6722);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function x(){x=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:j(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var k={};s(k,a,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(D([])));E&&E!==r&&n.call(E,a)&&(k=E);var T=b.prototype=m.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==w(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(w(e)+" is not iterable")}return g.prototype=b,o(T,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(T),t},e.awrap=function(t){return{__await:t}},O(I.prototype),s(I.prototype,c,(function(){return this})),e.AsyncIterator=I,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new I(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(T),s(T,u,"Generator"),s(T,a,(function(){return this})),s(T,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function k(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function S(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){k(i,n,o,a,c,"next",t)}function c(t){k(i,n,o,a,c,"throw",t)}a(void 0)}))}}function E(t,e){return chrome.tabs.move(t,{windowId:e,index:0})}function T(t){return chrome.tabs.update(t,{pinned:!0})}function O(t){return chrome.windows.update(t,{state:"minimized"})}function I(t,e,r){return j.apply(this,arguments)}function j(){return(j=S(x().mark((function t(e,r,n){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E(e,r);case 3:return t.next=5,T(e);case 5:t.next=18;break;case 7:return t.prev=7,t.t0=t.catch(0),t.prev=10,t.next=13,O(r);case 13:t.next=18;break;case 15:t.prev=15,t.t1=t.catch(10);case 18:case"end":return t.stop()}}),t,null,[[0,7],[10,15]])})))).apply(this,arguments)}function L(t){}var P={db:null,log:function(){Array.prototype.slice.apply(arguments).unshift("[DB]: ")},init:function(){return new Promise((function(t,e){var r=indexedDB.open("AwesomeScreenshot",1);r.onupgradeneeded=function(t){var e=t.target.result;t.target.transaction.onerror=L,e.objectStoreNames.contains("recordings")&&e.deleteObjectStore("recordings"),e.createObjectStore("recordings",{autoIncrement:!0}).createIndex("by_id","id",{unique:!0})},r.onsuccess=function(e){P.db=e.target.result,t(e.target.result)},r.onerror=function(t){e(t)}}))},save:function(t){var e=this.db;return new Promise((function(r,n){var o=e.transaction(["recordings"],"readwrite").objectStore("recordings"),i=(new Date).getTime(),a=o.put({id:i,fileUrl:t.fileUrl,detail:{title:t.title,youtubeUrl:"",gDriveUrl:"",size:t.size,duration:t.duration,timeStamp:i,thumbnailUrl:"",recordType:t.recordType,codecs:t.codecs}});a.onsuccess=function(){r({id:i,fileUrl:t.fileUrl,detail:{title:t.title,youtubeUrl:"",gDriveUrl:"",size:t.size,duration:t.duration,timeStamp:i,thumbnailUrl:"",recordType:t.recordType,codecs:t.codecs}})},a.onerror=n}))},get:function(t){var e=this.db;return new Promise((function(r,n){var o=e.transaction(["recordings"],"readwrite").objectStore("recordings").index("by_id").get(t);o.onsuccess=function(t){var e=t.target.result;r(e)},o.onerror=n}))},getAll:function(){var t=this.db;return new Promise((function(e,r){var n=t.transaction(["recordings"],"readwrite").objectStore("recordings").getAll();n.onsuccess=function(t){var r=t.target.result;e(r)},n.onerror=r}))},_getCursor:function(t){var e=this.db;return new Promise((function(r,n){var o=e.transaction(["recordings"],"readwrite").objectStore("recordings"),i=IDBKeyRange.only(t),a=o.index("by_id").openCursor(i);a.onsuccess=function(t){var e=t.target.result;e&&r(e)},a.onerror=n}))},updateYoutubeUrl:function(t,e){var r=this;return new Promise((function(n,o){r._getCursor(t).then((function(t){t.value.detail.youtubeUrl=e;var r=t.update(t.value);r.onsuccess=n,r.onerror=o}))}))},update:function(t,e){var r=this.db;return new Promise((function(n,o){var i=r.transaction(["recordings"],"readwrite").objectStore("recordings"),a=IDBKeyRange.only(t),c=i.index("by_id").openCursor(a);c.onsuccess=function(t){var r=t.target.result;r&&(r.update(e).onsuccess=function(){n()})},c.onerror=o}))},deleteAll:function(){var t=this.db;return new Promise((function(e,r){var n=t.transaction(["recordings"],"readwrite").objectStore("recordings").clear();n.onsuccess=function(t){var r=t.target.result;e(r)},n.onerror=r}))},delete:function(t){var e=this.db;return new Promise((function(r,n){var o=e.transaction(["recordings"],"readwrite").objectStore("recordings"),i=IDBKeyRange.only(t),a=o.index("by_id").openCursor(i);a.onsuccess=function(t){var e=t.target.result;e&&(e.delete().onsuccess=function(){r()})},a.onerror=n}))}};const _=P;var C=r(38756),D=r(37345);function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function A(){A=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==M(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(M(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,N(n.key),n)}}function N(t){var e=function(t,e){if("object"!=M(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==M(e)?e:e+""}var G=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.queue=[]},(e=[{key:"ready",value:function(){return(0,D.m)(this,void 0,void 0,A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","");case 1:case"end":return t.stop()}}),t)})))}},{key:"start",value:function(){return{vid:"0",title:"Download"}}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"send",value:function(){}},{key:"sendAll",value:function(){}},{key:"connect",value:function(){return(0,D.m)(this,void 0,void 0,A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}}),t)})))}},{key:"tryConnect",value:function(){return(0,D.m)(this,void 0,void 0,A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}}),t)})))}},{key:"disconnect",value:function(){}},{key:"isConnected",value:function(){return!0}},{key:"push",value:function(t){t instanceof Blob&&this.queue.push(t)}},{key:"stop",value:function(){return(0,D.m)(this,void 0,void 0,A().mark((function t(){var e=this;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout((function(){var t=new Blob(e.queue,{type:"video/mp4"}),r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download="Record"+Date.now()+".mp4",n.click()}),1e3);case 1:case"end":return t.stop()}}),t)})))}},{key:"cancel",value:function(){return(0,D.m)(this,void 0,void 0,A().mark((function t(){return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.stop();case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getData",value:function(){return{vid:"0",title:"Download"}}},{key:"getQueueProgress",value:function(){return{finished:this.queue.length,current:this.queue.length,total:this.queue.length}}},{key:"refreshProgress",value:function(){}}])&&R(t.prototype,e),r&&R(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function Z(){Z=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==F(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(F(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,B(n.key),n)}}function B(t){var e=function(t,e){if("object"!=F(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==F(e)?e:e+""}var z=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.DBName=(null==e?void 0:e.name)||"Storage_Index",this.DBVersion=(null==e?void 0:e.version)||1,this.objectStoreName=(null==e?void 0:e.indexStoreName)||"index",this.handleUpgrade=this.handleUpgrade.bind(this),this.initDB()},e=[{key:"initDB",value:function(){var t=this;if(this.db)return this.db;var e=indexedDB.open(this.DBName,this.DBVersion);return new Promise((function(r,n){e.onerror=function(t){n()},e.onupgradeneeded=t.handleUpgrade,e.onsuccess=function(){r(e.result)}})).then((function(e){t.db=e,e.onerror=console.error})).catch(console.error)}},{key:"getObjectStore",value:function(t){return(0,D.m)(this,void 0,void 0,Z().mark((function e(){var r,n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initDB();case 2:return r=this.db.transaction([this.objectStoreName],t),n=r.objectStore(this.objectStoreName),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"handleUpgrade",value:function(t){t.target.result.createObjectStore(this.objectStoreName,{autoIncrement:!0})}},{key:"createIndex",value:function(t){return(0,D.m)(this,void 0,void 0,Z().mark((function e(){var r,n,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign({},t),e.next=3,this.getObjectStore("readwrite");case 3:return n=e.sent,o=n.add(r),e.abrupt("return",new Promise((function(t,e){o.onsuccess=function(){var e=o.result;t(e)},o.onerror=function(t){e()}})));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"updateIndex",value:function(t,e){return(0,D.m)(this,void 0,void 0,Z().mark((function r(){var n,o;return Z().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getObjectStore("readwrite");case 2:n=r.sent,o=n.get(t),new Promise((function(t,e){o.onsuccess=function(){t(o.result)},o.onerror=function(t){e()}})).then((function(r){var o=Object.assign(Object.assign({},r),e),i=n.put(o,t);return new Promise((function(t,e){i.onsuccess=t,i.onerror=function(t){e()}}))}));case 5:case"end":return r.stop()}}),r,this)})))}},{key:"removeIndex",value:function(t){return(0,D.m)(this,void 0,void 0,Z().mark((function e(){var r,n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readwrite");case 2:return r=e.sent,n=r.delete(t),e.abrupt("return",new Promise((function(t,e){n.onsuccess=t,n.onerror=function(t){e()}})));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getIndex",value:function(t){return(0,D.m)(this,void 0,void 0,Z().mark((function e(){var r,n,o;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getObjectStore("readonly");case 2:if(r=e.sent,!isFinite(t)){e.next=6;break}return n=r.get(t),e.abrupt("return",new Promise((function(t,e){n.onsuccess=function(){t(n.result)},n.onerror=function(t){e()}})));case 6:return o=r.getAll(),e.abrupt("return",new Promise((function(t,e){o.onsuccess=function(){t(o.result)},o.onerror=function(t){e()}})));case 8:case"end":return e.stop()}}),e,this)})))}},{key:"digest",value:function(t){return(0,D.m)(this,void 0,void 0,Z().mark((function e(){var r,n,o,i,a;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window){e.next=21;break}return r=document.createElement("video"),n=document.createElement("canvas"),o=n.getContext("2d"),r.muted=!0,r.src=URL.createObjectURL(t),e.next=9,r.play();case 9:if(!isNaN(r.duration)){e.next=12;break}return e.abrupt("return",!1);case 12:return r.currentTime=Math.min(r.duration/2,1),n.width=Math.min(r.videoWidth,420),n.height=Math.min(r.videoHeight,420*r.videoHeight/r.videoWidth),o.drawImage(r,0,0,n.width,n.height),i=n.toDataURL(),a={thumbnail:i,resolution:r.videoWidth+"*"+r.videoHeight,size:t.size,duration:1e3*r.duration},URL.revokeObjectURL(r.src),r.src="",e.abrupt("return",a);case 21:return e.abrupt("return",!1);case 22:case"end":return e.stop()}}),e)})))}}],e&&U(t.prototype,e),r&&U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function q(){q=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==V(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(V(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function K(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W(n.key),n)}}function W(t){var e=function(t,e){if("object"!=V(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==V(e)?e:e+""}function H(t,e,r){return e=J(e),function(t,e){if(e&&("object"==V(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Y()?Reflect.construct(e,r||[],J(t).constructor):e.apply(t,r))}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Y=function(){return!!t})()}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},J(t)}function Q(t,e){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Q(t,e)}var $=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=H(this,e)).queue=[],r.isPushDone=!1,r.dirName=(null==t?void 0:t.videosDirName)||"videos",r.autoGenerateThumbnail=!1!==(null==t?void 0:t.autoGenerateThumbnail),r.DEBUG_sliceId=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}(e,t),r=e,(n=[{key:"initFS",value:function(){return(0,D.m)(this,void 0,void 0,q().mark((function t(){var e,r;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.fs){t.next=2;break}return t.abrupt("return");case 2:return e=window.requestFileSystem||window.webkitRequestFileSystem,t.next=5,new Promise((function(t,r){e(window.PERSISTENT,52428800,(function(e){t(e)}),(function(t){r()}))}));case 5:r=t.sent,this.fs=r;case 7:case"end":return t.stop()}}),t,this)})))}},{key:"ready",value:function(t){return(0,D.m)(this,void 0,void 0,q().mark((function e(){var r,n,o,i,a=this;return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initFS();case 2:return e.next=4,this.createIndex({createAt:Date.now(),title:t.title,status:"ready",statusTimestamp:Date.now()});case 4:return r=e.sent,this.indexKey=r,e.next=8,new Promise((function(t,e){a.fs.root.getDirectory(a.dirName,{create:!0},(function(e){t(e)}),(function(t){e(t)}))}));case 8:return n=e.sent,e.next=11,new Promise((function(t,e){n.getFile(""+a.indexKey,{create:!0},(function(e){t(e)}),(function(t){e(t)}))}));case 11:return o=e.sent,this.fileEntry=o,e.next=15,new Promise((function(t,e){o.createWriter((function(e){t(e)}),(function(t){e()}))}));case 15:return i=e.sent,this.fileWriter=i,this.queue=[],this.isPushDone=!1,e.abrupt("return",r+"");case 20:case"end":return e.stop()}}),e,this)})))}},{key:"push",value:function(t){return(0,D.m)(this,void 0,void 0,q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=2;break}return e.abrupt("return",void 0);case 2:this.queue.push(t),this.isWriting||this.write();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"write",value:function(){return(0,D.m)(this,void 0,void 0,q().mark((function t(){var e,r=this;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.isWriting=!0,e=q().mark((function t(){var e;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.queue.shift(),r.DEBUG_sliceId++,r.writerPromise=new Promise((function(t,n){r.fileWriter.write(e),r.fileWriter.onerror=function(t){n()},r.fileWriter.onwriteend=function(){t()}})),t.next=6,r.writerPromise;case 6:case"end":return t.stop()}}),t)}));case 2:if(!(this.queue.length>0)){t.next=6;break}return t.delegateYield(e(),"t0",4);case 4:t.next=2;break;case 6:this.isWriting=!1,this.isPushDone&&this.handleSuccess();case 8:case"end":return t.stop()}}),t,this)})))}},{key:"start",value:function(t){return this.updateIndex(this.indexKey,{key:this.indexKey,mimeType:t||"",status:"started",statusTimestamp:Date.now(),isFS:!0,fullPath:"/"+this.dirName+"/"+this.indexKey}),{vid:""+this.indexKey,title:""}}},{key:"pause",value:function(){this.updateIndex(this.indexKey,{status:"paused",statusTimestamp:Date.now()})}},{key:"resume",value:function(){this.updateIndex(this.indexKey,{status:"resumed",statusTimestamp:Date.now()})}},{key:"stop",value:function(t){var e=t.duration,r=t.size;return(0,D.m)(this,void 0,void 0,q().mark((function t(){var n=this;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isPushDone=!0,t.next=3,this.updateIndex(this.indexKey,{duration:e||0,size:r||0});case 3:return t.abrupt("return",new Promise((function(t){n.stopPromiseResolve=t})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"cancel",value:function(){return(0,D.m)(this,void 0,void 0,q().mark((function t(){var e=this;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){if(!e.fileEntry)return t();e.fileEntry.remove((function(){t()}),(function(t){r()}))})).then((function(){return e.removeIndex(e.indexKey)})).then((function(){e.clear()})));case 1:case"end":return t.stop()}}),t)})))}},{key:"regenerateThumbnail",value:function(){}},{key:"handleSuccess",value:function(){var t=this;this.updateIndex(this.indexKey,{status:"stopped",statusTimestamp:Date.now()}).then((function(){if(t.autoGenerateThumbnail)return t.generateThumbnail()})).then((function(e){if(e)return t.updateIndex(t.indexKey,e)})).then((function(){t.clear()})).then((function(){t.stopPromiseResolve&&t.stopPromiseResolve()}))}},{key:"generateThumbnail",value:function(){return(0,D.m)(this,void 0,void 0,q().mark((function t(){var e,r=this;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,new Promise((function(t,e){r.fileEntry.file((function(e){t(e)}),(function(t){e()}))}));case 3:return e=t.sent,t.abrupt("return",this.digest(e));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){this.fileWriter=null,this.fileEntry=null}}])&&K(r.prototype,n),o&&K(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(z);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function tt(){tt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==X(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(X(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rt(n.key),n)}}function rt(t){var e=function(t,e){if("object"!=X(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==X(e)?e:e+""}var nt,ot,it=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"ready",value:function(){return(0,D.m)(this,void 0,void 0,tt().mark((function t(){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.id="pipe-"+Date.now(),t.abrupt("return",this.id);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"start",value:function(){return{vid:this.id,title:""}}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"push",value:function(t){this.count+=1}},{key:"stop",value:function(){return(0,D.m)(this,void 0,void 0,tt().mark((function t(){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.onSuccess&&this.onSuccess(this.id,{vid:this.id,title:""});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"cancel",value:function(){return(0,D.m)(this,void 0,void 0,tt().mark((function t(){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))}},{key:"getQueueProgress",value:function(){return{finished:this.count,current:this.count,total:this.count}}}])&&et(t.prototype,e),r&&et(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();!function(t){t.desktop="desktop",t.tab="tab",t.camera="camera"}(nt||(nt={})),function(t){t[t.notReady=0]="notReady",t[t.ready=1]="ready",t[t.waitingAuthorized=2]="waitingAuthorized",t[t.recording=3]="recording",t[t.paused=4]="paused",t[t.connecting=5]="connecting",t[t.countdown=6]="countdown",t[t.uploading=7]="uploading"}(ot||(ot={}));var at,ct,ut,st,lt;function ht(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ft(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ft(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function pt(t,e){var r=ht(t,2),n=r[0],o=r[1],i=ht(e,2),a=i[0],c=i[1];if(n<=a&&o<=c)return[n,o];var u=Math.min(a/n,c/o);return[Math.ceil(u*n),Math.ceil(u*o)]}function dt(t){return function(t){if(Array.isArray(t))return vt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return vt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function yt(){yt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==St(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(St(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function mt(t,e,r){return e=wt(e),function(t,e){if(e&&("object"==St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gt()?Reflect.construct(e,r||[],wt(t).constructor):e.apply(t,r))}function gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(gt=function(){return!!t})()}function bt(){return bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=wt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},bt.apply(null,arguments)}function wt(t){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wt(t)}function xt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kt(t,e)}function kt(t,e){return kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kt(t,e)}function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function Et(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function Ot(t,e,r){return e&&Tt(t.prototype,e),r&&Tt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function It(t){var e=function(t,e){if("object"!=St(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=St(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==St(e)?e:e+""}!function(t){t[t.null=0]="null",t[t.ready=1]="ready",t[t.start=2]="start",t[t.pause=3]="pause",t[t.resume=4]="resume",t[t.stop=5]="stop",t[t.cancel=6]="cancel",t[t.abort_cancel=7]="abort_cancel",t[t.abort_stop=8]="abort_stop",t[t.abort=9]="abort",t[t.processing_success=10]="processing_success",t[t.processing_error=11]="processing_error"}(at||(at={})),function(t){t[t.unready=0]="unready",t[t.unauthorized=1]="unauthorized",t[t.forbidden=2]="forbidden",t[t.authorized=3]="authorized",t[t.failed=4]="failed"}(ct||(ct={})),function(t){t.smartKeyToggleTime="smart_key_toggle_time",t.focusingWindowIdList="focusing_window_id_list"}(ut||(ut={}));var jt,Lt=function(){return Ot((function t(e){Et(this,t),this.inputStream=e.stream,this.crop=e.crop}),[{key:"stop",value:function(){this.outputStream&&(this.outputStream.getTracks().forEach((function(t){return t.stop()})),this.outputStream=null),this.inputStream&&(this.inputStream.getTracks().forEach((function(t){return t.stop()})),this.inputStream=null)}}])}(),Pt=function(t){function e(t){var r;return Et(this,e),(r=mt(this,e,[t])).setTimeout=t.setTimeout||window.setTimeout,r.clearTimeout=t.clearTimeout||window.clearTimeout,r.setTimeout=r.setTimeout.bind(null),r.clearTimeout=r.clearTimeout.bind(null),r.timeout=isFinite(t.timeout)?t.timeout:34,r}return xt(e,t),Ot(e,[{key:"absCrop",value:function(t){return(0,D.m)(this,void 0,void 0,yt().mark((function e(){var r,n,o;return yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.imageCapture){e.next=6;break}return e.next=3,this.imageCapture.grabFrame();case 3:return r=e.sent,n=r.width,o=r.height,e.abrupt("return",At(t,{width:n,height:o}));case 6:return e.abrupt("return",At(t));case 7:case"end":return e.stop()}}),e,this)})))}},{key:"prepare",value:function(){return(0,D.m)(this,void 0,void 0,yt().mark((function t(){var e,r,n,o,i=this;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.inputStream){t.next=18;break}return e=this.inputStream.getVideoTracks()[0],this.imageCapture=new ImageCapture(e),e.addEventListener("ended",(function(){return i.stop()})),this.canvas=document.createElement("canvas"),t.next=7,this.absCrop(this.crop);case 7:return r=t.sent,this.canvas.width=r.w,this.canvas.height=r.h,Rt(r.w,r.h)&&(this.canvas.height=Math.round(9*r.w/16)),this.ctx=this.canvas.getContext("2d"),this.canvasStream=this.canvas.captureStream(),n=this.inputStream.getAudioTracks(),o=this.canvasStream.getVideoTracks(),this.outputStream=new MediaStream([].concat(dt(o),dt(n))),this.outputStream.getVideoTracks().forEach((function(t){return t.addEventListener("ended",(function(){return i.stop()}))})),t.abrupt("return");case 18:case"end":return t.stop()}}),t,this)})))}},{key:"render",value:function(){return(0,D.m)(this,void 0,void 0,yt().mark((function t(){var e,r,n,o,i,a,c,u,s=this;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.ctx,r=this.imageCapture,t.next=4,this.absCrop(this.crop);case 4:n=t.sent,o=n.x,i=n.y,a=n.w,c=n.h,u=function(){r.grabFrame().then((function(t){e.drawImage(t,o,i,a,c,0,Math.round((s.canvas.height-c)/2),a,c)})).catch((function(t){})),s.timeoutId=s.setTimeout(u,s.timeout)},this.clearTimeout(this.timeoutId),u();case 13:case"end":return t.stop()}}),t,this)})))}},{key:"stop",value:function(){var t,r,n,o,i;(t=e,r="stop",n=this,i=bt(wt(1&(o=3)?t.prototype:t),r,n),2&o&&"function"==typeof i?function(t){return i.apply(n,t)}:i)([]),clearTimeout(this.timeoutId),this.canvas=null,this.imageCapture=null,this.ctx=null}},{key:"cropStream",value:function(t){return(0,D.m)(this,void 0,void 0,yt().mark((function e(){return yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(this.crop=t),e.next=3,this.prepare();case 3:this.render();case 4:case"end":return e.stop()}}),e,this)})))}}])}(Lt),_t="undefined"!=typeof MediaStreamTrackProcessor&&"undefined"!=typeof MediaStreamTrackGenerator,Ct=!(null===(lt=null===(st=null===globalThis||void 0===globalThis?void 0:globalThis.location)||void 0===st?void 0:st.href)||void 0===lt?void 0:lt.match(/^https?:\/\//)),Dt=_t&&Ct;Dt&&(jt=new Worker("crop.worker.js"));var Mt=function(t){function e(t){return Et(this,e),mt(this,e,[t])}return xt(e,t),Ot(e,[{key:"cropStream",value:function(t){return(0,D.m)(this,void 0,void 0,yt().mark((function e(){var r,n,o,i,a,c,u,s,l,h,f,p=this;return yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(this.crop=t),!this.inputStream){e.next=15;break}return r=this.inputStream.getVideoTracks()[0],n=new MediaStreamTrackProcessor({track:r}),o=new MediaStreamTrackGenerator({kind:"video"}),i=At(this.crop),a=i.x,c=i.y,u=i.w,s=i.h,l=n.readable,h=o.writable,jt.postMessage({action:"crop",readable:l,writable:h,visibleRect:{x:a,y:c,width:u,height:s}},[l,h]),e.next=11,new Promise((function(t){jt.onmessage=function(e){"crop-worker"===e.data.action&&t(e.data)}}));case 11:r.addEventListener("ended",(function(){return p.stop()})),f=this.inputStream.getAudioTracks(),this.outputStream=new MediaStream([o].concat(dt(f))),this.outputStream.getVideoTracks().forEach((function(t){return t.addEventListener("ended",(function(){return p.stop()}))}));case 15:case"end":return e.stop()}}),e,this)})))}}])}(Lt);function At(t,e){var r=t.x,n=t.y,o=t.w,i=t.h,a=t.ww,c=t.wh;return e&&(a=e.width,c=e.height),r<1&&n<1&&o<=1&&i<=1&&(r=Math.round(r*a),n=Math.round(n*c),o=Math.round(o*a),i=Math.round(i*c)),{x:r=1&r?r+1:r,y:n=1&n?n+1:n,w:o=1&o?o-3:o-2,h:i=1&i?i-3:i-2,ww:a,wh:c}}function Rt(t,e){return t>475&&e<120}var Nt=function(){return Ot((function t(e){Et(this,t);var r=At(e.crop);Rt(r.w,r.h)?this.cropInstance=new Pt(e):this.cropInstance=new t.CropClass(e)}),[{key:"output",get:function(){return this.cropInstance.outputStream}},{key:"cropStream",value:function(t){return(0,D.m)(this,void 0,void 0,yt().mark((function e(){return yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.cropInstance.cropStream(t));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){this.cropInstance.stop()}}])}();function Gt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ft(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ft(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Zt(){Zt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Ut(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ut(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Bt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zt(n.key),n)}}function zt(t){var e=function(t,e){if("object"!=Ut(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ut(e)?e:e+""}Nt.CropClass=Dt?Mt:Pt;var Vt,qt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.switchMic=this.switchMic.bind(this),this.setTimeout=(null==e?void 0:e.setTimeout)||window.setTimeout,this.clearTimeout=(null==e?void 0:e.clearTimeout)||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null),this.isRecordingAudio=!1,this.getAudioFailed=!1}return e=t,r=[{key:"captureDesktop",value:function(e){var r,n;return(0,D.m)(this,void 0,void 0,Zt().mark((function o(){var i,a,c,u,s,l,h,f,p,d,v=this;return Zt().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(this.desktopCaptureOptions=e,a=(i=e||{}).timeout,c=i.sources,u=i.constraints,s=i.audio,l=i.video,h=e.streamId){o.next=7;break}return o.next=6,new Promise((function(t,e){v.desktopStreamIdResolve=t,v.desktopMediaRequestId=chrome.desktopCapture.chooseDesktopMedia(c||["screen","window","tab","audio"],t),a>0&&v.setTimeout((function(){chrome.desktopCapture.cancelChooseDesktopMedia(v.desktopMediaRequestId),v.desktopMediaRequestId=-1,e()}),a)}));case 6:h=o.sent;case 7:if(h){o.next=11;break}throw new DOMException("Invalid state","NotAllowedError");case 11:return f=!1!==s&&Object.assign(Object.assign({},"object"==Ut(null==u?void 0:u.audio)?u.audio:{}),{mandatory:Object.assign(Object.assign({},"object"==Ut(null==u?void 0:u.audio)?null===(r=u.audio)||void 0===r?void 0:r.mandatory:{}),{chromeMediaSource:"desktop",chromeMediaSourceId:h})}),p=!1!==l&&Object.assign(Object.assign({},"object"==Ut(null==u?void 0:u.video)?u.video:{}),{mandatory:Object.assign(Object.assign({},"object"==Ut(null==u?void 0:u.video)?null===(n=u.video)||void 0===n?void 0:n.mandatory:{}),{chromeMediaSource:"desktop",chromeMediaSourceId:h})}),d=Object.assign(Object.assign({},u),{audio:f,video:p}),t.stopStream(this._stream),o.next=17,navigator.mediaDevices.getUserMedia(d);case 17:return this._stream=o.sent,this.desktopMediaRequestId=-1,o.abrupt("return",this._stream);case 21:case"end":return o.stop()}}),o,this)})))}},{key:"reopenDesktopMediaPicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,D.m)(this,void 0,void 0,Zt().mark((function e(){var r,n,o,i=this;return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.desktopMediaRequestId&&chrome.desktopCapture.cancelChooseDesktopMedia(this.desktopMediaRequestId),r=this.desktopCaptureOptions||{},n=r.sources,o=this,e.next=5,new Promise((function(e,r){i.desktopMediaRequestId=chrome.desktopCapture.chooseDesktopMedia(n||["screen","window","tab","audio"],(function(t){e(t),"function"==typeof o.desktopStreamIdResolve&&o.desktopStreamIdResolve(t)})),t>0&&i.setTimeout((function(){chrome.desktopCapture.cancelChooseDesktopMedia(i.desktopMediaRequestId),i.desktopMediaRequestId=-1,r()}))}));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"captureTabMedia",value:function(t){var e,r,n;return(0,D.m)(this,void 0,void 0,Zt().mark((function o(){var i,a,c,u,s,l,h,f,p,d,v,y,m,g,b,w,x;return Zt().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(this.stopCapture(),a=(i=t||{}).tabId,c=i.captureOptions,u=i.noAudioPatch,s=i.dimension,l={width:1920,height:1080},!(a&&(null===chrome||void 0===chrome?void 0:chrome.tabs)&&s)){o.next=10;break}return h=null===window||void 0===window?void 0:window.devicePixelRatio,f=isFinite(h)?h:1,o.next=8,new Promise((function(t){chrome.tabs.get(a,(function(e){return t(e)}))}));case 8:p=o.sent,l={width:(null!==(e=null==p?void 0:p.width)&&void 0!==e?e:1920)*f,height:(null!==(r=null==p?void 0:p.height)&&void 0!==r?r:1080)*f};case 10:return v=(d=s||{maxWidth:1920,maxHeight:1080}).maxWidth,y=d.maxHeight,m=pt([l.width,l.height],[v,y]),g=Gt(m,2),b=g[0],w=g[1],x=Object.assign(Object.assign({audio:!0,video:!0},c),{videoConstraints:Object.assign(Object.assign({},null==c?void 0:c.videoConstraints),{mandatory:Object.assign(Object.assign(Object.assign({},null===(n=null==c?void 0:c.videoConstraints)||void 0===n?void 0:n.mandatory),{chromeMediaSource:"tab"}),s?{maxWidth:b,maxHeight:w}:{})})}),o.next=16,new Promise((function(t){chrome.tabCapture.capture(x,(function(e){t(e)}))}));case 16:return this._stream=o.sent,!0!==u&&this.patchTabCapture(),o.abrupt("return",this._stream);case 19:case"end":return o.stop()}}),o,this)})))}},{key:"captureTab",value:function(t){var e,r;return(0,D.m)(this,void 0,void 0,Zt().mark((function n(){var o,i,a,c,u,s,l,h,f,p,d,v;return Zt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(o=t||{}).targetTabId,a=o.consumerTabId,c=o.captureOptions,u=o.noAudioPatch,s=t.streamId){n.next=6;break}return n.next=5,new Promise((function(t){chrome.tabCapture.getMediaStreamId({targetTabId:i,consumerTabId:a},(function(e){t(e)}))}));case 5:s=n.sent;case 6:return h=(l=c||{}).audio,f=l.video,p=Object.assign(Object.assign({},null==c?void 0:c.audioConstraints),{mandatory:Object.assign(Object.assign({},null===(e=null==c?void 0:c.audioConstraints)||void 0===e?void 0:e.mandatory),{chromeMediaSource:"tab",chromeMediaSourceId:s})}),d=Object.assign(Object.assign({},null==c?void 0:c.videoConstraints),{mandatory:Object.assign(Object.assign({},null===(r=null==c?void 0:c.videoConstraints)||void 0===r?void 0:r.mandatory),{chromeMediaSource:"tab",chromeMediaSourceId:s})}),v={audio:0!=h&&p,video:0!=f&&d},n.next=12,window.navigator.mediaDevices.getUserMedia(v);case 12:return this._stream=n.sent,!0!==u&&this.patchTabCapture(),n.abrupt("return",this._stream);case 15:case"end":return n.stop()}}),n,this)})))}},{key:"patchTabCapture",value:function(){var t;if((null===(t=this._stream.getAudioTracks())||void 0===t?void 0:t.length)>0){var e=new AudioContext;e.createMediaStreamSource(this._stream).connect(e.destination),this._stream.getAudioTracks().forEach((function(t){t.addEventListener("ended",(function(){"closed"!==e.state&&e.close()}))}))}}},{key:"getDisplayMedia",value:function(t){return(0,D.m)(this,void 0,void 0,Zt().mark((function e(){return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stopCapture(),t=Object.assign(Object.assign({audio:!0},t),{video:Object.assign({displaySurface:"monitor"},null==t?void 0:t.video)}),e.next=4,window.navigator.mediaDevices.getDisplayMedia(t);case 4:return this._stream=e.sent,e.abrupt("return",this._stream);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getUserMedia",value:function(t){return(0,D.m)(this,void 0,void 0,Zt().mark((function e(){return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stopCapture(),t=Object.assign({audio:!0,video:!0},t),e.next=4,navigator.mediaDevices.getUserMedia(t);case 4:return this._stream=e.sent,e.abrupt("return",this._stream);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"stream",get:function(){return this._stream},set:function(t){this._stream=t}},{key:"prepareAudioContext",value:function(){var t=this;if(!this.audioContext&&this._stream){this.audioContext=new AudioContext,this.audioDestination=this.audioContext.createMediaStreamDestination(),(this._stream.getAudioTracks().length>0?this.audioContext.createMediaStreamSource(this._stream):this.audioContext.createMediaElementSource(document.createElement("audio"))).connect(this.audioDestination);var e=this.audioDestination.stream.getAudioTracks()[0];this._stream.addTrack(e),this._stream.getAudioTracks().forEach((function(r){r!==e&&(t._stream.removeTrack(r),t._stream.addTrack(r))})),navigator.mediaDevices.ondevicechange=function(e){navigator.mediaDevices.enumerateDevices().then((function(e){var r=!1;e.forEach((function(t){"audioinput"===t.kind&&(r=!0)})),r&&t.isRecordingAudio&&t.getAudioFailed&&t.switchMic()}))}}}},{key:"turnOnMic",value:function(e){return(0,D.m)(this,void 0,void 0,Zt().mark((function r(){var n;return Zt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.stopStream(this.micStream),r.prev=1,r.next=4,window.navigator.mediaDevices.getUserMedia({audio:!e||{deviceId:e},video:!1});case 4:this.micStream=r.sent,r.next=11;break;case 7:return r.prev=7,r.t0=r.catch(1),this.getAudioFailed=!0,r.abrupt("return",!1);case 11:return this.getAudioFailed=!1,this.isRecordingAudio=!0,this.turnOffMicTime=0,(n=this.micStream.getAudioTracks()[0])&&(n.onended=this.switchMic),this.prepareAudioContext(),this.micAudioSource=this.audioContext.createMediaStreamSource(this.micStream),this.micAudioSource.connect(this.audioDestination),r.abrupt("return",!0);case 22:case"end":return r.stop()}}),r,this,[[1,7]])})))}},{key:"turnOffMic",value:function(){return(0,D.m)(this,void 0,void 0,Zt().mark((function e(){return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.turnOffMicTime=Date.now(),this.isRecordingAudio=!1,this.micAudioSource&&(t.stopStream(this.micStream),this.micAudioSource=null,this.micStream=null);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"switchMic",value:function(){Date.now()-this.turnOffMicTime>200&&(this._stream.removeTrack(this.micStream.getAudioTracks()[0]),this.turnOnMic())}},{key:"cropVideoTrack",value:function(t){return(0,D.m)(this,void 0,void 0,Zt().mark((function e(){return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._stream||!this.cropStream){e.next=3;break}return e.abrupt("return",this.cropStream.cropStream(t));case 3:if(!this._stream){e.next=8;break}return this.cropStream=new Nt({stream:this._stream,crop:t,setTimeout:this.setTimeout,clearTimeout:this.clearTimeout}),e.next=7,this.cropStream.cropStream();case 7:this._stream=this.cropStream.output;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"stopCapture",value:function(){this._stream&&t.stopStream(this._stream),this.desktopMediaRequestId>0&&chrome.desktopCapture.cancelChooseDesktopMedia(this.desktopMediaRequestId),this.micStream&&(this.turnOffMicTime=Date.now(),t.stopStream(this.micStream)),this.micAudioSource&&(this.micAudioSource=null),this.audioContext&&("closed"!==this.audioContext.state&&this.audioContext.close(),this.audioContext=null,this.audioDestination=null),this.cropStream&&(this.cropStream.stop(),this.cropStream=null)}}],n=[{key:"isCaptureDesktopSupported",value:function(){return!!(window.chrome&&window.chrome.desktopCapture&&window.chrome.desktopCapture.chooseDesktopMedia)}},{key:"stopStream",value:function(t){t&&t.getTracks&&t.getTracks().forEach((function(t){return t.stop()}))}}],r&&Bt(e.prototype,r),n&&Bt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}();function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Wt(){Wt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Kt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Kt(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}!function(t){t[t.touch=0]="touch",t[t.syncRecordingStatus=1]="syncRecordingStatus",t[t.requestRecordingStatus=2]="requestRecordingStatus",t[t.readyRecording=3]="readyRecording",t[t.startRecording=4]="startRecording",t[t.pauseRecording=5]="pauseRecording",t[t.resumeRecording=6]="resumeRecording",t[t.stopRecording=7]="stopRecording",t[t.cancelRecording=8]="cancelRecording",t[t.showCamera=9]="showCamera",t[t.showCameraPictureInPicture=10]="showCameraPictureInPicture",t[t.tabShowCamera=11]="tabShowCamera",t[t.tabCloseCamera=12]="tabCloseCamera",t[t.syncCameraStatus=13]="syncCameraStatus",t[t.showModalRecorder=14]="showModalRecorder",t[t.closeModalRecorder=15]="closeModalRecorder",t[t.requestSetting=16]="requestSetting",t[t.syncSetting=17]="syncSetting",t[t.requestReadyRecording=18]="requestReadyRecording",t[t.syncAuthorizationStatus=19]="syncAuthorizationStatus",t[t.windowsFocusChanged=20]="windowsFocusChanged",t[t.requestWindowsFocusingList=21]="requestWindowsFocusingList",t[t.reopenDesktopMediaPicker=22]="reopenDesktopMediaPicker",t[t.removeTask=23]="removeTask",t[t.reportActivity=24]="reportActivity",t[t.turnMicTo=25]="turnMicTo",t[t.turnCameraTo=26]="turnCameraTo",t[t.recordEvent=27]="recordEvent",t[t.TEST_delay=28]="TEST_delay"}(Vt||(Vt={}));var Ht=function(t){return"function"==typeof t},Yt=function(t){return t instanceof Blob},Jt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.setTimeout;return new Promise((function(r){e((function(){r()}),t)}))};var Qt=function(){var t=this,e=function(r,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,D.m)(t,void 0,void 0,Wt().mark((function t(){var i,a,c,u,s,l,h,f,p,d,v,y=this;return Wt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.retry,a=void 0!==i&&i,c=o.timeout,u=void 0===c?0:c,n=n||{},s=e.beforeRequest(r,n),r=s.info,n=s.init,u>0&&(h=new AbortController,n.signal=h.signal,l=setTimeout((function(){h.abort()}),u)),a){t.next=14;break}return t.next=9,fetch(r,n);case 9:p=t.sent,l&&clearTimeout(l),f=e.beforeResponse(p),t.next=19;break;case 14:return d=void 0,v=void 0,"boolean"!=typeof a&&(d=a.wait,v=a.times),t.next=19,Xt((function(t){return(0,D.m)(y,void 0,void 0,Wt().mark((function o(){var i;return Wt().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,l&&clearTimeout(l),o.next=4,fetch(r,n);case 4:i=o.sent,f=e.beforeResponse(i),o.next=14;break;case 8:if(o.prev=8,o.t0=o.catch(0),l&&clearTimeout(l),0!==t){o.next=13;break}throw o.t0;case 13:return o.abrupt("return",!1);case 14:return o.abrupt("return",!0);case 15:case"end":return o.stop()}}),o,null,[[0,8]])})))}),d,v);case 19:return t.abrupt("return",f);case 20:case"end":return t.stop()}}),t)})))};e.beforeRequest=function(t,e){return{info:t,init:e}},e.beforeResponse=function(t){if(!t.ok)throw new Error("Network response was not OK");return t.json()},e.meta={token:""};var r=function(t){return function(r,n,o){return(n=n||{}).method=t.toUpperCase(),e(r,n,o)}};return e.get=r("get"),e.post=r("post"),e.put=r("put"),e.delete=r("delete"),e.update=r("update"),e}();function $t(t,e,r){var n=t[e];Object.defineProperty(t,e,{get:function(){return n},set:function(t){var e=n;n=t,e!==t&&r(t,e)}})}function Xt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return(0,D.m)(this,void 0,void 0,Wt().mark((function n(){var o,i,a;return Wt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=0,i=0,a=0;case 3:return n.next=6,t(r-o);case 6:if(!n.sent){n.next=9;break}return n.abrupt("return");case 9:if(o++,a=Ht(e)?e(i,o):e,i=a,!(a<0||r>=0&&o>r)){n.next=14;break}return n.abrupt("return");case 14:return n.next=16,Jt(a);case 16:n.next=3;break;case 18:case"end":return n.stop()}}),n)})))}Qt.beforeRequest=function(t,e){return Qt.meta.token&&(e.headers=Object.assign({Authorization:Qt.meta.token},e.headers||{})),{info:t,init:e}};Math.pow(2,31);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return re(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?re(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ne(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oe(n.key),n)}}function oe(t){var e=function(t,e){if("object"!=te(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==te(e)?e:e+""}var ie=/^video\/mp4;?\s*(codecs[=:][(h264)|(h.264)].*)?$/,ae=["video/webm;codecs=h264,opus","video/mp4;codecs:h.264,opus"],ce=function(){return function(t,e,r){return e&&ne(t.prototype,e),r&&ne(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setTimeout=(null==n?void 0:n.setTimeout)||window.setTimeout,this.clearTimeout=(null==n?void 0:n.clearTimeout)||window.clearTimeout,this.handleAbort=this.handleAbort.bind(this),this.handleDataAvailable=this.handleDataAvailable.bind(this),this.handleRemuxerDataAvailable=this.handleRemuxerDataAvailable.bind(this),this.handleError=this.handleError.bind(this),this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null),this.timeSlice=null==n?void 0:n.timeSlice,this.safariTimeslicePatch=!0===(null==n?void 0:n.safariTimeslicePatch),this.noFragmentedMp4=!0===(null==n?void 0:n.noFragmentedMp4),this.noWasmMuxer=!0===(null==n?void 0:n.noWasmMuxer);var o=ee(this.getMimeType(null==r?void 0:r.mimeType,null==n?void 0:n.fallbackMimeTypes),2),i=o[0],a=o[1];this.mimeType=i,this.realMimeType=a,this.stream=e;var c=Object.assign(Object.assign({},r),{mimeType:a});this.mediaRecorder=new MediaRecorder(e,c),this.hookup()}),[{key:"hookup",value:function(){var t=this;this.isHookup=!0,this.countedDuration=0,this.size=0,this.isRecording=!1,this.lastSliceCrash=!1,this.gotLastSlice=null,this.gotLastRemuxerSlice=null,this.mediaRecorder.ondataavailable=this.handleDataAvailable,this.mediaRecorder.onstop=this.handleAbort,this.mediaRecorder.onerror=this.handleError,this.stream.getVideoTracks().forEach((function(e){return e.addEventListener("ended",t.handleAbort)}))}},{key:"unHook",value:function(){var t=this;this.isHookup=!1,this.mediaRecorder.ondataavailable=null,this.mediaRecorder.onstop=null,this.mediaRecorder.onerror=null,this.stream&&this.stream.getVideoTracks().forEach((function(e){return e.removeEventListener("ended",t.handleAbort)}))}},{key:"getMimeType",value:function(t,e){var r=[];"string"==typeof t&&r.push(t),e&&e.forEach((function(t){return r.push(t)})),0===r.length&&r.push(""),t=r[0];var n=window.Module;if(!this.noWasmMuxer&&(null==n?void 0:n.inited)){var o=r.findIndex((function(t){return MediaRecorder.isTypeSupported(t)})),i=r.findIndex((function(t){return ie.test(t)})),a=ae.find((function(t){return MediaRecorder.isTypeSupported(t)}));if(-1!==i&&(-1===o||o>i)&&a)return this.wasmMuxer=!0,this.muxerInit(),[r[i],a];if(-1!==o){var c=r[o];return[c,c]}}return[t,t]}},{key:"muxerInit",value:function(){var t=this.noFragmentedMp4?0:1,e=window.Module;e._mp4_muxer_close(1),e._mp4_muxer_create(0,t,0,3),window.muxer_data_out=this.handleRemuxerDataAvailable}},{key:"start",value:function(t){if(this.isHookup||this.hookup(),this.gotLastSlicePromise=null,"inactive"===this.mediaRecorder.state){void 0===t&&(t=this.timeSlice),this.mediaRecorder.start(t>0?t:void 0);var e=Date.now();return this.startTime=e,this.resumeTime=this.startTime,this.isRecording=!0,this.startTime}}},{key:"pause",value:function(){if("recording"===this.mediaRecorder.state){this.mediaRecorder.pause();var t=Date.now();return this.countedDuration=this.countedDuration+t-this.resumeTime,this.countedDuration}}},{key:"resume",value:function(){if("paused"===this.mediaRecorder.state){this.mediaRecorder.resume();var t=Date.now();return this.resumeTime=t,t}}},{key:"stop",value:function(){var t=this.mediaRecorder.state,e=Date.now();"recording"==t&&(this.countedDuration+=e-this.resumeTime),"recording"!=t&&"paused"!=t||(this.mediaRecorder.stop(),this.isRecording=!1,this.awaitDataAvailable(),this.stopTime=e)}},{key:"cancel",value:function(){this.unHook();var t=this.mediaRecorder.state;if(["recording","paused"].includes(t)){this.isRecording=!1,this.mediaRecorder.stop();var e=Date.now();this.stopTime=e}var r=window.Module;this.wasmMuxer&&r&&r._mp4_muxer_close(1)}},{key:"handleAbort",value:function(t){var e=this.countedDuration;!0===this.isRecording&&(this.awaitDataAvailable(),this.isRecording=!1,this.stopTime=Date.now(),e=this.countedDuration+this.stopTime-this.resumeTime);try{this.onAbort&&this.onAbort(e,t)}catch(t){}}},{key:"awaitDataAvailable",value:function(){var t=this;if(!this.gotLastSlicePromise){var e=window.Module;if(this.gotLastSlicePromise=new Promise((function(e){t.setTimeout((function(){return e()}),1e3),t.gotLastSlice=e})),this.wasmMuxer)return this.gotLastRemuxerSlicePromise=new Promise((function(e){t.setTimeout((function(){return e()}),1e4),t.gotLastRemuxerSlice=e})),this.gotLastSlicePromise.then((function(){e._mp4_muxer_close(1)})),void this.gotLastRemuxerSlicePromise.then((function(){t.onAllDataAvailable&&t.onAllDataAvailable()}));this.gotLastSlicePromise.then((function(){t.onAllDataAvailable&&t.onAllDataAvailable()}))}}},{key:"handleDataAvailable",value:function(t){var e=this;this.size=this.size+t.data.size;try{this.onRawDataAvailable&&this.onRawDataAvailable(t)}catch(t){}if(this.gotLastSlice&&this.gotLastSlice(),this.safariTimeslicePatch){if(0===t.data.size)return void(this.lastSliceCrash=!0);if(!0===this.lastSliceCrash)return void(this.lastSliceCrash=!1)}if(this.wasmMuxer){var r=window.Module,n=new FileReader;return n.readAsArrayBuffer(t.data),void(n.onload=function(){var t=new Uint8Array(n.result),o=r._malloc(t.length);r.HEAPU8.set(t,o),r._mp4_muxer_put_media(o,t.length)<0&&r._free(o),e.gotLastRemuxerSlice&&e.setTimeout((function(){r._mp4_muxer_close(1)}),0)})}try{this.ondataavailable&&this.ondataavailable(t)}catch(t){}}},{key:"handleRemuxerDataAvailable",value:function(t){t.type;var e=t.data,r=t.flag,n=(t.duration,new Blob([e]));try{var o=new BlobEvent("dataavailable",{data:n});this.ondataavailable&&this.ondataavailable(o)}catch(t){}1===r&&this.gotLastRemuxerSlice&&this.gotLastRemuxerSlice()}},{key:"handleError",value:function(t){}},{key:"duration",get:function(){var t=this.mediaRecorder.state;return"paused"==t?this.countedDuration:"recording"==t?this.countedDuration+Date.now()-this.resumeTime:"inactive"==t&&this.countedDuration?this.countedDuration:0}},{key:"state",get:function(){return this.mediaRecorder?this.mediaRecorder.state:"inactive"}}],[{key:"isTypeSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=window.Module;if(!e&&(null==r?void 0:r.inited)){var n=ie.test(t),o=ae.find((function(t){return MediaRecorder.isTypeSupported(t)}));if(n&&o)return!0}return MediaRecorder.isTypeSupported(t)}}])}();function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function se(){se=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==ue(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ue(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function le(t,e,r){if(fe())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&he(o,r.prototype),o}function he(t,e){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},he(t,e)}function fe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fe=function(){return!!t})()}function pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,de(n.key),n)}}function de(t){var e=function(t,e){if("object"!=ue(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ue(e)?e:e+""}var ve=function(){return function(t,e,r){return e&&pe(t.prototype,e),r&&pe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.stopping=!1,this.countdownTime=[0,0],this.setTimeout=e.setTimeout||window.setTimeout,this.clearTimeout=e.clearTimeout||window.clearTimeout,this.setTimeout=this.setTimeout.bind(null),this.clearTimeout=this.clearTimeout.bind(null)}),[{key:"setOptions",value:function(t){this.options=t}},{key:"ready",value:function(t){return this.options=t,this.isAllDataAvailable=!1,this.cancelled=!1,this.taskInit(),this.prepare(this.initialize.bind(this))}},{key:"initialize",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];this.recorder=le(ce,e),this.recorder.ondataavailable=this.handleDataAvailable.bind(this),this.recorder.onRawDataAvailable=this.handleRawDataAvailable.bind(this),this.recorder.onAbort=this.handleAbort.bind(this),this.recorder.onAllDataAvailable=this.handleAllDataAvailable.bind(this)}},{key:"start",value:function(){try{this.recorder.start()}catch(t){return this.cancel()}return this.showStatus=ot.recording,this.recordingTimer(),this.recorderEvent=at.start,this.refreshStatus(),this.recorderEvent=at.null,this.recorder.startTime}},{key:"pause",value:function(){return this.showStatus=ot.paused,this.recorderEvent=at.pause,this.refreshStatus(),this.recorderEvent=at.null,this.recorder.countedDuration}},{key:"safePause",value:function(){return(0,D.m)(this,void 0,void 0,se().mark((function t(){return se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this.recorder.size){t.next=4;break}return t.next=4,Jt(400,this.setTimeout);case 4:return t.abrupt("return",this.pause());case 5:case"end":return t.stop()}}),t,this)})))}},{key:"resume",value:function(){return this.showStatus=ot.recording,this.recordingTimer(),this.recorderEvent=at.resume,this.refreshStatus(),this.recorderEvent=at.null,this.recorder.resumeTime}},{key:"cancel",value:function(){var t;this.cancelled||(this.cancelled=!0,this.showStatus=ot.ready,null===(t=this.recorder)||void 0===t||t.cancel(),this.recorderEvent=at.cancel,this.refreshStatus(),this.recorderEvent=at.null,this.clear())}},{key:"stop",value:function(){this.recorder.stop(),this.foregroundProcessing?this.showStatus=ot.uploading:this.showStatus=ot.ready,this.recorderEvent=at.stop,this.refreshStatus(),this.recorderEvent=at.null,this.clear()}},{key:"safeStop",value:function(){return(0,D.m)(this,void 0,void 0,se().mark((function t(){return se().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.stopping){t.next=3;break}return t.abrupt("return");case 3:if(this.stopping=!0,0!==this.recorder.size){t.next=9;break}return t.next=9,Jt(400,this.setTimeout);case 9:this.stop(),this.stopping=!1;case 11:case"end":return t.stop()}}),t,this)})))}},{key:"handleDataAvailable",value:function(t){try{this.onDataAvailable&&this.onDataAvailable(t)}catch(t){}}},{key:"handleRawDataAvailable",value:function(t){try{this.onRawDataAvailable&&this.onRawDataAvailable(t)}catch(t){}}},{key:"handleAllDataAvailable",value:function(){try{this.onAllDataAvailable&&this.onAllDataAvailable()}catch(t){}}},{key:"handleAbort",value:function(t,e){switch(this.showStatus===ot.recording&&Date.now()-this.recorder.startTime<400&&(this.showStatus=ot.countdown),this.showStatus){case ot.ready:break;case ot.waitingAuthorized:case ot.connecting:case ot.countdown:this.cancel(),this.recorderEvent=at.abort_cancel,this.refreshStatus(),this.recorderEvent=at.null;break;case ot.recording:case ot.paused:this.stop(),this.recorderEvent=at.abort_stop,this.refreshStatus(),this.recorderEvent=at.null}}},{key:"clear",value:function(){this.recorderEvent=at.null}}])}();function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function me(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ge(n.key),n)}}function ge(t){var e=function(t,e){if("object"!=ye(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ye(e)?e:e+""}function be(t,e,r){return e=ke(e),function(t,e){if(e&&("object"==ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,we()?Reflect.construct(e,r||[],ke(t).constructor):e.apply(t,r))}function we(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(we=function(){return!!t})()}function xe(){return xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ke(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},xe.apply(null,arguments)}function ke(t){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ke(t)}function Se(t,e){return Se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Se(t,e)}var Ee=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=be(this,e,[t])).simpleTaskPool={},r.taskPool={},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Se(t,e)}(e,t),function(t,e,r){return e&&me(t.prototype,e),r&&me(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"setTask",value:function(t){t.id&&t.generate&&(this.taskPool[t.id]=t),t.id&&t.action&&(this.simpleTaskPool[t.id]=t)}},{key:"taskInit",value:function(){this.simpleTaskPool={};for(var t=0,e=Object.keys(this.taskPool);t<e.length;t++){var r=e[t],n=this.taskPool[r];n.init&&n.init(n)}}},{key:"removeTask",value:function(t){delete this.simpleTaskPool[t],delete this.taskPool[t]}},{key:"getTask",value:function(t){return this.simpleTaskPool[t]||null}},{key:"checkTask",value:function(t){for(var e=Date.now(),r=0,n=Object.keys(this.taskPool);r<n.length;r++){var o=n[r],i=this.taskPool[o],a=i.generate(i,t);a&&a.id&&this.setTask(a)}for(var c=0,u=Object.keys(this.simpleTaskPool);c<u.length;c++){var s=u[c],l=this.simpleTaskPool[s];isFinite(l.timestamp)&&l.timestamp<=e&&this.executeSimpleTask(l),isFinite(l.duration)&&l.duration<=t&&this.executeSimpleTask(l)}}},{key:"executeSimpleTask",value:function(t){switch(t.action){case"stop":this.stop();break;case"pause":this.pause()}delete this.simpleTaskPool[t.id]}},{key:"showTimer",value:function(t){}},{key:"countdownTimer",value:function(t){var e=this,r=function(){var n=t[1]-(Date.now()-t[0]);if(n>0&&e.showStatus===ot.countdown)return e.showTimer(Math.round(n/1e3)+""),void(e.countdownTimeoutId=e.setTimeout(r,n%1e3));e.setTimeout((function(){e.start()}),100)};r()}},{key:"recordingTimer",value:function(){var t,e,r=this,n=this.recorder.countedDuration,o=this.recorder.resumeTime,i=function(){var a,c,u,s;r.showStatus===ot.recording&&(t=n+Date.now()-o,r.showTimer((a=t,c=Math.floor(a/36e5),u=Math.floor(a%36e5/6e4),s=Math.floor(a%6e4/1e3),c>0?"".concat(c,":").concat(("00"+u).slice(-2),":").concat(("00"+s).slice(-2)):"".concat(u,":").concat(("00"+s).slice(-2)))),r.checkTask(t),e=t%1e3,e=Math.max(1e3-e,e),r.recordingTimeoutId=r.setTimeout(i,e))};i()}},{key:"clear",value:function(){!function(t,e,r,n){var o=xe(ke(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}(e,"clear",this,3)([]),this.showTimer(""),this.clearTimeout(this.countdownTimeoutId),this.clearTimeout(this.recordingTimeoutId),this.simpleTaskPool={}}}])}(ve);function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function Oe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ie(n.key),n)}}function Ie(t){var e=function(t,e){if("object"!=Te(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Te(e)?e:e+""}function je(t,e,r){return e=Pe(e),function(t,e){if(e&&("object"==Te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Le()?Reflect.construct(e,r||[],Pe(t).constructor):e.apply(t,r))}function Le(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Le=function(){return!!t})()}function Pe(t){return Pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pe(t)}function _e(t,e){return _e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_e(t,e)}var Ce=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),je(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_e(t,e)}(e,t),function(t,e,r){return e&&Oe(t.prototype,e),r&&Oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"catch",value:function(t,e){return t&&"Invalid state"===t.message?this.report("cancelShareScreen",t):t&&"Permission denied by system"===t.message||t&&"Could not start video source"===t.message?(this.report("startFailed",t),this.report("recordingPermissionDenied")):void(t&&"getStreamFailed"===e&&this.report("cameraUnavailable",t))}},{key:"report",value:function(t,e){"function"==typeof this.onCatch&&this.onCatch.call(null,t,e)}}])}(Ee);function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Me(){Me=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==De(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(De(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ae(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Re(n.key),n)}}function Re(t){var e=function(t,e){if("object"!=De(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=De(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==De(e)?e:e+""}function Ne(t,e,r){return e=Ze(e),function(t,e){if(e&&("object"==De(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ge()?Reflect.construct(e,r||[],Ze(t).constructor):e.apply(t,r))}function Ge(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ge=function(){return!!t})()}function Fe(){return Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Ze(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Fe.apply(null,arguments)}function Ze(t){return Ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ze(t)}function Ue(t,e){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ue(t,e)}var Be=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=Ne(this,e,[t]),t&&(r.blankCameraVideo=t.blankCameraVideo,r.pipAspectRatio=t.pipCameraAspectRatio),r.handleLeavePictureInPicture=r.handleLeavePictureInPicture.bind(r),r.isCameraOn=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(e,t),function(t,e,r){return e&&Ae(t.prototype,e),r&&Ae(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"turnCameraTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,D.m)(this,void 0,void 0,Me().mark((function r(){return Me().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("on"===t&&this.showCamera(e),"off"!==t){r.next=4;break}return r.next=4,this.closeCamera();case 4:this.refreshStatus();case 5:case"end":return r.stop()}}),r,this)})))}},{key:"showCamera",value:function(t){return(0,D.m)(this,void 0,void 0,Me().mark((function e(){var r;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t||this.options.camera.deviceId,this.cameraID=r,e.t0=this.options.recordType,e.next=e.t0===nt.tab?5:e.t0===nt.desktop?8:e.t0===nt.camera?11:12;break;case 5:return e.next=7,this.tabShowCamera(r);case 7:return e.abrupt("break",12);case 8:return e.next=10,this.showCameraPictureInPicture(r);case 10:case 11:return e.abrupt("break",12);case 12:this.isCameraOn=!0,this.refreshStatus();case 14:case"end":return e.stop()}}),e,this)})))}},{key:"closeCamera",value:function(){var t;switch(null===(t=this.options)||void 0===t?void 0:t.recordType){case nt.tab:return this.tabCloseCamera();case nt.desktop:return this.exitPictureInPicture();case nt.camera:}}},{key:"syncTabCameraStatus",value:function(t,e,r){var n=!e||e===this.tabId;t!==this.isCameraOn&&n&&(this.isCameraOn=t),r&&(this.cameraID=r)}},{key:"showCameraPictureInPicture",value:function(t){return(0,D.m)(this,void 0,void 0,Me().mark((function e(){var r;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r="on-"+t)!==this.pictureInPictureKey){e.next=4;break}return e.abrupt("return");case 4:if(this.pictureInPictureKey=r,this.closePendingPictureInPicture=!1,void 0!==document.pictureInPictureElement){e.next=9;break}return e.abrupt("return");case 9:return e.prev=9,e.next=12,this.videoPictureInPicture();case 12:if(e.sent){e.next=16;break}return e.next=16,this.newVideoPictureInPicture(t);case 16:return e.prev=16,this.closePendingPictureInPicture&&this.exitPictureInPicture(),e.finish(16);case 20:case"end":return e.stop()}}),e,this,[[9,,16,20]])})))}},{key:"videoPictureInPicture",value:function(t){return(0,D.m)(this,void 0,void 0,Me().mark((function e(){var r,n=this;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=document.querySelector(t||"video.ours-picture-in-picture-video"))){e.next=7;break}return e.next=5,r.requestPictureInPicture().then((function(){r.classList.add("picture-in-picture"),r.play().catch(console.error)}),(function(){function t(){r.requestPictureInPicture(),r.classList.add("picture-in-picture"),r.play().catch((function(){}))}r.addEventListener("loadeddata",t),n.removeLoadedDataListener=function(){r.removeEventListener("loadeddata",t)}}));case 5:return r.addEventListener("leavepictureinpicture",this.handleLeavePictureInPicture),e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"newVideoPictureInPicture",value:function(t){var e,r;return(0,D.m)(this,void 0,void 0,Me().mark((function n(){var o,i,a,c=this;return Me().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=t||(null===(r=null===(e=this.options)||void 0===e?void 0:e.camera)||void 0===r?void 0:r.deviceId),this.assistCapturer&&this.assistCapturer.stopCapture(),this.assistCapturer=new qt,o=Date.now(),this.cameraCapturerId=o,this.videoEl||(this.videoEl=document.createElement("video")),a=new Promise((function(t){i=t})),this.videoEl.onloadedmetadata=function(){c.videoEl.onloadedmetadata=null,c.videoEl.requestPictureInPicture().then((function(){c.videoEl.onleavepictureinpicture=c.handleLeavePictureInPicture,i&&i(!0)})).catch((function(){i&&i(!1)}))},!this.blankCameraVideo){n.next=18;break}return this.videoEl.srcObject=null,this.videoEl.src=this.blankCameraVideo,this.videoEl.play(),n.next=15,a;case 15:if(n.sent){n.next=18;break}return n.abrupt("return");case 18:return n.next=20,this.assistCapturer.getUserMedia({audio:!1,video:!t||{deviceId:t}}).then((function(t){o!==c.cameraCapturerId&&qt.stopStream(t),c.pipAspectRatio&&t.getVideoTracks().forEach((function(t){t.applyConstraints({aspectRatio:c.pipAspectRatio})})),c.cameraStream=t})).catch((function(t){c.catch(t,"getStreamFailed")}));case 20:return this.videoEl.srcObject=this.cameraStream,this.videoEl.play(),n.abrupt("return",a);case 23:case"end":return n.stop()}}),n,this)})))}},{key:"exitPictureInPicture",value:function(){return(0,D.m)(this,void 0,void 0,Me().mark((function t(){return Me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.closePendingPictureInPicture=!0,this.pictureInPictureKey="off",qt.stopStream(this.cameraStream),!document.pictureInPictureElement){t.next=9;break}return t.next=7,document.exitPictureInPicture();case 7:t.next=10;break;case 9:this.isCameraOn&&(this.isCameraOn=!1);case 10:this.removeLoadedDataListener&&this.removeLoadedDataListener();case 11:case"end":return t.stop()}}),t,this)})))}},{key:"handleLeavePictureInPicture",value:function(t){this.pictureInPictureKey="off",qt.stopStream(this.cameraStream),t&&t.target.classList.remove("picture-in-picture"),this.isCameraOn=!1,![ot.notReady,ot.ready].includes(this.showStatus)&&this.refreshStatus()}},{key:"tabShowCamera",value:function(t){return(0,D.m)(this,void 0,void 0,Me().mark((function e(){var r;return Me().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t||this.options.camera.deviceId,this.safeSendMessageToTab({action:Vt.tabShowCamera,cameraId:r},this.options.tabId),this.onToggleTabCamera&&this.onToggleTabCamera({tabId:this.options.tabId,visible:!0,deviceId:r});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"tabCloseCamera",value:function(){this.safeSendMessageToTab({action:Vt.tabCloseCamera},this.options.tabId);try{this.onToggleTabCamera&&this.onToggleTabCamera({tabId:this.options.tabId,visible:!1})}catch(t){}this.isCameraOn=!1,this.refreshStatus()}},{key:"clear",value:function(){!function(t,e,r,n){var o=Fe(Ze(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}(e,"clear",this,3)([]),this.closeCamera(),this.isCameraOn=!1,this.assistCapturer&&this.assistCapturer.stopCapture(),this.assistCapturer=null}}])}(Ce);function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function Ve(){Ve=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==ze(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ze(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function qe(t){switch(t){case"720p":return{maxWidth:1280,maxHeight:720,maxFrameRate:30};case"1080p":default:return{maxWidth:1920,maxHeight:1080,maxFrameRate:30};case"2k":return{maxWidth:2560,maxHeight:1440,maxFrameRate:30};case"4k":return{maxWidth:4096,maxHeight:2160,maxFrameRate:30}}}function Ke(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3670016;return(0,D.m)(this,void 0,void 0,Ve().mark((function r(){var n,o,i,a,c,u;return Ve().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.getVideoTracks()[0].getSettings(),o=n.width,i=n.height,r.prev=3,a=new ImageCapture(t.getVideoTracks()[0]),r.next=7,a.grabFrame();case 7:c=r.sent,o=c.width,i=c.height,c.close(),r.next=15;break;case 13:r.prev=13,r.t0=r.catch(3);case 15:return u=Math.round(Math.sqrt(o*i/1920/1080)*e),r.abrupt("return",{videoBitsPerSecond:u});case 17:case"end":return r.stop()}}),r,null,[[3,13]])})))}function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function He(){He=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==We(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(We(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ye(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Je(n.key),n)}}function Je(t){var e=function(t,e){if("object"!=We(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==We(e)?e:e+""}function Qe(t,e,r){return e=tr(e),function(t,e){if(e&&("object"==We(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$e()?Reflect.construct(e,r||[],tr(t).constructor):e.apply(t,r))}function $e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($e=function(){return!!t})()}function Xe(){return Xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=tr(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Xe.apply(null,arguments)}function tr(t){return tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tr(t)}function er(t,e){return er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},er(t,e)}var rr=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Qe(this,e,[t])).foregroundProcessing=t.foregroundProcessing,r.mediaSources=t.mediaSources||["screen","window","tab","audio"],r.mimeTypes=t.mimeTypes,r.timeSlice=t.timeSlice||1e3,r.safariTimeslicePatch=!0===t.safariTimeslicePatch,r.bitrateBase=t.bitrateBase||3670016,r.showStatus=ot.ready,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&er(t,e)}(e,t),function(t,e,r){return e&&Ye(t.prototype,e),r&&Ye(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"reopenDesktopMediaPicker",value:function(){this.showStatus===ot.waitingAuthorized&&[nt.desktop].includes(this.options.recordType)&&this.capturer&&this.capturer.reopenDesktopMediaPicker()}},{key:"turnMicTo",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,D.m)(this,void 0,void 0,He().mark((function n(){var o;return He().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=r||(null===(e=this.options.microphone)||void 0===e?void 0:e.deviceId),"on"===t?(this.isMicOn=!0,this.capturer.turnOnMic(o)):"off"===t?(this.isMicOn=!1,this.capturer.turnOffMic()):(this.isMicOn?this.capturer.turnOffMic():this.capturer.turnOnMic(o),this.isMicOn=!this.isMicOn),this.micID=o,this.refreshStatus();case 4:case"end":return n.stop()}}),n,this)})))}},{key:"prepare",value:function(t){var e;return(0,D.m)(this,void 0,void 0,He().mark((function r(){var n,o,i=this;return He().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:this.showStatus=ot.waitingAuthorized,this.refreshStatus(),this.tabId=this.options.tabId,n=this.onPrepare?this.onPrepare(this.options):Promise.resolve(),o=this.prepareStream(this.options),(null===(e=this.options.camera)||void 0===e?void 0:e.open)&&this.showCamera(),this.prepareAbort=!1,o.then((function(t){try{i.afterCaptureStream&&i.afterCaptureStream(t)}catch(t){}i.validateStream(t),i.recordStream=t,i.showStatus=ot.connecting,i.refreshStatus()})).then((function(){return n})).then((function(){var t=i.options.quality||{},e=Object.assign({},t.videoBitsPerSecond?{videoBitsPerSecond:t.videoBitsPerSecond}:{});return e.videoBitsPerSecond?Promise.resolve(e):Ke(i.recordStream,i.bitrateBase)})).then((function(e){var r=i.options,n=r.processorType,o=r.stopTimerTask;i.capturer.prepareAudioContext();var a="storage"==n||"none"==n;t(i.recordStream,Object.assign({},e),{fallbackMimeTypes:i.mimeTypes,timeSlice:i.timeSlice,noWasmMuxer:null,safariTimeslicePatch:i.safariTimeslicePatch,noFragmentedMp4:a,setTimeout:i.setTimeout,clearTimeout:i.clearTimeout}),o&&i.setTask(o),i.showStatus=ot.countdown,i.countdownTime=[Date.now(),i.options.countdown],i.countdownTimer(i.countdownTime),i.refreshStatus()})).catch((function(t){i.recordStream||i.afterCaptureStream&&i.afterCaptureStream(null),i.prepareAbort=!0,i.showStatus=ot.ready,i.refreshStatus(),i.resetPrepared(),i.cancel(),i.catch(t)})),this.recorderEvent=at.ready,this.refreshStatus(),this.recorderEvent=at.null;case 11:case"end":return r.stop()}}),r,this)})))}},{key:"prepareStream",value:function(t){var e,r,n,o;return(0,D.m)(this,void 0,void 0,He().mark((function i(){var a,c,u,s,l,h=this;return He().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.stream){i.next=2;break}return i.abrupt("return",t.stream);case 2:this.beforeCaptureStream&&this.beforeCaptureStream(t),a=null===(e=this.options.microphone)||void 0===e?void 0:e.deviceId,c=Object.assign(Object.assign({},qe(this.options.quality.equivalent)),this.options.quality),u=new qt({setTimeout:this.setTimeout,clearTimeout:this.clearTimeout}),this.capturer=u,this.isMicOn=!1,s=[],i.t0=t.recordType,i.next=i.t0===nt.desktop?12:i.t0===nt.tab?14:i.t0===nt.camera?17:19;break;case 12:return qt.isCaptureDesktopSupported()?s.push(this.capturer.captureDesktop({streamId:t.streamId,sources:this.mediaSources,timeout:6e4,constraints:{audio:!0,video:{mandatory:{maxWidth:c.maxWidth,maxHeight:c.maxHeight,maxFrameRate:c.maxFrameRate}}}})):s.push(this.capturer.getDisplayMedia({audio:!0,video:{width:{max:c.maxWidth},height:{max:c.maxHeight},frameRate:c.maxFrameRate}})),i.abrupt("break",19);case 14:return s.push(this.capturer.captureTab({targetTabId:this.options.tabId,streamId:this.options.streamId,captureOptions:{audio:!1!==this.options.tabAudio,video:!0,videoConstraints:{mandatory:this.options.crop?{maxWidth:this.options.crop.ww,maxHeight:this.options.crop.wh}:{maxWidth:c.maxWidth,maxHeight:c.maxHeight}}}})),i.abrupt("break",19);case 17:return s.push(this.capturer.getUserMedia({video:{deviceId:null===(r=this.options.camera)||void 0===r?void 0:r.deviceId},audio:!1})),i.abrupt("break",19);case 19:if(!this.options.crop){i.next=25;break}return i.next=23,Promise.all(s);case 23:return i.next=25,this.capturer.cropVideoTrack(this.options.crop);case 25:if(!(null===(o=null===(n=this.options)||void 0===n?void 0:n.microphone)||void 0===o?void 0:o.open)){i.next=33;break}return this.isMicOn=!0,this.micID=a,i.next=31,Promise.all(s);case 31:l=this.capturer.turnOnMic(a).then((function(t){t||(h.isMicOn=!1)})),s.push(l);case 33:return i.next=35,Promise.all(s);case 35:return this.prepareAbort&&u.stopCapture(),i.abrupt("return",u.stream);case 38:case"end":return i.stop()}}),i,this)})))}},{key:"validateStream",value:function(t){var e=!0;if(t||(e=!1),t.active||(e=!1),!e)throw Error("Capturer: invalid stream.")}},{key:"resetPrepared",value:function(){this.capturer&&this.capturer.stopCapture(),qt.stopStream(this.recordStream),this.closeCamera()}},{key:"getTabInfo",value:function(t){return(0,D.m)(this,void 0,void 0,He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{title:document.title,url:window.location.href});case 1:case"end":return t.stop()}}),t)})))}},{key:"safeSendMessageToTab",value:function(t,e){return(0,D.m)(this,void 0,void 0,He().mark((function t(){return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return");case 1:case"end":return t.stop()}}),t)})))}},{key:"clear",value:function(){!function(t,e,r,n){var o=Xe(tr(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}(e,"clear",this,3)([]),this.tabId=null,this.tabInfo=null,this.capturer&&this.capturer.stopCapture(),qt.stopStream(this.recordStream),this.recordStream=null,this.capturer=null}}])}(Be);function nr(t){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nr(t)}function or(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ir(n.key),n)}}function ir(t){var e=function(t,e){if("object"!=nr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=nr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==nr(e)?e:e+""}function ar(t,e,r){return e=ur(e),function(t,e){if(e&&("object"==nr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,cr()?Reflect.construct(e,r||[],ur(t).constructor):e.apply(t,r))}function cr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(cr=function(){return!!t})()}function ur(t){return ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ur(t)}function sr(t,e){return sr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sr(t,e)}var lr=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ar(this,e,[t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sr(t,e)}(e,t),function(t,e,r){return e&&or(t.prototype,e),r&&or(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"refreshStatus",value:function(){}},{key:"getStatusData",value:function(){}}])}(rr),hr=r(45468);function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function pr(){pr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==fr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(fr(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mr(n.key),n)}}function yr(t,e,r){return e&&vr(t.prototype,e),r&&vr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mr(t){var e=function(t,e){if("object"!=fr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fr(e)?e:e+""}var gr=function(){return yr((function t(e){var r=this;dr(this,t),this.processing=!1,this.dataSize=0,this.dataCount=0,this.confirmedDataCount=0,this.jobQueue=new br,this.status="uploading",this.reUploading=!1,this.reUploadFirstSlice=!0,this.hasError=!1,Qt.meta.token=e.token,this.apiOrigin=e.apiPath,e.backupKey&&(this.backupKey=e.backupKey,this.backup=new hr.Z),$t(this,"confirmedDataCount",(function(){return r.refreshProgress()})),$t(this,"dataCount",(function(){return r.refreshProgress()}))}),[{key:"ready",value:function(t){return(0,D.m)(this,void 0,void 0,pr().mark((function e(){return pr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.title=t.title,this.payload=this.parsePayload(t.payload||{}),e.next=4,this.init();case 4:return this.vid=e.sent,this.onConnected&&this.onConnected(this.vid,{vid:this.vid}),e.abrupt("return",this.vid);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"init",value:function(){return(0,D.m)(this,void 0,void 0,pr().mark((function t(){var e;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.processing=!0,t.next=3,Qt.post(this.getUrl("v2/record/init"),{body:JSON.stringify({video_title:this.title,scope:this.payload.scope,extra:this.payload.extra})});case 3:return e=t.sent,this.processing=!1,3===e.data.status&&this.callHook("onError",this.vid,{type:"quotaExceeded"}),t.abrupt("return",e.data.vid);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"push",value:function(t){this.hasError||("uploading"===this.status||"paused"===this.status)&&Yt(t)&&t.size&&(this.dataSize||this.reportFirstSlice(t),this.pushUploadJob(t,this.dataSize,this.dataCount),this.dataSize+=t.size,this.dataCount+=1)}},{key:"pushUploadJob",value:function(t,e,r){var n=this;this.backup&&this.jobQueue.length>250?this.jobQueue.push((function(){return(0,D.m)(n,void 0,void 0,pr().mark((function t(){var n,o;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.backup.getSlice(this.backupKey,r);case 2:return n=t.sent,o=n.data,t.next=6,this.upload(o,e,r);case 6:case"end":return t.stop()}}),t,this)})))})):this.jobQueue.push((function(){return(0,D.m)(n,void 0,void 0,pr().mark((function n(){return pr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.upload(t,e,r);case 2:case"end":return n.stop()}}),n,this)})))}))}},{key:"uploadSlice",value:function(t,e,r){return(0,D.m)(this,void 0,void 0,pr().mark((function n(){var o=this;return pr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.hasError){n.next=2;break}return n.abrupt("return",!0);case 2:if("uploading"!==this.status||!Yt(t)||!t.size){n.next=13;break}if(!this.reUploadFirstSlice){n.next=9;break}return this.reUploadFirstSlice=!1,n.next=7,this.upload(t,e,r);case 7:n.next=11;break;case 9:return n.next=11,this.jobQueue.push((function(){return(0,D.m)(o,void 0,void 0,pr().mark((function n(){return pr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.upload(t,e,r);case 2:case"end":return n.stop()}}),n,this)})))}));case 11:if(!this.hasError){n.next=13;break}return n.abrupt("return",!0);case 13:case"end":return n.stop()}}),n,this)})))}},{key:"upload",value:function(t,e,r){return(0,D.m)(this,void 0,void 0,pr().mark((function n(){var o;return pr().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(o=new FormData).append("video_id",this.vid),o.append("file",t),o.append("offset",String(e)),n.next=6,Qt.post(this.getUrl("v2/record/file_upload?vid=".concat(this.vid,"&idx=").concat(r,"&offset=").concat(e)),{body:o},{retry:!0});case 6:if(-400!==n.sent.code){n.next=10;break}return this.hasError||(this.hasError=!0,this.status="stopped",this.callHook("onError",this.vid,{})),n.abrupt("return");case 10:"canceled"!==this.status&&(Ht(this.onSliceUploaded)&&this.onSliceUploaded(this.vid,r),this.confirmedDataCount+=1);case 11:case"end":return n.stop()}}),n,this)})))}},{key:"startReUpload",value:function(t,e,r,n){this.vid=t,this.reUploading=!0,this.dataSize=n||0,this.dataCount=e,this.confirmedDataCount=r}},{key:"start",value:function(){return{vid:this.vid,title:this.title}}},{key:"pause",value:function(){this.status="paused"}},{key:"resume",value:function(){this.status="uploading"}},{key:"stop",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.keepalive,r=void 0!==e&&e,n=t.onStop,o=void 0===n?function(){return null}:n;return(0,D.m)(this,void 0,void 0,pr().mark((function t(){var e=this;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("stopped"!==this.status){t.next=2;break}return t.abrupt("return");case 2:this.status="stopped",this.hasError||(this.processing=!0,Xt((function(){return(0,D.m)(e,void 0,void 0,pr().mark((function t(){return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.done){t.next=7;break}return t.next=3,Qt.put(this.getUrl("/record/complete/".concat(this.vid,"?type=").concat(this.reUploading?"backup":"default")),{keepalive:r},{retry:!0});case 3:return this.processing=!1,this.callHook("onSuccess",this.vid,{vid:this.vid,title:this.title}),Ht(o)&&o(),t.abrupt("return",!0);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t,this)})))}),1e3));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"cancel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,D.m)(this,void 0,void 0,pr().mark((function e(){var r=this;return pr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("canceled"!==this.status){e.next=2;break}return e.abrupt("return");case 2:return this.status="canceled",this.processing=!0,e.abrupt("return",Xt((function(){return(0,D.m)(r,void 0,void 0,pr().mark((function e(){var r;return pr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.vid){e.next=6;break}return r=this.getUrl("/record/".concat(this.dataSize?"discard":"cancel","/").concat(this.vid)),e.next=4,Qt.delete(r,{keepalive:t},{retry:!0});case 4:return this.processing=!1,e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e,this)})))}),1e3));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"reportFirstSlice",value:function(t){Qt.post(this.getUrl("/record/buffer/first"),{body:JSON.stringify({id:this.vid,size:t.size,extra:this.payload.extra})})}},{key:"parsePayload",value:function(t){var e=t,r={};e.locationType&&e.locationId&&(r.scope={type:e.locationType,id:e.locationId});var n=r.extra={};return e.tabUrl&&(n.source_url=e.tabUrl),e.appVersion&&(n.client_version=e.appVersion),e.recordType&&(n.record_type=e.recordType),e.recorderVersion&&(n.recorder_version=e.recorderVersion),e.screenSize&&(n.screen_size=e.screenSize),e.appAndPlatform&&(n.client=e.appAndPlatform),r}},{key:"getUrl",value:function(t){return function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.join("/").replace(/([^:])\/{2,}/g,"$1/")}(this.apiOrigin,t)}},{key:"progress",get:function(){return{finished:this.confirmedDataCount,current:this.confirmedDataCount,total:this.dataCount,more:{binarySlice:this.confirmedDataCount}}}},{key:"done",get:function(){return"stopped"===this.status&&this.confirmedDataCount===this.dataCount}},{key:"refreshProgress",value:function(){var t=this.progress;this.callHook("onProgress",this.vid,t.finished/t.total,{binarySlice:t.more.binarySlice,finished:t.finished,total:t.total,current:t.current})}},{key:"onProgress",value:function(t,e){}},{key:"onError",value:function(){}},{key:"onSuccess",value:function(){}},{key:"onSliceUploaded",value:function(t,e){return(0,D.m)(this,void 0,void 0,pr().mark((function t(){return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))}},{key:"callHook",value:function(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];Ht(this[t])&&(e=this[t]).call.apply(e,[this].concat(n))}}])}(),br=function(){return yr((function t(){dr(this,t),this.runningCount=0,this.jobs=[]}),[{key:"busy",get:function(){return this.runningCount>=5}},{key:"length",get:function(){return this.jobs.length}},{key:"push",value:function(t){var e=this,r=new Promise((function(t){e.resolveHook=t}));return this.jobs.push(t),this.startNextJob(),r}},{key:"startNextJob",value:function(){return(0,D.m)(this,void 0,void 0,pr().mark((function t(){var e;return pr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.busy){t.next=2;break}return t.abrupt("return");case 2:return this.resolveHook(this.runningCount),this.runningCount++,e=this.jobs.shift(),t.prev=5,t.next=8,e();case 8:this.runningCount--,this.jobs.length>0&&this.startNextJob(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(5),this.runningCount--,this.push(e);case 16:case"end":return t.stop()}}),t,this,[[5,12]])})))}}])}(),wr=r(42097);function xr(t){return xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xr(t)}function kr(){kr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==xr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(xr(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Sr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Er(n.key),n)}}function Er(t){var e=function(t,e){if("object"!=xr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=xr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==xr(e)?e:e+""}function Tr(t,e,r){return e=Lr(e),function(t,e){if(e&&("object"==xr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Or()?Reflect.construct(e,r||[],Lr(t).constructor):e.apply(t,r))}function Or(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Or=function(){return!!t})()}function Ir(t,e,r,n){var o=jr(Lr(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function jr(){return jr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Lr(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},jr.apply(null,arguments)}function Lr(t){return Lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lr(t)}function Pr(t,e){return Pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pr(t,e)}var _r=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Tr(this,e,[t])).backupStrategy=t.backupStrategy,r.autoGenerateThumbnail=!1!==t.autoGenerateThumbnail,r.isStorageAlert=!1,r.isEmptyData=!0,r.isEmptyFmp4Data=!0,r.onPrepare=r.prepareCompat.bind(r),r.singleLine=new wr.u({setTimeout:r.setTimeout,clearTimeout:r.clearTimeout}),r.processorMap=new Map,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pr(t,e)}(e,t),function(t,e,r){return e&&Sr(t.prototype,e),r&&Sr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"prepareCompat",value:function(){var t;return(0,D.m)(this,void 0,void 0,kr().mark((function e(){return kr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforePrepareProcessor();case 2:if(!this.prepareAbort){e.next=4;break}throw Error("prepareAborted");case 4:return e.next=6,this.prepareBackup();case 6:return this.backupKey=e.sent,e.next=9,this.prepareProcessor();case 9:return this.processKey=e.sent,this.backup&&this.backup.update({processKey:this.processKey,originId:this.videoId,options:this.options}),null===(t=this.singleLine)||void 0===t||t.register(this.processKey),e.next=15,this.afterPrepareProcessor();case 15:case"end":return e.stop()}}),e,this)})))}},{key:"updateStorageAlert",value:function(t){this.isStorageAlert=t}},{key:"beforePrepareProcessor",value:function(){return(0,D.m)(this,void 0,void 0,kr().mark((function t(){var e,r,n,o,i,a,c,u;return kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.options,r=e.tabId,n=e.processorType,o=e.title,i=e.recordType,this.videoId="",this.processorType=n||"upload",this.backupType="none",t.t0=this.backupStrategy,t.next="upload"===t.t0?7:"auto"===t.t0?9:"original"===t.t0||"output"===t.t0?11:13;break;case 7:return this.backupType="upload"===this.processorType?"output":"none",t.abrupt("break",13);case 9:return this.backupType="upload"===this.processorType?"output":"original",t.abrupt("break",13);case 11:return this.backupType=this.backupStrategy,t.abrupt("break",13);case 13:if(this.title=o||this.generateTitle(i),!isFinite(r)){t.next=18;break}return t.next=17,this.getTabInfo(r);case 17:this.tab=t.sent;case 18:return t.next=20,this.getProcessorConfig(this.processorType);case 20:a=t.sent,this.processorConfig=a,"token"in a&&(Qt.meta.token=a.token,c=this.parseToken(a.token),u=c.id,this.userId=u);case 23:case"end":return t.stop()}}),t,this)})))}},{key:"prepareBackup",value:function(){return(0,D.m)(this,void 0,void 0,kr().mark((function t(){var e,r;return kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.backupType,t.t0=e,t.next="original"===t.t0||"output"===t.t0?4:(t.t0,6);break;case 4:return this.backup=new hr.Z,t.abrupt("break",8);case 6:return this.backup=null,t.abrupt("break",8);case 8:if(this.backup){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,this.backup.create({title:this.title,owner:this.userId,mimeType:"output"===e?"video/mp4":"video/webm"});case 12:return r=t.sent,t.abrupt("return",r.key);case 14:case"end":return t.stop()}}),t,this)})))}},{key:"prepareProcessor",value:function(){return(0,D.m)(this,void 0,void 0,kr().mark((function t(){var e,r,n;return kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.processorType,r=this.options.payload,t.t0=e,t.next="download"===t.t0?5:"storage"===t.t0?7:"upload"===t.t0?9:"none"===t.t0?11:13;break;case 5:return this.processor=new G,t.abrupt("break",14);case 7:return this.processor=new $({autoGenerateThumbnail:this.autoGenerateThumbnail}),t.abrupt("break",14);case 9:return this.processor=new gr(this.processorConfig),t.abrupt("break",14);case 11:return this.processor=new it(this.processorConfig),t.abrupt("break",14);case 13:throw Error("RecorderCompat processorType not supported!");case 14:return this.processor.onConnected=this.handleProcessorConnected.bind(this),this.processor.onProgress=this.handleProcessorProgress.bind(this),this.processor.onSuccess=this.handleProcessorSuccess.bind(this),this.processor.onError=this.handleProcessorError.bind(this),this.processor.onSliceUploaded=this.handleSliceUploaded.bind(this),t.next=21,this.processor.ready({title:this.title,payload:r});case 21:return n=t.sent,t.abrupt("return",n);case 24:case"end":return t.stop()}}),t,this)})))}},{key:"afterPrepareProcessor",value:function(){return(0,D.m)(this,void 0,void 0,kr().mark((function t(){var e;return kr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.processKey,this.processorMap.set(e,{key:e,type:this.processorType,vid:this.videoId,processor:this.processor,backup:this.backup,title:this.title,size:0,duration:0,progress:0});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"generateTitle",value:function(t){var e=new Date,r="".concat(e.toLocaleDateString().replace(/\//g,"-"),"_").concat(e.toLocaleTimeString("en-US",{hour12:!1}).slice(0,-3));switch(t){case"desktop":return this.tab?this.tab.title:"Desktop-"+r;case"camera":return"Camera-"+r;case"tab":return this.tab?"Tab-"+this.tab.title:"Tab-"+r;default:return"Record-"+r}}},{key:"parseToken",value:function(t){try{return{id:JSON.parse(atob(t.split(".")[1])).user_id+""}}catch(t){return{id:""}}}},{key:"handleDataAvailable",value:function(t){var r=this;if(!this.cancelled){if(t.data&&t.data.size>0&&this.isEmptyFmp4Data&&(this.isEmptyFmp4Data=!1),this.processor.push(t.data),this.backup&&"output"===this.backupType)if(!this.backup.push(t.data,{duration:this.recorder.duration}).then((function(){}),(function(){r.onException&&r.onException("saveFailed","save blob failed")}))){var n="save indexDB before";t.data&&t.data.size||(n="empty blob"),this.onException&&this.onException("saveFailed",n)}Ir(e,"handleDataAvailable",this,3)([t])}}},{key:"handleRawDataAvailable",value:function(t){this.cancelled||(t.data&&t.data.size>0&&this.isEmptyData&&(this.isEmptyData=!1),t.data&&t.data.size||this.onException&&this.onException("emptyBlob","empty original blob"),this.backup&&"original"===this.backupType&&this.backup.push(t.data,{duration:this.recorder.duration}),Ir(e,"handleRawDataAvailable",this,3)([t]))}},{key:"handleProcessorConnected",value:function(t,e){if(t===this.processKey&&(this.videoId=e.vid),this.processorMap.has(t)){var r=this.processorMap.get(t);this.processorMap.set(t,Object.assign(Object.assign({},r),{vid:e.vid})),r&&r.backup&&(null==r||r.backup.update(Object.assign({originId:e.vid,sid:e.sid},(null==e?void 0:e.backupDetails)?e.backupDetails:{})))}}},{key:"handleProcessorProgress",value:function(t,e,r){if(this.processingProgress=[r.finished,r.current,r.total],this.processorMap.has(t)){var n=this.processorMap.get(t).backup;null==n||n.update({uploadedSlice:r.binarySlice,progress:e})}this.isAllDataAvailable||(this.processingProgress=[r.finished,r.current,r.total+3]),this.showStatus===ot.uploading&&this.refreshStatus()}},{key:"handleProcessorError",value:function(t,e){var r;if(t==this.processKey)switch("quotaExceeded"===e.type&&(this.report("quotaExceeded"),this.cancel()),this.showStatus){case ot.waitingAuthorized:case ot.connecting:case ot.countdown:this.prepareAbort=!0,this.cancel();break;case ot.recording:case ot.paused:this.stop()}e&&"networkError"===e.type&&t&&(null===(r=this.singleLine)||void 0===r||r.unregister(t))}},{key:"handleProcessorSuccess",value:function(t){var e;if(t==this.processKey&&(this.showStatus===ot.uploading&&(this.showStatus=ot.ready),this.recorderEvent=at.processing_success,this.refreshStatus(),this.recorderEvent=at.null,this.foregroundProcessing&&this.complete()),this.processorMap.has(t)){var r=this.processorMap.get(t).backup;null==r||r.remove(),this.processorMap.delete(t)}null===(e=this.singleLine)||void 0===e||e.unregister(t)}},{key:"handleSliceUploaded",value:function(t,e){return(0,D.m)(this,void 0,void 0,kr().mark((function r(){var n,o;return kr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!this.processorMap.has(t)){r.next=8;break}if(n=this.processorMap.get(t),!(o=n.backup)){r.next=8;break}return r.next=5,o.updateSlice(e,{uploaded:!0});case 5:if(!this.isStorageAlert){r.next=8;break}return r.next=8,o.deleteSlice(this.backupKey,e);case 8:case"end":return r.stop()}}),r,this)})))}},{key:"handleAllDataAvailable",value:function(){var t,e;return(0,D.m)(this,void 0,void 0,kr().mark((function r(){var n,o,i;return kr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.recorder,o=n.duration,i=n.size,r.next=4,null===(t=this.processor)||void 0===t?void 0:t.stop({duration:o,size:i});case 4:return r.next=6,null===(e=this.backup)||void 0===e?void 0:e.close(o);case 6:this.onStopDone&&this.onStopDone({key:this.processKey,title:this.title,duration:this.recorder.duration,size:this.recorder.size,processorType:this.processorType});case 7:case"end":return r.stop()}}),r,this)})))}},{key:"getUploader",value:function(){return this.processor}},{key:"start",value:function(){this.processor.start(this.recorder.mimeType),Ir(e,"start",this,3)([]);try{this.onStart&&this.onStart({options:this.options,key:this.processKey,title:this.title,processorType:this.processorType})}catch(t){}}},{key:"pause",value:function(){return this.recorder.pause(),this.processor.pause(),Ir(e,"pause",this,3)([])}},{key:"resume",value:function(){return this.recorder.resume(),this.processor.resume(),Ir(e,"resume",this,3)([])}},{key:"cancel",value:function(){var t,r,n,o=Promise.all([null===(t=this.processor)||void 0===t?void 0:t.cancel(),null===(r=this.backup)||void 0===r?void 0:r.remove()]);this.backup=null,this.processKey&&this.processorMap.set(this.processKey,Object.assign(Object.assign({},this.processorMap.get(this.processKey)),{backup:null})),null===(n=this.singleLine)||void 0===n||n.unregister(this.processKey),Ir(e,"cancel",this,3)([]);try{this.onCancel&&this.onCancel({key:this.processKey,title:this.title,processorType:this.processorType,donePromise:o})}catch(t){}}},{key:"stop",value:function(){Ir(e,"stop",this,3)([]);try{this.onStop&&this.onStop({key:this.processKey,title:this.title,duration:this.recorder.duration,size:this.recorder.size,processorType:this.processorType})}catch(t){}this.foregroundProcessing||this.complete()}},{key:"abnormalExit",value:function(){this.recorder&&this.recorder.size?(this.backup&&this.backup.close(),this.processor.stop({keepalive:!0})):(this.processor.cancel(!0),this.backup&&this.backup.remove())}},{key:"complete",value:function(){}},{key:"clear",value:function(){Ir(e,"clear",this,3)([]);try{this.onClear&&this.onClear()}catch(t){}}},{key:"getStatusData",value:function(){var t;return this.recorder?{recordType:this.options.recordType,showStatus:this.showStatus,resumeTime:this.recorder.resumeTime,countedDuration:this.recorder.countedDuration,size:this.recorder.size,countdownTime:this.countdownTime,recorderEvent:this.recorderEvent,isCameraOn:this.isCameraOn,videoTitle:this.title,processingProgress:this.processingProgress,isMicOn:this.isMicOn,videoId:this.videoId,micID:this.micID,cameraID:this.cameraID,processorRunning:this.processor.processing,tabId:this.tabId}:{recordType:null===(t=this.options)||void 0===t?void 0:t.recordType,showStatus:this.showStatus,resumeTime:0,countedDuration:0,size:0,countdownTime:this.countdownTime,recorderEvent:this.recorderEvent,isCameraOn:this.isCameraOn,videoTitle:this.title,processingProgress:this.processingProgress,isMicOn:this.isMicOn,videoId:this.videoId,micID:this.micID,cameraID:this.cameraID,processorRunning:!1,tabId:this.tabId}}},{key:"refreshStatus",value:function(){var t=this.getStatusData();this.onStatusChange&&this.onStatusChange(t)}}])}(lr),Cr=r(94988);function Dr(t){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dr(t)}function Mr(){Mr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Dr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Dr(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ar(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Rr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ar(i,n,o,a,c,"next",t)}function c(t){Ar(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gr(n.key),n)}}function Gr(t){var e=function(t,e){if("object"!=Dr(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Dr(e)?e:e+""}function Fr(t,e,r){return e=zr(e),function(t,e){if(e&&("object"==Dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zr()?Reflect.construct(e,r||[],zr(t).constructor):e.apply(t,r))}function Zr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Zr=function(){return!!t})()}function Ur(t,e,r,n){var o=Br(zr(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function Br(){return Br="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=zr(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Br.apply(null,arguments)}function zr(t){return zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zr(t)}function Vr(t,e){return Vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vr(t,e)}var qr=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Fr(this,e,[t])).haveEndRecord=!1,r.sendStopInfo=!1,r.haveAlertEmptyData=!1,r.reportFmp4Time=0,r.reportEmptyData=0,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vr(t,e)}(e,t),function(t,e,r){return e&&Nr(t.prototype,e),r&&Nr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"getUid",value:(f=Rr(Mr().mark((function t(){return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.runtime.sendMessage({action:"getUID"},(function(e){t(e)}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)})},{key:"getProcessorConfig",value:(h=Rr(Mr().mark((function t(){var e,r,n;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.options.payload,t.next=4,this.getUid();case 4:return r=t.sent,n={wsUrl:b.Z.wsUrl+"/websocket2/video/open?time="+Date.now(),apiBase:b.Z.baseUrl,token:r.sid,uid:r.uid,tabTitle:e.tabTitle,maxQueueBlobSlice:200,setTimeout:(0,c.fx)()?Cr.$:null,clearTimeout:(0,c.fx)()?Cr.x:null},t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"safeSendMessageToTab",value:(s=Rr(Mr().mark((function t(e,r){var n;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.options.crop,11!==e.action){t.next=9;break}return t.next=4,(0,l.bG)({action:"sendMessageToTab",tabid:r,data:{action:"setup-camera",crop:n||"",deviceId:e.cameraId}});case 4:"err"==t.sent&&(this.isCameraOn=!1,this.refreshStatus()),t.next=10;break;case 9:12===e.action&&(0,l.bG)({action:"sendMessageToTab",tabid:r,data:{action:"stop-camera"}});case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"complete",value:function(){}},{key:"handleAllDataAvailable",value:(u=Rr(Mr().mark((function t(){var r,n,o;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Ur(e,"handleAllDataAvailable",this,3)([]),this.haveEndRecord=!0,"none"===(r=this.processorType)?mo():"upload"===r&&(go(this.videoId),(n=Rn)||(n="stream end"),this.isEmptyData&&(n+=" emptyRecordData"),this.videoId?this.processor instanceof C.Q&&(o=Math.floor(this.recorder.countedDuration/1e3),this.sendClickStop(this.processKey,this.processor,n,o,!1)):this.updateClickStopStatus(n,this.processKey,!1)),a.Z.dispatch("checkBackUp"),a.Z.dispatch("statusChecker");case 7:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"sendClickStop",value:function(t,e,r,n,o){var i=this,a=this;e.httpReportStop(r,n).then((function(e){a.sendStopInfo=!0,i.updateClickStopStatus(r,t,!0)})).catch((function(a){o?i.updateClickStopStatus(r,t,!1):setTimeout((function(){i.sendClickStop(t,e,r,n,!0)}),3e3)}))}},{key:"sendVideoLog",value:function(t,e){var r;this.videoId&&("noRecordData"==t||"noRecordDataFmp4"==t?r="216":"saveBackupFailed"==t&&(r="215"),r&&fetch(b.Z.baseUrl+"/api/v1/video/log",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({videoID:this.videoId,logType:r,info:JSON.stringify(e)})}).then((function(t){return t.json()})).then((function(t){})));"noRecordData"==t?chrome.runtime.sendMessage({action:"googleEvent",name:"empty_record_data",extra:JSON.stringify(e)}):"noRecordDataFmp4"==t?chrome.runtime.sendMessage({action:"googleEvent",name:"empty_record_fmp4_data",extra:JSON.stringify(e)}):"saveBackupFailed"==t&&chrome.runtime.sendMessage({action:"googleEvent",name:"save_backup_failed",extra:JSON.stringify(e)})}},{key:"updateClickStopStatus",value:function(t,e,r){if(e&&this.processorMap.has(e)){var n=this.processorMap.get(e).backup;n&&(r?null==n||n.update({clickStop:"ok",stopFrom:t}):null==n||n.update({clickStop:"failed",stopFrom:t}))}}},{key:"prepareProcessor",value:(i=Rr(Mr().mark((function t(){var e,r,n;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.processorType,r=this.options.payload,t.t0=e,t.next="download"===t.t0?5:"storage"===t.t0?7:"upload"===t.t0?9:"none"===t.t0?11:13;break;case 5:return this.processor=new G,t.abrupt("break",14);case 7:return this.processor=new $({autoGenerateThumbnail:this.autoGenerateThumbnail}),t.abrupt("break",14);case 9:return this.processor=new C.Q(this.processorConfig),t.abrupt("break",14);case 11:return this.processor=new it(this.processorConfig),t.abrupt("break",14);case 13:throw Error("RecorderCompat processorType not supported!");case 14:return this.processor.onConnected=this.handleProcessorConnected.bind(this),this.processor.onError=this.handleProcessorError.bind(this),this.processor.onProgress=this.handleProcessorProgress.bind(this),this.processor.onSuccess=this.handleProcessorSuccess.bind(this),this.processor.onSliceUploaded=this.handleSliceUploaded.bind(this),this.haveEndRecord=!1,this.sendStopInfo=!1,t.next=24,this.processor.ready({title:this.title,payload:r});case 24:return n=t.sent,t.abrupt("return",n);case 27:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"checkEmptyRecordData",value:(o=Rr(Mr().mark((function t(e){var r,n,o,i,a,c,u,s,h,f,p,d;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e>=1e4)||this.haveAlertEmptyData){t.next=41;break}if(!(this.isEmptyFmp4Data&&"output"==this.backupType&&this.reportFmp4Time<5)){t.next=15;break}return t.next=5,navigator.storage.estimate();case 5:r=t.sent,n=r.usage,o=r.quota,(i={msg:"10s no RecordFmp4Data"}).usage=n,i.quota=o,this.sendVideoLog("noRecordDataFmp4",i),this.reportFmp4Time=this.reportFmp4Time+1,t.next=28;break;case 15:if(!(e>=9e4&&this.isEmptyFmp4Data&&"output"==this.backupType)){t.next=28;break}return this.haveAlertEmptyData=!0,(0,l.bG)({action:"windowsCreate",data:{type:"popup",url:"/empty-data-alert.html",left:200,top:200,width:634,height:200,focused:!0}}),t.next=20,navigator.storage.estimate();case 20:a=t.sent,c=a.usage,u=a.quota,(s={msg:"90s no RecordFmp4Data"}).usage=c,s.quota=u,this.sendVideoLog("noRecordDataFmp4",s),this.cancel();case 28:if(!this.isEmptyData){t.next=41;break}return this.haveAlertEmptyData=!0,(0,l.bG)({action:"windowsCreate",data:{type:"popup",url:"/empty-data-alert.html",left:200,top:200,width:634,height:200,focused:!0}}),this.cancel(),t.next=34,navigator.storage.estimate();case 34:h=t.sent,f=h.usage,p=h.quota,(d={msg:"10s no RecordData"}).usage=f,d.quota=p,this.sendVideoLog("noRecordData",d);case 41:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"onStart",value:function(t){this.haveAlertEmptyData=!1,this.reportFmp4Time=0,this.reportEmptyData=0}},{key:"onException",value:(n=Rr(Mr().mark((function t(e,r){var n,o,i,a,c,u,s,l;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("saveFailed"!=e){t.next=13;break}return t.next=4,navigator.storage.estimate();case 4:n=t.sent,o=n.usage,i=n.quota,(a={msg:r}).usage=o,a.quota=i,this.sendVideoLog("saveBackupFailed",a),t.next=24;break;case 13:if(!("emptyBlob"==e&&this.reportEmptyData<22)){t.next=24;break}return t.next=16,navigator.storage.estimate();case 16:c=t.sent,u=c.usage,s=c.quota,(l={msg:r}).usage=u,l.quota=s,this.reportEmptyData++,this.sendVideoLog("noRecordData",l);case 24:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"handleProcessorConnected",value:function(t,r){Ur(e,"handleProcessorConnected",this,3)([t,r])}},{key:"cancelAction",value:(r=Rr(Mr().mark((function t(){var e;return Mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("upload"!=this.processorType||!this.processor){t.next=5;break}return t.next=3,this.processor.cancel();case 3:return t.next=5,null===(e=this.backup)||void 0===e?void 0:e.remove();case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"handleProcessorProgress",value:function(t,r,n){if(Ur(e,"handleProcessorProgress",this,3)([t,r,n]),a.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"}),this.haveEndRecord&&!this.sendStopInfo&&navigator.onLine&&r>.5&&t&&this.processorMap.has(t)){var o=this.processorMap.get(t),i=o.processor,c=o.backup;if(i&&c){var u=c.detail;if(this.sendStopInfo=!0,u&&"failed"===u.clickStop){var s=Math.floor(u.duration/1e3);this.sendClickStop(t,i,u.stopFrom,s)}}}}},{key:"handleProcessorError",value:function(t,r){if(Ur(e,"handleProcessorError",this,3)([t,r]),this.processorMap.has(t)&&"unknown"===r.type){var n=this.processorMap.get(t).backup;null==n||n.update({processStatus:"failed"}),a.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"})}a.Z.dispatch("statusChecker")}},{key:"handleProcessorSuccess",value:function(t,e){var r;if(t==this.processKey&&(this.showStatus===ot.uploading&&(this.showStatus=ot.ready),this.recorderEvent=at.processing_success,this.refreshStatus(),this.recorderEvent=at.null,this.foregroundProcessing&&this.complete()),this.processorMap.has(t)){var n=this.processorMap.get(t).backup;e?null==n||n.update({processStatus:"completed",progress:1,originId:e.vid}):null==n||n.update({processStatus:"completed",progress:1}),a.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"}),this.setTimeout((function(){null==n||n.remove(),a.Z.dispatch("statusChecker")}),400),this.processorMap.delete(t)}else a.Z.dispatch("statusChecker");null===(r=this.singleLine)||void 0===r||r.unregister(t)}},{key:"sendStatusData",value:function(){this.getStatusData()}}]);var r,n,o,i,u,s,h,f}(_r);var Kr=r(98907);function Wr(t){return Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wr(t)}function Hr(){Hr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Wr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Wr(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Yr(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Jr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Yr(i,n,o,a,c,"next",t)}function c(t){Yr(i,n,o,a,c,"throw",t)}a(void 0)}))}}var Qr=null,$r=!1,Xr="",tn=null,en=!1,rn=null,nn=0,on=null,an=[],cn=[],un=null,sn=null,ln=null,hn=!1,fn=18e5,pn=null,dn=!1,vn=!1,yn=!0,mn="init",gn="",bn=0,wn=0,xn=!1,kn="",Sn=null,En=0,Tn=null,On=!1,In=[],jn=!1,Ln="0:00",Pn=null,_n=null,Cn=1,Dn="",Mn="auto-stop-timer",An=0,Rn="",Nn=!1,Gn=!!localStorage.isBrave,Fn=document.createElement("video");Fn.muted=!0;b.Z.baseUrl;function Zn(){return Zn=Jr(Hr().mark((function t(e){var r;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("desktop"!==e||!(0,c.fx)()){t.next=5;break}return t.next=3,(0,h.cF)("showGuide");case 3:r=t.sent,a.Z.dispatch("verifyGuide",!r);case 5:case"end":return t.stop()}}),t)}))),Zn.apply(this,arguments)}function Un(){_.init(),navigator.brave&&navigator.brave.isBrave().then((function(t){Gn=t,localStorage.isBrave=!0})),chrome.runtime.onMessage.addListener((function(t,e,r){var n;if("offscreen"==t.target)switch(t.action){case"checkpin":r("hi");break;case"tests":r("hhh");break;case"record/start":Qr=t.recordOptions,function(t){Zn.apply(this,arguments)}(Xr=Qr.recordType);var o=Qr.recordingTabId;"camera"!==Xr&&(0,l.bG)({action:"insertAction",tabid:o},(function(){(0,l.bG)({action:"sendMessageToTab",tabid:o,data:{action:"insertRecordDiv"}}),"custom"==Xr&&(0,l.bG)({action:"sendMessageToTab",tabid:o,data:{action:"prepareCustom"}})})),"custom"===Xr||(Qr.isShowToolbar&&jo(),Xn(Qr),"camera"!==Xr&&Qr.isRecordCam&&Eo(Qr.camDeviceId,Qr.recordType,!0));break;case"record/stop":xo("recording"!==mn||t.isDiscard),t.from&&(Rn=t.from),r();break;case"record/pause":fo();break;case"record/resume":po();break;case"record/discard":xo(!0);break;case"record/changeMic":var i=t.deviceId;i&&(Qr.micDeviceId=i,n=i,pn&&(pn.turnMicTo("on",n),Io()),qn("mic-deviceId",i));break;case"record/changeCamera":var a=t.deviceId;a&&(Qr.camDeviceId=a,function(t){var e=Qr,r=(e.camDeviceId,e.recordType);So(),Eo(t,r),Io()}(a),qn("cam-deviceId",a));break;case"close-camera":Oo();break;case"hideAnnBar":ko();break;case"embedCameraFailed":(0,l.bG)({action:"openNewTab",data:"/getAccess.html"}),pn&&pn.turnCameraTo("off");break;case"init-camera":!function(){var t=Qr,e=t.recordType,r=t.camDeviceId;"camera"!==e&&(vn||ln?Oo():Eo(r,e))}();break;case"record/getInfo":var c=t.keys;r(function(t){if("string"==typeof t)return eo(t);if(Array.isArray(t))return t.map((function(t){return eo(t)}))}(c));break;case"record/toggleMic":!function(){dn?pn.turnMicTo("off"):pn.turnMicTo("on",Qr.micDeviceId||"default");(0,l.bG)({action:"updateRecordUI"}),uo("updateRecordUI",{audStatus:bn,camStatus:wn})}();break;case"record/toggleToolbar":!function(){var t=Qr,e=t.recordType,r=t.isShowToolbar;"camera"!==e&&(r?ko():jo(gn,Qr.cropObj))}();break;case"autoStop/toggle":!function(t){en=t,t||(timerHour=0,timerMin=0,timerSec=0,_n=0);Qn()}(t.isOn);break;case"autoStop/updateTimer":var u=t.data;!function(t,e,r){rn.timerHour=t,rn.timerMin=e,rn.timerSec=r,en=!0,Qn(),yo()}(u.hour,u.min,u.sec);break;case"autoStop/resetTimer":_n=En;break;case"recordTime":Wn(t.data);break;case"record/startCustom1":var s=t.data;t.ratio;Qr.isShowToolbar&&jo(!1,s),Qr.streamId=t.streamId,Qr.isRecordCam&&(ln?(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"setup-camera",crop:"custom"===Xr?crop:"",deviceId:Qr.camDeviceId}}):Eo(Qr.camDeviceId,"custom")),Xn(Qr,s);break;case"tabUpdated":if(Qr){var h=Qr.isShowToolbar,f=t.tabid;h&&jo(gn,Qr.cropObj),function(t){var e=Qr,r=e.micDeviceId,n=e.camDeviceId,o={audios:an.map((function(t){return{deviceId:t.deviceId,label:t.label}})),cams:cn.map((function(t){return{deviceId:t.deviceId,label:t.label}})),defaultMic:r||"default",defaultCam:n||"default"};(0,l.bG)({action:"sendMessageToTab",tabid:t,data:{action:"devices",data:o}})}(f)}break;case"reloadRecorder":!function(){Vn.apply(this,arguments)}();break;case"checkUploadingRecord":return function(){return zn.apply(this,arguments)}().then((function(t){r(t)})),!0;case"containVideo":var p=t.videoId;return p&&function(t){return Bn.apply(this,arguments)}(p).then((function(t){r(t)})),!0}}))}function Bn(){return(Bn=Jr(Hr().mark((function t(e){var r,n;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Kr.gm)();case 2:if(r=t.sent,n=!1,!(r.length>0)){t.next=9;break}return r.forEach((function(t){t.originId==e&&(n=!0)})),t.abrupt("return",n);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function zn(){return(zn=Jr(Hr().mark((function t(){var e,r,n;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Kr.gm)();case 2:if(e=t.sent,r=Date.now(),n={unfinished:!1,tookLongtime:!1,afterOneMinute:!1,isBeginRecorded:$r},!(e.length>0)){t.next=13;break}return n.unfinished=!0,e.forEach((function(t){r-t.closeAt>fn&&(n.tookLongtime=!0),r-t.closeAt>6e4&&(n.afterOneMinute=!0)})),t.abrupt("return",n);case 13:return t.abrupt("return",n);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Vn(){return(Vn=Jr(Hr().mark((function t(){return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,pn.cancelAction();case 2:location.reload();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function qn(t,e){return Kn.apply(this,arguments)}function Kn(){return(Kn=Jr(Hr().mark((function t(e,r){var n;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e&&r&&((n={})[e]=r,(0,l.bG)({action:"updateStorage",type:"options",data:n}));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wn(t){Ln=t,(0,l.bG)({action:"setBadge",type:"text",data:Ln}),a.Z.dispatch("timeUpdated",Ln),uo("updateRecordTime",Ln)}function Hn(t,e){var r=!1;t!==vn&&(vn=t,r=!0,wn=t?2:cn.length>0?1:3),e!==dn&&(dn=e,r=!0,bn=e?2:an.length>0?1:3),r&&((0,l.bG)({action:"updateRecordUI"}),uo("updateRecordUI",{audStatus:bn,camStatus:wn}))}function Yn(t,e){yn=!t.videoFormat||"mp4"!=t.videoFormat,pn||((pn=globalThis.window?new qr({backupStrategy:"upload",mimeTypes:[wo()],timeSlice:500,noFragmentedMp4:!0,pipCameraAspectRatio:1.78,setTimeout:(0,c.fx)()?Cr.$:null,clearTimeout:(0,c.fx)()?Cr.x:null,foregroundProcessing:!1,mediaSources:["screen","window","audio"]}):null).onCatch=function(t,e){"cancelShareScreen"===t||("startFailed"===t?(!function(t){var e,r;t&&("NotAllowedError"===t.name?/Permission denied by system/.test(t)?(e="mac",/Mac OS/.test(window.navigator.userAgent)||(e="win"),/\[Mic\]/.test(t)?r="mic":"camera"===Qr.recordType&&(r="camera")):/Could not start audio source/.test(t)&&(e="win",r="mic"):"NotReadableError"===t.name&&(e="mac",r="browser_issue",/Mac OS/.test(window.navigator.userAgent)||(e="win",r="mic")));if(e){var n="/permission-denied.html?os="+e;r&&(n+="&type="+r),(0,l.bG)({action:"openNewTab",data:n})}}(e),io()):"cameraUnavailable"===t&&((0,l.bG)({action:"openNewTab",data:"/getAccess.html"}),vn=!1))},pn.showTimer=function(t){t.length>2&&(Wn(t),yo())}),pn.ready({recordType:"custom"===t.recordType?"tab":t.recordType,microphone:{deviceId:t.micDeviceId,open:t.isRecordMic},camera:{deviceId:t.camDeviceId,open:t.isRecordCam},crop:e||"",quality:{equivalent:"4k"==t.resolution?"4k":t.resolution+"p"},tabId:t.recordingTabId,streamId:t.streamId,processorType:"local"===t.saveLocation?"none":"upload",countdown:1e3*parseInt(Qr.countdown),tabAudio:t.isRecordTabSound,title:t.recordingTabTitle,payload:{videoCodec:yn?p.videoCodec:d.videoCodec,tabUrl:t.recordingTabUrl,tabTitle:t.recordingTabTitle,appAndPlatform:ro(),recordType:t.recordType,recorderVersion:t.recorderVersion,appVersion:navigator.userAgent,screenSize:t.screenWidth+"*"+t.screenHeight}}),pn.onStatusChange=function(){var t=Jr(Hr().mark((function t(e){var r,n,o,i,u,s,h,f,p,d,v,y,m,b,w,x;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.showStatus,a.Z.dispatch("uploadingUpdate"),(0,l.bG)({action:"uploadingUpdate",target:"backupList"}),1===r?e.recorderEvent==at.stop?(setTimeout((function(){oo()}),100),a.Z.dispatch("statusChecker")):e.recorderEvent!=at.cancel&&e.recorderEvent!==at.abort_cancel||(Tn&&Tn.saveName&&g.Z.remove(Tn.saveName),Tn&&Tn.info&&_.delete(Tn.info.id),kn&&(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"stop-countdown"}}),a.Z.dispatch("discardAction",pn.backupKey),a.Z.dispatch("statusChecker"),oo(),o=(n=Qr).recordType,i=n.recordBgTabId,u=n.mainWinId,s=n.recordBgWinId,"desktop"===o&&(0,c.fx)()&&I(i,u,s),(0,l.bG)({action:"uploadingUpdate",target:"backupList"})):3===r?(Wn(Ln),Hn(e.isCameraOn,e.isMicOn),ao("recording")):4===r?Hn(e.isCameraOn,e.isMicOn):5===r?(f=(h=Qr).recordType,p=h.recordBgTabId,d=h.mainWinId,v=h.recordBgWinId,"desktop"===f&&(0,c.fx)()&&I(p,d,v)):6===r&&(m=(y=Qr).recordType,b=y.recordBgTabId,w=y.mainWinId,x=y.recordBgWinId,"desktop"===m&&(0,c.fx)()&&I(b,w,x),to(),(0,l.bG)({action:"prepare-recording"}),Qn(),Jn(),io(),a.Z.dispatch("statusChecker"));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),pn.onDataAvailable=function(e){"local"===t.saveLocation&&function(t){ho.apply(this,arguments)}(e.data)}}function Jn(){var t=pn.getTask("norm-task");t||(t={id:"norm-task",init:function(){},generate:function(t,e){return function(t){var e=Qr,r=e.isSaveLocal,n=e.saveLocation;Gn||navigator.storage.estimate().then((function(t){var e=t.quota-t.usage;if(!isNaN(e)&&e<v*m){pn.updateStorageAlert(!0),xo();var r=window.screen.width,n=window.screen.height,o=(r-400)/2,i=(n-380)/2;setTimeout((function(){(0,l.bG)({action:"windowsCreate",data:{type:"popup",url:"/storage-alert.html",left:o||200,top:i||200,width:500,height:470,focused:!0}})}),2e3)}else!isNaN(e)&&e<v*y&&!Nn&&(pn.updateStorageAlert(!0),Nn=!0)}));var o=pn.getTask(Mn);"cloud"!==n||r||o||(0,l.bG)({action:"getPremiumLevel"},(function(e){var r=e?144e5:108e5;t>=Cn*r&&t<=Cn*r+100&&((0,l.bG)({action:"windowsCreate",data:{type:"popup",url:"/notification.html",left:0,top:0,width:300,height:400,focused:!0}}),Cn++)}));pn.checkEmptyRecordData(t),t>=301e3&&(0,l.bG)({action:"getStorage",type:"userinfo"},(function(t){t.userinfo?"local"===n||r?t.userinfo.premiumLevel<2&&(1===t.userinfo.premiumLevel&&0===t.userinfo.newPremium||xo()):t.userinfo.videoTotalLimitation>=t.userinfo.videoLimitation&&t.userinfo.premiumLevel<2&&(Rn="5mins_stop",xo()):xo()}));t>=216e5&&(Rn="6hours",xo())}(e),En=e,!1}},pn.setTask(t))}function Qn(){var t=pn.getTask(Mn);if(en&&rn.timerHour+rn.timerMin+rn.timerSec>0){var e=En,r=1e3*(rn.timerSec+60*rn.timerMin+3600*rn.timerHour)+(e||0);An=r+100,t?t.duration=An:pn.setTask({id:Mn,action:"stop",duration:An})}else t&&pn.removeTask(Mn)}function $n(){return Qr?Qr.saveLocation:"local"}function Xn(t,e){Tn=null,On=!1,jn=!1,In=[],Ln="0:00",Rn="",Qr=t,Yn(t,e),Qr.isSaveLocal="local"===t.saveLocation,kn=Qr.recordingTabId,e&&(tn=e,Qr.cropObj=e),$r=!0,(0,l.bG)({action:"keepAwake"}),(0,l.bG)({action:"updateContextMenu",isBeginRecorded:$r}),en=t.isAutoStop,rn={timerHour:t.autoStopHour,timerMin:t.autoStopMin,timerSec:t.autoStopSec},nn=parseInt(Qr.countdown),s().then((function(t){var e,r,n,o;an=t.availableAudioDevices,cn=t.availableVideoDevices,r=(e=Qr).micDeviceId,n=e.camDeviceId,o={audios:an.map((function(t){return{deviceId:t.deviceId,label:t.label}})),cams:cn.map((function(t){return{deviceId:t.deviceId,label:t.label}})),defaultMic:r||"default",defaultCam:n||"default"},(0,l.bG)({action:"broadCastMessage",data:{action:"devices",data:o}})})),ao("preparing")}function to(){var t=Qr.countdown;(0,l.bG)({action:"setBadge",type:"color",data:f}),t>0?kn&&"camera"!==Xr?(0,l.bG)({action:"insertAction",tabid:kn},(function(){(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"startCountDown",countdown:parseInt(t)}}),co()})):co():no()}function eo(t){switch(t){case"time":return Ln;case"isInCountdown":return hn;case"isPaused":return xn;case"socketClient":return Pn;case"autoTimerInfo":return rn;case"isAutoTimerStop":return en;case"recordTimeLength":return En;case"startAutoStop":return _n;case"countdown":return nn;case"cameraStream":return vn||!!ln;case"audioStream":return dn;case"isShowToolbar":return Qr.isShowToolbar;case"isBeginRecorded":return $r;case"recordingStatus":return mn;case"autoStopTime":return Dn;case"devicesInfo":return{audioDevices:an.length,videoDevices:cn.length}}}function ro(){return/Edg/.test(navigator.userAgent)?"Edge extension":"Chrome extension"}function no(){uo("done_start"),(0,l.bG)({action:"start-recording"}),gn=!0,ao("recording"),(new Date).getTime()}function oo(){var t=Qr.isShowToolbar;kn&&((0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"removeRecordDiv"}}),(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"endSelect"}})),(0,l.bG)({action:"stop-recording",data:!0}),(0,l.bG)({action:"setRecordDefault"}),un&&(un.getTracks().forEach((function(t){t.stop()})),un.onended&&un.onended()),Ln="0:00",(0,l.bG)({action:"updateContextMenu",isBeginRecorded:!1}),t&&ko(),vn=!1,dn=!1,Nn=!1,localStorage.alertStorage="0",(0,l.bG)({action:"releaseKeepAwake"}),sn&&sn.stop(),ln&&So(),on&&(clearInterval(on),on=null),$r=!1,pn=null,un=null,sn=null,ln=null,gn=!1,ao("init"),xn=!1,Cn=1,nn=0,hn=!1,Sn&&(clearInterval(Sn),Sn=null),kn="",bn=1,wn=1,(0,l.bG)({action:"setBadge",type:"text",data:""}),_n=0,En=0,en=!1,Dn=""}function io(){(0,l.bG)({action:"updateStorage",type:"options",data:{"auto-timer-stop":!1,"auto-hour":0,"auto-min":0,"auto-sec":0}})}function ao(t){mn=t,(0,l.bG)({action:"saveStorage",type:"recordingStatus",data:t}),a.Z.dispatch("statusChange",t),(0,l.bG)({action:"updateRecordStatus",target:"backupList",data:t}).catch((function(){}))}function co(){hn=!0,ao("countdown"),(0,l.bG)({action:"setBadge",type:"text",data:nn+""}),a.Z.dispatch("countdownChange",nn),on=setInterval((function(){if(1===nn)return clearInterval(on),(0,l.bG)({action:"setBadge",type:"text",data:"0:00"}),nn=0,void no();nn>=1?(nn--,(0,l.bG)({action:"setBadge",type:"text",data:nn+""}),a.Z.dispatch("countdownChange",nn)):clearInterval(on)}),990)}function uo(t,e){var r=Qr.recordType;"desktop"===r?(0,l.bG)({action:"broadCastMessage",data:{action:t,data:e}}):"tab"!==r&&"custom"!==r||kn&&(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:t,data:e}})}function so(t,e){var r=Qr.recordType;return new Promise((function(n){On&&n(),Tn={size:0};var o=function(t){if("desktop"===t||"tab"===t||"custom"===t)return Qr.recordingTabTitle;if("camera"===t){var e=new Date;return"Camera-"+(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getHours()+"-"+e.getMinutes()+"-"+e.getSeconds())}}(r),i=function(t){if("desktop"===t)var e="Desktop";else if("tab"===t||"custom"===t)e="Tab";else if("camera"===t)e="Camera";return e+"-"+(new Date).getTime()}(r);g.Z.save(t,i).then((function(r){return _.save({fileUrl:r,title:o,size:(0,c.RD)(t.size),duration:e,recordType:Qr.recordType,codecs:yn?p.videoCodec:d.videoCodec})})).then((function(e){Tn.saveName=i,Tn.info=e,Tn.size=t.size,On=!0,jn=!1,n()}))}))}function lo(){for(jn=!0;In.length>0&&Tn;){var t=In.shift();g.Z.append(t,Tn.saveName);var e=Tn.info;e.detail&&(Tn.size+=t.size,e.detail.size=(0,c.RD)(Tn.size),"0:00"!=Ln&&(e.detail.duration=Ln),_.update(e.id,Tn.info))}jn=!1}function ho(){return(ho=Jr(Hr().mark((function t(e){return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Qr.recordType,e&&(Tn?(In.push(e),On&&!jn&&lo()):so(e,Ln).then((function(){jn||lo()})));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function fo(t,e){var r=Qr,n=r.recordType;r.isShowToolbar,r.saveLocation,r.isSaveLocal;xn||(pn.pause(),xn=!0,vo(!0),"camera"===n&&(0,l.bG)({action:"pause-recording"}),a.Z.dispatch("togglePaused",!0))}function po(){pn.resume(),xn=!1,vo(!1),a.Z.dispatch("togglePaused",!1)}function vo(t){var e=Qr,r=e.recordType,n=e.isShowToolbar;t?n&&("tab"===r||"custom"===r?kn&&(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"pause"}}):"desktop"===r?(0,l.bG)({action:"broadCastMessage",data:{action:"pause"}}):"camera"===r&&(0,l.bG)({action:"pause-recording"})):n&&("tab"===r||"custom"===r?(0,l.bG)({action:"sendMessageToTab",tabid:kn,data:{action:"resume"}}):"desktop"===r?(0,l.bG)({action:"broadCastMessage",data:{action:"resume"}}):"camera"===r&&(0,l.bG)({action:"resume-recording"}))}function yo(){var t=rn,e=t.timerHour,r=t.timerMin,n=t.timerSec;if(en&&e+r+n>0){pn.getStatusData();var o=0;An-200>=En&&(o=An-En-200),o=Math.floor(o/1e3);var i=Math.floor(o/3600),a=Math.floor((o-3600*i)/60),c=o%60;c<10&&(c="0"+c),Dn=(i>0?i+":":"")+(i>0&&0==a?"00":a)+":"+c}}function mo(){setTimeout((function(){Tn&&Tn.info&&Tn.info.id&&(0,l.bG)({action:"openNewTab",data:"/video-react.html?id="+Tn.info.id})}),250),oo(),chrome.storage&&(0,h.Ot)("showGuide",!0)}function go(t){return bo.apply(this,arguments)}function bo(){return(bo=Jr(Hr().mark((function t(e){var r;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}(0,l.bG)({action:"openNewTab",data:b.Z.baseUrl+"/video/"+e}),t.next=12;break;case 4:if(!chrome.storage){t.next=11;break}return t.next=7,(0,h.cF)("recordTab");case 7:(r=t.sent)&&chrome.tabs.update(r,{pinned:!0,highlighted:!0}),t.next=12;break;case 11:(0,l.bG)({action:"openNewTab",data:"/backup-list.html"});case 12:chrome.storage&&(0,h.Ot)("showGuide",!0),oo();case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wo(){return yn?p.mimeType:d.mimeType}function xo(t,e){t?pn.cancel():pn.safeStop(),e&&(Rn=e)}function ko(){Qr.isShowToolbar;uo("remove-toolbar",{}),Qr.isShowToolbar=!1,(0,l.bG)({action:"updateRecordUI"})}function So(t){ln&&(ln.id&&ln.getTracks().forEach((function(e){e.stop(),t&&t()})),ln=null,Fn.srcObject=null,(0,l.bG)({action:"updateRecordUI"}),uo("updateRecordUI",{audStatus:bn,camStatus:wn=1}))}function Eo(t,e,r){return To.apply(this,arguments)}function To(){return To=Jr(Hr().mark((function t(e,r,n){var o,i,a;return Hr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"tab"===r||"custom"===r?(i=(o=Qr).recordingTabId,a=o.camDeviceId,n?((0,l.bG)({action:"sendMessageToTab",tabid:i,data:{action:"setup-camera",crop:"custom"===r?tn:"",deviceId:a}}),ln=!0):pn.turnCameraTo("on",e||"default")):pn.turnCameraTo("on",e||"default"),n&&uo("updateRecordUI",{audStatus:bn,camStatus:wn});case 2:case"end":return t.stop()}}),t)}))),To.apply(this,arguments)}function Oo(){var t=Qr,e=t.recordType,r=t.recordingTabId;"tab"===e||"custom"===e?(0,l.bG)({action:"sendMessageToTab",tabid:r,data:{action:"stop-camera"}}):(0,l.bG)({action:"stop-camera"}),So(),pn&&pn.turnCameraTo("off")}function Io(){var t=Qr,e=t.micDeviceId,r=t.camDeviceId;uo("defaultDevice",{defaultMic:e||"default",defaultCam:r||"default"})}function jo(t,e){var r=Qr,n=r.recordType,o=r.recordingTabId;r.isShowToolbar;"tab"===n||"custom"===n?(0,l.bG)({action:"insertContent",tabid:o,data:{action:"setup-toolbar",isRecorded:t,crop:"custom"===n?e:"",audStatus:bn,camStatus:wn,recordTime:Ln,isPaused:xn}}):"desktop"===n&&(0,l.bG)({action:"insertAllContent",data:{action:"setup-toolbar",isRecorded:t,audStatus:bn,camStatus:wn,recordTime:Ln,isPaused:xn}}),Qr.isShowToolbar=!0,(0,l.bG)({action:"updateRecordUI"})}_.init(),chrome.runtime.connect({name:"record"}).onMessage.addListener((function(t){t.action}));var Lo=r(58801);function Po(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const Co=function(){var t=Po((0,o.useState)(0),2),e=t[0],r=t[1],n=!1;function i(t){n&&r(t)}return(0,o.useEffect)((function(){a.Z.on("countdownChange",i),n=!0}),[]),(0,Lo.jsxs)("div",{className:"countdown-panel",children:[(0,Lo.jsx)("div",{className:"cd-tip",children:"Recording will start in"}),(0,Lo.jsx)("div",{className:"cd-text",children:e})]})};r(54446);var Do=r(74193),Mo=r(29185);const Ao=function(t){var e=t.time,r=t.isPaused,n=t.handlePause,o=t.handleResume,i=t.handleDiscard,a=t.handleStop;return(0,Lo.jsxs)("div",{className:"record-panel ".concat(r?"paused":""),children:[(0,Lo.jsx)("div",{className:"recording-status",children:(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("div",{className:"recording-icon ".concat(r?"paused":"")}),r?"Paused":"Recording"]})}),(0,Lo.jsx)("div",{className:"time",children:e}),(0,Lo.jsxs)("div",{className:"btn-area",children:[(0,Lo.jsx)("div",{className:"record-action-btn tiny",onClick:function(){Do.Z.confirm({title:chrome.i18n.getMessage("warning"),content:chrome.i18n.getMessage("discard_p"),okText:chrome.i18n.getMessage("discard_p_yes"),cancelText:chrome.i18n.getMessage("discard_p_no"),onOk:i,okType:"danger"})},children:(0,Lo.jsx)(Mo.GR,{})}),(0,Lo.jsxs)("div",{className:"actions",children:[r?(0,Lo.jsx)("div",{className:"record-action-btn tiny",onClick:o,children:(0,Lo.jsx)(Mo.a6,{})}):(0,Lo.jsx)("div",{className:"record-action-btn tiny",onClick:n,children:(0,Lo.jsx)(Mo.HC,{})}),(0,Lo.jsxs)("div",{className:"record-action-btn stop",onClick:a,children:[(0,Lo.jsx)(Mo.UB,{}),"Stop"]})]})]})]})};function Ro(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return No(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?No(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function No(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}const Go=function(t){t.status;var e=Ro((0,o.useState)("00:00"),2),r=e[0],n=e[1],i=Ro((0,o.useState)(!1),2),c=i[0],u=i[1],s=!1;function l(t){s&&u(t)}function h(t){s&&n(t)}return(0,o.useEffect)((function(){return a.Z.on("timeUpdated",h),a.Z.on("togglePaused",l),s=!0,function(){a.Z.remove("timeUpdated",h),a.Z.remove("togglePaused",l)}}),[]),(0,Lo.jsx)(Ao,{time:r,isPaused:c,handlePause:function(){fo()},handleResume:function(){po()},handleDiscard:function(){xo(!0)},handleStop:function(){xo(!1,"pinTab")}})};var Fo=r(8496),Zo=r(23689);const Uo=function(t){var e=t.showGuide,r=t.isWindows;return(0,Lo.jsxs)("div",{className:"guide-container ".concat(e?"show":""),children:[(0,Lo.jsxs)("div",{className:"bubble left-top",children:[(0,Lo.jsx)("div",{className:"guide-title",children:"Step 1"}),(0,Lo.jsx)("div",{className:"guide-msg",children:"Click to select the screen under entir screen"})]}),r?(0,Lo.jsxs)("div",{className:"bubble left-bottom",children:[(0,Lo.jsx)("div",{className:"guide-title",children:"Step 2"}),(0,Lo.jsx)("div",{className:"guide-msg",children:"Check the system sound"})]}):(0,Lo.jsx)(Lo.Fragment,{}),(0,Lo.jsxs)("div",{className:"bubble right-bottom ".concat(r?"windows":""),children:[(0,Lo.jsx)("div",{className:"guide-title",children:r?"Step 3":"Step 2"}),(0,Lo.jsx)("div",{className:"guide-msg",children:"Click the Share button to start recording."}),(0,Lo.jsx)(Mo.m2,{})]})]})};function Bo(t){return Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bo(t)}function zo(t){return Qo(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Yo(t)||Ho()}function Vo(){Vo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function m(){}function g(){}function b(){}var w={};s(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(_([])));k&&k!==r&&n.call(k,a)&&(w=k);var S=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function r(o,i,a,c){var u=h(t[o],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==Bo(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=f;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=I(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=h(e,r,n);if("normal"===s.type){if(o=n.done?v:p,s.arg===y)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function I(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function _(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Bo(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},E(T.prototype),s(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new T(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(S),s(S,u,"Generator"),s(S,a,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function qo(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Ko(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){qo(i,n,o,a,c,"next",t)}function c(t){qo(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Wo(t,e){return Qo(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],u=!0,s=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||Yo(t,e)||Ho()}function Ho(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yo(t,e){if(t){if("string"==typeof t)return Jo(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jo(t,e):void 0}}function Jo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Qo(t){if(Array.isArray(t))return t}if(window){var $o=document.createElement("script");$o.src="./mp4_muxer.js",document.head.appendChild($o),window.Module={},window.Module.inited=!1,window.Module.onRuntimeInitialized=function(){window.Module.inited=!0}}const Xo=function(){var t=Wo((0,o.useState)("init"),2),e=t[0],r=t[1],n=Wo((0,o.useState)([]),2),u=n[0],s=n[1],l=Wo((0,o.useState)(0),2),h=l[0],f=l[1],p=Wo((0,o.useState)(!1),2),d=p[0],v=p[1],y=Wo((0,o.useState)(!0),2),m=y[0],g=y[1],b=Wo((0,o.useState)(!1),2),w=b[0],x=b[1],k=Wo((0,o.useState)(5),2),S=k[0],E=k[1],T=Wo((0,o.useState)(!1),2),O=T[0],I=T[1],j=null,L=(0,o.createRef)();L.current=u;var P=5,_=(0,o.createRef)();_.current=e;var C=0;(0,o.useEffect)((function(){return Un(),a.Z.on("statusChange",F),a.Z.on("uploadingUpdate",K),a.Z.on("statusChecker",Z),a.Z.on("verifyGuide",G),a.Z.on("discardAction",N),a.Z.on("checkBackUp",A),document.title="Recorder",g(navigator.onLine),setTimeout((function(){R(!0)}),400),(0,c.fx)()&&(window.onbeforeunload=D,K()),(0,c.fx)()&&document.addEventListener("visibilitychange",Ko(Vo().mark((function t(){var e;return Vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,chrome.tabs.getCurrent();case 3:if(t.sent,"visible"!==document.visibilityState){t.next=12;break}return t.next=8,chrome.tabs.getCurrent();case 8:(e=t.sent)&&e.pinned&&(R(!0),K()),B();case 12:case"end":return t.stop()}}),t)})))),window.addEventListener("offline",(function(t){g(!1),M(!1)})),window.addEventListener("online",(function(t){g(!0),M(!0)})),window.navigator.connection.onchange=M,B(),chrome.runtime.onMessage.addListener((function(t,e,r){if("Recorder"==t.target)switch(t.action){case"reUpload":var n=t.data;n&&(0,Kr.ws)("",n);break;case"removeBackup":t.data}})),function(){window.onbeforeunload=null}}),[]);var D=function(t){("init"!==e||L.current.length>0)&&(t.returnValue="changes you made may not be saved.")};function M(t){var e=window.navigator.connection.downlink;navigator.onLine?(x(e<.15),e>.001&&R(t)):x(!0)}function A(){R(!0)}function R(t){var e=(new Date).getTime();e-C>7e4&&navigator.onLine&&t&&!t.type&&(C=e,(0,Kr.Os)())}function N(t){if(L.current.length>0&&t>=0){var e=L.current.find((function(e){return e.key===t}));if(e){var r=L.current.indexOf(e);L.current.splice(r,1);var n=zo(L.current).slice(0);s(n),L.current=n}}}function G(t){v(t)}function F(t){r(t),_.current=t,Z(),K(),"preparing"!==t&&v(!1),"init"!==t?I(!1):B()}function Z(){return U.apply(this,arguments)}function U(){return(U=Ko(Vo().mark((function t(){return Vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Kr.RC)();case 2:if(0==t.sent.length?chrome.runtime.sendMessage({action:"offScreenStatus",data:!1}):chrome.runtime.sendMessage({action:"offScreenStatus",data:!0}),!(0,c.fx)()){t.next=9;break}return t.next=7,(0,Kr.ip)();case 7:0==t.sent.length&&"init"===e&&B();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function B(){return z.apply(this,arguments)}function z(){return(z=Ko(Vo().mark((function t(){var e;return Vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,c.fx)()){t.next=9;break}return t.next=4,chrome.tabs.getCurrent();case 4:return e=t.sent,t.next=7,(0,Kr.ip)();case 7:0==t.sent&&"init"===_.current?(I(!0),e.highlighted?null===j?(E(P=5),j=setInterval((function(){V()}),1e3)):(E(P=5),clearInterval(j),j=setInterval((function(){V()}),1e3)):(j&&clearInterval(j),j=null,P<3&&(P=3),E(P),j=setInterval(Ko(Vo().mark((function t(){return Vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:V();case 1:case"end":return t.stop()}}),t)}))),1e3))):j&&(I(!1),E(P=5),clearInterval(j),j=null);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function V(){return q.apply(this,arguments)}function q(){return(q=Ko(Vo().mark((function t(){var e,r;return Vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(P--,E(P),!(P<=0)){t.next=13;break}if(clearInterval(j),!(0,c.fx)()){t.next=13;break}return t.next=8,chrome.tabs.getCurrent();case 8:return e=t.sent,t.next=11,(0,Kr.ip)();case 11:r=t.sent,e&&e.pinned&&(0,c.fx)()&&"init"===_.current&&0==r.length&&(L.current=[],j=null,window.close());case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function K(){return W.apply(this,arguments)}function W(){return(W=Ko(Vo().mark((function t(){var e;return Vo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,Kr.ip)();case 2:(e=t.sent).length>0&&Date.now()-h>100&&(e.sort((function(t,e){return e.createAt-t.createAt})),f(Date.now()),s(e),L.current=e);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var H="init"===e&&u.length>0?"uploading":e,Y=navigator.userAgent.indexOf("Windows")+navigator.userAgent.indexOf("CrOS")>0,J="cloud"===$n;return(0,Lo.jsx)("div",{className:"record-bg",children:e?(0,Lo.jsxs)(Lo.Fragment,{children:[(0,Lo.jsx)("div",{className:"logo"}),("recording"===e||"uploading"===H||O)&&(0,Lo.jsx)("div",{className:"tip "+(O?"close":""),children:(0,Lo.jsxs)("div",{className:"alert-content "+(O?"close":""),children:[(0,Lo.jsx)(Mo.ZE,{}),O?"Your videos have been uploaded successfully. This tab will automatically close in ".concat(S," seconds."):"uploading"===H?"Please keep this page open while uploading to avoid upload failure.":"Please DO NOT close this page while recording. It will cause the recording to fail."]})}),(0,Lo.jsxs)("div",{className:"center-box",children:[(0,Lo.jsxs)(i.r,{test:H,children:[(0,Lo.jsx)(i.J,{value:"init",children:(0,Lo.jsxs)("div",{className:"empty-box",children:[(0,Lo.jsx)(Mo.c8,{}),(0,Lo.jsx)("div",{className:"tips",children:"All Videos Uploaded "}),(0,Lo.jsxs)("div",{children:["You can check your videos in"," ",(0,Lo.jsx)("a",{href:"https://www.awesomescreenshot.com/my_items",target:"_blank",children:"My Items"}),"."]})]})}),(0,Lo.jsx)(i.J,{value:"countdown",children:(0,Lo.jsx)(Co,{})}),(0,Lo.jsx)(i.J,{value:"preparing",children:J?(0,Lo.jsxs)("div",{class:"video-prepare-view",children:[(0,Lo.jsxs)("div",{class:"loading",children:[(0,Lo.jsx)("div",{class:"double-bounce1"}),(0,Lo.jsx)("div",{class:"double-bounce2"})]}),(0,Lo.jsx)("div",{class:"prepare-tip",children:"Connecting to the server"})]}):(0,Lo.jsx)(Lo.Fragment,{})}),(0,Lo.jsx)(i.J,{value:"recording",children:(0,Lo.jsx)(Go,{status:e})}),(0,Lo.jsx)(i.J,{value:"uploading",children:(0,Lo.jsxs)(Lo.Fragment,{children:[m?(0,Lo.jsx)(Lo.Fragment,{}):(0,Lo.jsxs)("div",{className:"network-warning",children:[(0,Lo.jsx)(Mo.ZE,{}),"Network Disconnect"]}),(0,Lo.jsx)(Zo.Z,{lists:u,poorNetWork:w,isRecorder:!0})]})})]}),"uploading"===H?(0,Lo.jsxs)("div",{className:"footer",children:[(0,Lo.jsx)(Mo.gD,{})," You can check your uploaded videos in"," ",(0,Lo.jsx)("a",{href:"https://www.awesomescreenshot.com/all_videos",target:"_blank",children:'"My videos"'}),"."]}):(0,Lo.jsx)(Lo.Fragment,{})]}),(0,Lo.jsx)(Uo,{showGuide:d,isWindows:Y})]}):(0,Lo.jsx)(Lo.Fragment,{children:(0,Lo.jsx)("div",{className:"loading",children:(0,Lo.jsx)(Fo.Z,{size:"large"})})})})};n.render((0,Lo.jsx)(Xo,{}),document.getElementById("app"))},98907:(t,e,r)=>{r.d(e,{Os:()=>w,RC:()=>T,gm:()=>L,ip:()=>I,ws:()=>k});var n=r(45468),o=r(42097),i=r(38756),a=r(6722),c=r(780),u=r(94988),s=r(33534);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=l(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==l(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(){d=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:j(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var p="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};s(k,a,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(D([])));E&&E!==r&&n.call(E,a)&&(k=E);var T=x.prototype=b.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function r(o,i,a,c){var u=f(t[o],t,i);if("throw"!==u.type){var s=u.arg,h=s.value;return h&&"object"==l(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=L(c,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var s=f(e,r,n);if("normal"===s.type){if(o=n.done?m:v,s.arg===g)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=m,n.method="throw",n.arg=s.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(l(e)+" is not iterable")}return w.prototype=x,o(T,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=s(x,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,s(t,u,"GeneratorFunction")),t.prototype=Object.create(T),t},e.awrap=function(t){return{__await:t}},O(I.prototype),s(I.prototype,c,(function(){return this})),e.AsyncIterator=I,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new I(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(T),s(T,u,"Generator"),s(T,a,(function(){return this})),s(T,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function v(t,e,r,n,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function y(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){v(i,n,o,a,c,"next",t)}function c(t){v(i,n,o,a,c,"throw",t)}a(void 0)}))}}var m=2e4;function g(){return b.apply(this,arguments)}function b(){return(b=y(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.runtime.sendMessage({action:"getUID"},(function(e){t(e)}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(){return x.apply(this,arguments)}function x(){return(x=y(d().mark((function t(){var e,r,i,a,c,u,s,l,h,v;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=new n.Z,r=new o.u,i=Date.now()+"",r.register(i),c=!1,s=function(){u()},l=function(t){},h=function(){u()},v=d().mark((function t(){var n,o,v,y,g,b;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Date.now(),t.next=3,e.getAllDetail();case 3:return(o=t.sent).filter((function(t){return"created"===t.status&&n-t.updateAt>10*m})).forEach((function(t){return e.update(f(f({},t),{},{processStatus:"failed"}),t.key)})),o.filter((function(t){return"created"===t.status&&"failed"===t.processStatus&&n-t.updateAt>10*m})).forEach((function(t){return e.remove(t.key)})),v=o.filter((function(t){return!["created"].includes(t.status)&&"fmp4"===t.storeName})),y=v.map((function(t){return t.processKey})),t.next=10,r.queryOutageKeys(y);case 10:if(g=t.sent,b=v.filter((function(t){return g.includes(t.processKey)})),a=b.find((function(t){return"failed"!==t.processStatus})),b&&b.length>0&&b.reduce((function(t,e){return f(f({},t),{},p({},e.key,f(f({},e),{},{external:!0})))}),{}),a){t.next=19;break}return c=!0,t.abrupt("return",1);case 19:return k(i,a.key,s,l,h),t.next=24,new Promise((function(t){u=t}));case 24:case"end":return t.stop()}}),t)}));case 10:if(c){t.next=16;break}return t.delegateYield(v(),"t0",12);case 12:if(!t.t0){t.next=14;break}return t.abrupt("break",16);case 14:t.next=10;break;case 16:r.unregister(i);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function k(t,e,r,n,o){return S.apply(this,arguments)}function S(){return S=y(d().mark((function t(e,r,l,h,p){var v,m,b,w,x,k,S,T,O,I,j,L,P,_,C,D,M,A;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A=function(){if(w&&x&&!k&&(k=!0,L.stop({duration:m.duration,size:m.size}),"ok"!==m.clickStop)){var t=Math.floor(m.duration/1e3);L.httpReportStop(m.stopFrom,t).then((function(){v&&v.update({clickStop:""},r)}))}},v=new n.Z,t.next=4,v.getDetail(r);case 4:if((!(m=t.sent)||"completed"!=m.processStatus)&&m){t.next=9;break}return p&&p(),t.abrupt("return");case 9:return t.next=11,g();case 11:if(!(b=t.sent)||b.sid){t.next=14;break}return t.abrupt("return");case 14:if(w=!1,x=!1,k=!1,S=!1,T=0,j=!0,!(e&&e.length>1)){t.next=26;break}return t.next=24,v.update({processKey:e},r);case 24:t.next=33;break;case 26:return j=!1,O=new o.u,I=Date.now()+"",O.register(I),e=I,t.next=33,v.update({processKey:I},r);case 33:if((L=new i.Q({wsUrl:a.Z.wsUrl+"/websocket2/video/open?time="+Date.now(),apiBase:a.Z.baseUrl,token:b.sid,uid:b.uid,sid:m.sid,maxQueueBlobSlice:200,setTimeout:(0,s.fx)()?u.$:null,clearTimeout:(0,s.fx)()?u.x:null})).onError=function(){var t=y(d().mark((function t(e,n){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!v){t.next=8;break}if(!n||"unknown"!==n.type){t.next=4;break}return t.next=4,v.update({processStatus:"failed"},r);case 4:c.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"}),l&&l();case 8:O&&I&&O.unregister(I);case 9:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),L.onProgress=function(){var t=y(d().mark((function t(e,n){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!v||S){t.next=8;break}if(n>1&&(n=1),!(Date.now()-T>100)){t.next=8;break}return T=Date.now(),t.next=6,v.update({progress:n},r);case 6:c.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"});case 8:h&&h(n);case 9:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),L.onSuccess=function(){var t=y(d().mark((function t(e,n){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(S=!0,!n||!n.vid){t.next=7;break}return t.next=5,v.update({progress:1,processStatus:"completed",originId:n.vid},r);case 5:t.next=9;break;case 7:return t.next=9,v.update({progress:1,processStatus:"completed"},r);case 9:c.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"}),setTimeout((function(){v.remove(r),v=null,c.Z.dispatch("statusChecker","backup"),p&&p()}),600),O&&I&&O.unregister(I);case 14:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),L.onConnected=function(){var t=y(d().mark((function t(e,r){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:v&&(v.update(f({originId:r.vid},null!=r&&r.backupDetails?r.backupDetails:{})),x=!0,A());case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),L.getSlice=function(){var t=y(d().mark((function t(e){var r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,v.getSlice(m.key,e);case 4:return r=t.sent,t.abrupt("return",r.data);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v.update({processStatus:"uploading"},r),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"}),(!e||e.length<1)&&(c.Z.dispatch("uploadingUpdate"),chrome.runtime.sendMessage({action:"uploadingUpdate",target:"backupList"})),!m.originId||!j){t.next=54;break}return t.next=47,L.replenish(m.originId,m.videoName);case 47:P=t.sent,L.updateTotalSliceBackup(P),x=!0,E(m.originId,"217",{videoSliceId:P+1}),A(),t.next=61;break;case 54:return _={},P=-1,j=!1,m.options&&(_=m.options.payload),t.next=60,L.ready({title:m.title,payload:_});case 60:t.sent;case 61:C=isFinite(m.sliceEnd-m.sliceStart)?m.sliceEnd-m.sliceStart:2e5,L.updateBackupSlices(C),D=P+1;case 64:if(!(D<C)){t.next=72;break}return t.next=67,v.getSlice(m.key,D);case 67:(M=t.sent)&&M.data?L.push(M.data):L.id&&E(L.id,"215",{msg:"getBackupDataNull"});case 69:D++,t.next=64;break;case 72:w=!0,A();case 75:case"end":return t.stop()}}),t)}))),S.apply(this,arguments)}function E(t,e,r){t&&t.length>0&&fetch(a.Z.baseUrl+"/api/v1/video/log",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({videoID:t,logType:e,info:JSON.stringify(r)})}).then((function(t){return t.json()})).then((function(t){}))}function T(){return O.apply(this,arguments)}function O(){return(O=y(d().mark((function t(){var e,r,i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new n.Z,new o.u,t.next=4,e.getAllDetail();case 4:if(!((r=t.sent)&&r.length>0)){t.next=10;break}return i=r.filter((function(t){return!["failed"].includes(t.status)&&"fmp4"===t.storeName})),t.abrupt("return",i);case 10:return t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(){return j.apply(this,arguments)}function j(){return(j=y(d().mark((function t(){var e,r,i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new n.Z,new o.u,t.next=4,e.getAllDetail();case 4:if(!((r=t.sent)&&r.length>0)){t.next=10;break}return i=r.filter((function(t){return!["created"].includes(t.status)&&"fmp4"===t.storeName})),t.abrupt("return",i);case 10:return t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function L(){return P.apply(this,arguments)}function P(){return(P=y(d().mark((function t(){var e,r,i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new n.Z,new o.u,t.next=4,e.getAllDetail();case 4:if(!((r=t.sent)&&r.length>0)){t.next=10;break}return i=r.filter((function(t){return["closed"].includes(t.status)&&"fmp4"===t.storeName})),t.abrupt("return",i);case 10:return t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var r=o[t]={exports:{}};return n[t].call(r.exports,r,r.exports,i),r.exports}i.m=n,t=[],i.O=(e,r,n,o)=>{if(!r){var a=1/0;for(l=0;l<t.length;l++){for(var[r,n,o]=t[l],c=!0,u=0;u<r.length;u++)(!1&o||a>=o)&&Object.keys(i.O).every((t=>i.O[t](r[u])))?r.splice(u--,1):(c=!1,o<a&&(a=o));if(c){t.splice(l--,1);var s=n();void 0!==s&&(e=s)}}return e}o=o||0;for(var l=t.length;l>0&&t[l-1][2]>o;l--)t[l]=t[l-1];t[l]=[r,n,o]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},r=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var o=Object.create(null);i.r(o);var a={};e=e||[null,r({}),r([]),r(r)];for(var c=2&n&&t;"object"==typeof c&&!~e.indexOf(c);c=r(c))Object.getOwnPropertyNames(c).forEach((e=>a[e]=()=>t[e]));return a.default=()=>t,i.d(o,a),o},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={830:0};i.O.j=e=>0===t[e];var e=(e,r)=>{var n,o,[a,c,u]=r,s=0;if(a.some((e=>0!==t[e]))){for(n in c)i.o(c,n)&&(i.m[n]=c[n]);if(u)var l=u(i)}for(e&&e(r);s<a.length;s++)o=a[s],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return i.O(l)},r=self.webpackChunkawesomescreenshot_extension=self.webpackChunkawesomescreenshot_extension||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),i.O(void 0,[11,714,437,569,675,356,157,292,332,677,741,754,547],(()=>i(23760)));var a=i.O(void 0,[11,714,437,569,675,356,157,292,332,677,741,754,547],(()=>i(94572)));a=i.O(a)})();